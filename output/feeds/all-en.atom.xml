<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>DavidJB.com</title><link href="http://davidjb.com/" rel="alternate"></link><link href="http://davidjb.com/feeds/all-en.atom.xml" rel="self"></link><id>http://davidjb.com/</id><updated>2012-10-24T16:28:00+10:00</updated><entry><title>Configuring GTK/Gnome toolbar icon sizes and labels (Ubuntu 12.10+ and more)</title><link href="http://davidjb.com/blog/2012/10/configuring-gtkgnome-toolbar-icon-sizes-and-labels-ubuntu-12-10-and-more/" rel="alternate"></link><updated>2012-10-24T16:28:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-10-24:blog/2012/10/configuring-gtkgnome-toolbar-icon-sizes-and-labels-ubuntu-12-10-and-more/</id><summary type="html">&lt;p&gt;One major annoyance (first-world, clearly) for me having upgraded to
Ubuntu 12.10 is that my GTK toolbar icons are very large (32x32 pixels)
and have labels on them. This takes up a decent amount of screen real
estate in applications like gedit, Rhythmbox, and many others --
effectively anything that's using GTK. What's worse, it looks like the
latest Ubuntu (Quantal Quetzal) now is adding visual padding/spacing
around the buttons. I don't like this at all and prefer my buttons to be
tiny and without labels.&lt;/p&gt;
&lt;p&gt;As per the post at &lt;a class="reference external" href="http://ubuntuforums.org/showthread.php?t=1859526"&gt;http://ubuntuforums.org/showthread.php?t=1859526&lt;/a&gt;,
the issue was previously solved by configuring the setting within a
dconf setting, however this hasn't applied since 11.10.&lt;/p&gt;
&lt;p&gt;However, it is possible to include the following in your
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/etc/gtk-3.0/settings.ini&lt;/span&gt;&lt;/tt&gt; file to make your icons small and
beautiful again:&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="k"&gt;[Settings]&lt;/span&gt;
&lt;span class="na"&gt;gtk-icon-sizes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;panel-menu=16,16:gtk-large-toolbar=16,16&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Start a GTK application like gedit and notice the difference.&lt;/p&gt;
&lt;p&gt;To change the 'style' of the buttons on the toolbars (labels and icons
appearance), you'll need to launch (and install, if necessary)
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;dconf-editor&lt;/span&gt;&lt;/tt&gt; and modify the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;org.gnome.desktop.interface.toolbar-style&lt;/span&gt;&lt;/tt&gt;
setting.&lt;/p&gt;
&lt;p&gt;Once the editor is open, then traverse the settings schema tree on the
left-hand side until you find the setting. Once you've found it, click onto its
value and choose another option -- if you've left your GTK application open,
the style will change immediately. Pick the best one that suits you. I prefer
'icons' to just have the icons themselves, without labels (note that text
appears in a tooltip anyway).&lt;/p&gt;
&lt;p&gt;Note that not all GTK applications will adhere to these options -- it is
possible for them to override the global settings (sigh, yes Rhythmbox,
that's seemingly you).&lt;/p&gt;
</summary><category term="buttons"></category><category term="gnome"></category><category term="gtk"></category><category term="icons"></category><category term="toolbar"></category><category term="ubuntu"></category></entry><entry><title>Virtualenv being ignored by setuptools/Distribute/easy_install</title><link href="http://davidjb.com/blog/2012/08/virtualenv-being-ignored-by-setuptoolsdistributeeasy_install/" rel="alternate"></link><updated>2012-08-24T13:41:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-08-24:blog/2012/08/virtualenv-being-ignored-by-setuptoolsdistributeeasy_install/</id><summary type="html">&lt;p&gt;This one couldn't be simpler, but it's worth noting all the same. &amp;nbsp;I've just
experienced a situation where a &lt;a class="reference external" href="http://www.virtualenv.org/en/latest/index.html"&gt;virtualenv&lt;/a&gt;&amp;nbsp; was being completely ignored by
all tools even though it was absolutely activated via &lt;tt class="docutils literal"&gt;source bin/activate&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The answer was to blow away the &lt;tt class="docutils literal"&gt;lib&lt;/tt&gt; directory within the virtualenv and
blow away the local Python interpreter at &lt;tt class="docutils literal"&gt;bin/python&lt;/tt&gt; and re-create the
virtualenv. After deactivating and re-activating, everything works correctly
again.&lt;/p&gt;
&lt;p&gt;I guess something in the environment (or env variables) got messed up.
Who knows; it works now.&lt;/p&gt;
</summary><category term="distribute"></category><category term="easy_install"></category><category term="virtualenv"></category></entry><entry><title>Restart/reset USB in Ubuntu 12.04 without rebooting</title><link href="http://davidjb.com/blog/2012/06/restartreset-usb-in-ubuntu-12-04-without-rebooting/" rel="alternate"></link><updated>2012-06-25T10:34:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-06-25:blog/2012/06/restartreset-usb-in-ubuntu-12-04-without-rebooting/</id><summary type="html">&lt;p&gt;Either my Dell Optiplex 990 computer or my Linux install has an issue:
occasionally, when I re-plug a USB device into the system, it'll cause a
fault in the USB module in the kernel and USB goes dark. I'm unsure as
to whether this is a hardware or software issue, but I'd simply like to
restart my USB subsystem and continue working. When searching the web
for 'restart USB in Linux' and 'reload USB kernel module', you get a
plethora of results and none of which will work (seemingly due to how
the Ubuntu standard kernel is compiled), at least for me within Ubuntu
12.04, Precise Pangolin. Until now, I've had no success and had to hard
reset. No longer.&lt;/p&gt;
&lt;p&gt;You'll need root/sudo access to the machine to be able to run commands.
In my case, without USB available, then I've either got to sprint for a
PS/2 keyboard and mouse or login via SSH. You can do what I've done and
prepared things into a suitable script I can run with just a Gnome
launcher. &amp;nbsp;Thanks to this &lt;a class="reference external" href="http://ubuntuforums.org/showpost.php?p=9162799&amp;amp;postcount=1"&gt;fantastic post&lt;/a&gt; for the help. Either place
the following into a script or run the commands directly:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;0000:00:1a.0&amp;quot;&lt;/span&gt; | tee /sys/bus/pci/drivers/ehci_hcd/unbind
&lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;0000:00:1d.0&amp;quot;&lt;/span&gt; | tee /sys/bus/pci/drivers/ehci_hcd/unbind
&lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;0000:00:1a.0&amp;quot;&lt;/span&gt; | tee /sys/bus/pci/drivers/ehci_hcd/bind
&lt;span class="nb"&gt;echo&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;0000:00:1d.0&amp;quot;&lt;/span&gt; | tee /sys/bus/pci/drivers/ehci_hcd/bind
&lt;/pre&gt;
&lt;p&gt;The hardware identifiers being passed around here can be revealed using
a command like &lt;tt class="docutils literal"&gt;lspci | grep USB&lt;/tt&gt;. In my case, the identifiers in the
original post were exactly what I have in my system.&lt;/p&gt;
&lt;p&gt;I'm yet to see if my USB will correctly come back online after freezing
up as it hasn't happened yet, but I'll try this when it does and report
back. That said, the commands above definitely reload all USB devices
attached to the system; that much I've tried.&lt;/p&gt;
</summary><category term="linux"></category><category term="power"></category><category term="reset"></category><category term="restart"></category><category term="ubuntu"></category><category term="usb"></category></entry><entry><title>Easier GitHub organisation, repository and team management with github-collective</title><link href="http://davidjb.com/blog/2012/06/easier-github-organisation-repository-and-team-management-with-github-collective/" rel="alternate"></link><updated>2012-06-22T12:17:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-06-22:blog/2012/06/easier-github-organisation-repository-and-team-management-with-github-collective/</id><summary type="html">&lt;p&gt;Have you ever felt that administering your GitHub organisation (or
organization, depending from where you hail), its repositories, teams,
and service hooks has become a tedious task and that you'd rather be
doing something else? &amp;nbsp;Maybe you're of the mindset that there should be
a better way of doing things - a way that involves specific,
version-controlled configuration and less repetition (less
clicky-clicky). &amp;nbsp;The good news is that there is -- &lt;a class="reference external" href="http://pypi.python.org/pypi/github-collective"&gt;github-collective&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;This is a script, written in Python, that utilises &lt;a class="reference external" href="http://developer.github.com/"&gt;GitHub's JSON-based
API&lt;/a&gt; to allow you to construct an ini-style text-based configuration
representing your GitHub organisation and have this sync to create
repositories and service hooks for said repositories, teams, and
configure access rights. &amp;nbsp;At present, this works &lt;em&gt;from&lt;/em&gt; your
configuration &lt;em&gt;to&lt;/em&gt; GitHub (not vice versa at present). You may already
know this as what's powering the &lt;a class="reference external" href="http://git.io/collective"&gt;GitHub Collective&lt;/a&gt; to manage
repositories and teams, especially if you're in the Plone community.&lt;/p&gt;
&lt;p&gt;An &lt;a class="reference external" href="https://github.com/collective/github-collective/blob/master/example.cfg"&gt;example configuration&lt;/a&gt; lives within its source code repository, and
similarly, the configuration that &lt;a class="reference external" href="https://github.com/collective/collective.github.com/blob/master/permissions.cfg"&gt;powers the Collective&lt;/a&gt; is available
also. Effectively, you define different types of sections ([team],
[hook], [repo]) and these will correspond to certain things being
created on GitHub via the API.&lt;/p&gt;
&lt;div class="section" id="our-implementation"&gt;
&lt;h2&gt;Our implementation&lt;/h2&gt;
&lt;p&gt;We at the James Cook University &lt;a class="reference external" href="http://eresearch.jcu.edu.au"&gt;eResearch Centre&lt;/a&gt;&amp;nbsp;have deployed this
for use against our &lt;a class="reference external" href="http://git.io/jcu"&gt;GitHub organisation&lt;/a&gt;&amp;nbsp;and our workflow looks like
this:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Users are able to fork a configuration repository and modify
accordingly. For simplicity, since changes are frequently minor, I
suggest using GitHub's &amp;quot;Edit this file&amp;quot; feature via the web.&lt;/li&gt;
&lt;li&gt;User creates Pull Request for changes.&lt;/li&gt;
&lt;li&gt;Administrator reviews and merges changes from Pull Request.&lt;/li&gt;
&lt;li&gt;Configuration repository's service hook sends POST to Jenkins CI
instance&lt;/li&gt;
&lt;li&gt;Jenkins CI instance runs the &lt;em&gt;github-collective&lt;/em&gt; script upon
receiving this hook.&lt;/li&gt;
&lt;li&gt;Changes to configuration get enacted on GitHub.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This process is similar to what happens for the Collective, except that
our service hook and Jenkins take care of making the changes happen,
rather than a periodical cron job.&lt;/p&gt;
&lt;p&gt;Our Jenkins job uses the&amp;nbsp;&lt;a class="reference external" href="https://wiki.jenkins-ci.org/display/JENKINS/Text-finder+Plugin"&gt;Jenkins Text Finder&lt;/a&gt;&amp;nbsp;plugin to search for
the regex &amp;quot;Traceback \(most recent call last\)&amp;quot; in the output to
determine success or failure. &amp;nbsp;This isn't the most elegant solution in
the world, but it's good enough for now.&lt;/p&gt;
&lt;p&gt;For what it's worth, we have a total of 25 repositories; a similar
number of teams; give or take 12 staff members in total; and the end
result is that running &lt;em&gt;github-collective&lt;/em&gt; once cached takes only around
6 seconds, including Jenkins overhead. &amp;nbsp;Unfortunately I'm unable to
provide our exact configuration, but for everything we do, I've
'anonymised' the configuration and included it back in the public
repository as examples. Happy to answer questions about what we're doing
too!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="thanks"&gt;
&lt;h2&gt;Thanks&lt;/h2&gt;
&lt;p&gt;All credit to Rok Garbas and Alex Clark for their work on this - it
works fantastically. I can only take credit for coming in later with a
few things necessary our deployment. &lt;em&gt;Github-collective&lt;/em&gt; now supports
all GitHub API settings for repositories (thus allowing you to create
private repos - something critical for us, and set other metadata) and
post-receive service hooks (so you can easily manage hooks on GitHub).
That, and a hearty dose of end-user documentation.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="collective"></category><category term="github"></category><category term="ini"></category><category term="jenkins"></category><category term="management"></category><category term="organization"></category><category term="plone"></category><category term="script"></category></entry><entry><title>Members can't add folders to Plone via WebDAV (401 Unauthorized)</title><link href="http://davidjb.com/blog/2012/06/members-cant-add-folders-to-plone-via-webdav-401-unauthorized/" rel="alternate"></link><updated>2012-06-22T11:20:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-06-22:blog/2012/06/members-cant-add-folders-to-plone-via-webdav-401-unauthorized/</id><summary type="html">&lt;p&gt;This is a mirror of the (excellent) documentation at
&lt;a class="reference external" href="http://plone.org/documentation/error/unable-to-create-a-folder-through-webdav/"&gt;http://plone.org/documentation/error/unable-to-create-a-folder-through-webdav/&lt;/a&gt;,
but just a short editorial to also highlight that this is still very
applicable to Plone 4.x. Effectively, the symptom is that users will
report seeing a &amp;quot;401 Unauthorized&amp;quot; error when trying to create folders
within areas they have access to as an Owner. &amp;nbsp;Without further ado, the
documentation:&lt;/p&gt;
&lt;p&gt;Using a&amp;nbsp;WebDAV&amp;nbsp;client on a&amp;nbsp;Plone&amp;nbsp;site, site users are unable to create
newfolders&amp;nbsp;directories where they have Owner role.&lt;/p&gt;
&lt;div class="section" id="problem"&gt;
&lt;h2&gt;Problem:&lt;/h2&gt;
&lt;p&gt;The&amp;nbsp;WebDAV&amp;nbsp;&amp;quot;make folder&amp;quot; method, MKCOL, requires the &amp;quot;Add&amp;nbsp;Folders&amp;quot;
permission. This is not normally granted to Members or Owners on the
site.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="workaround"&gt;
&lt;h2&gt;Workaround:&lt;/h2&gt;
&lt;p&gt;In the Zope Management Interface, under the &amp;quot;Security&amp;quot; tab for
the&amp;nbsp;Plone&amp;nbsp;root, check the &amp;quot;Owners&amp;quot; box for the &amp;quot;Add&amp;nbsp;Folders&amp;quot; permission
setting.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="folder"></category><category term="http"></category><category term="plone"></category><category term="upload"></category><category term="webdav"></category></entry><entry><title>Jenkins CI and GitHub post-receive hooks ceasing to work (+ potential solution)</title><link href="http://davidjb.com/blog/2012/06/jenkins-ci-and-github-post-receive-hooks-ceasing-to-work-potential-solution/" rel="alternate"></link><updated>2012-06-19T09:11:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-06-19:blog/2012/06/jenkins-ci-and-github-post-receive-hooks-ceasing-to-work-potential-solution/</id><summary type="html">&lt;div class="section" id="all-projects-fail"&gt;
&lt;h2&gt;All projects fail&lt;/h2&gt;
&lt;p&gt;Recently our Jenkins CI system began having issues with failing to
correctly accept post-receive hook POST requests from GitHub, even
though it was working fine. Without thorough testing, I can only really
see that the issue was related to upgrading Jenkins and/or the relevant
Git and GitHub plugins. Thankfully, with even newer versions of the
above, it has started working again. So, to those with issues, I offer
this KGS (Known Good Set) of versions for your help:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Jenkins 1.470&lt;/li&gt;
&lt;li&gt;Jenkins GIT plugin 1.1.19&lt;/li&gt;
&lt;li&gt;github-api 1.28&lt;/li&gt;
&lt;li&gt;GitHub plugin 1.4&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="some-projects-work"&gt;
&lt;h2&gt;Some projects work&lt;/h2&gt;
&lt;p&gt;On a separate note, if you're having trouble with just one of your
Jenkins projects not accepting post-receive hooks when others are
working fine, then check the your repository URL. I found that one of my
projects had the URL:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
git&amp;#64;github.com:davidjb/my.project
&lt;/pre&gt;
&lt;p&gt;which is notably missing the the &amp;quot;.git&amp;quot; from the end. Whilst Git accepts this
as a valid URL for cloning a repo, the Jenkins integration doesn't match the
hooks when coming in. This one is worthwhile checking too if you're just having
issues with individual projects.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="debugging"&gt;
&lt;h2&gt;Debugging&lt;/h2&gt;
&lt;p&gt;For both of the above issues, debugging can help a bit -- &lt;a class="reference external" href="https://wiki.jenkins-ci.org/display/JENKINS/Github+Plugin#GithubPlugin-Troubleshootinghooks"&gt;follow
instructions&lt;/a&gt; for adding a logger and examine the output. In my case
for when some projects were working and some weren't, the one that
wasn't working didn't get 'poked' in the logs. If you don't see this,
but you do see the POST request coming into Jenkins, then check your
project/job configuration.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="ci"></category><category term="git"></category><category term="github"></category><category term="jenkins"></category></entry><entry><title>Serving TileStache (or another app) using uWSGI against a web sub-directory</title><link href="http://davidjb.com/blog/2012/06/serving-tilestache-or-another-app-using-uwsgi-against-a-web-sub-directory/" rel="alternate"></link><updated>2012-06-01T12:41:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-06-01:blog/2012/06/serving-tilestache-or-another-app-using-uwsgi-against-a-web-sub-directory/</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://projects.unbit.it/uwsgi/"&gt;uWSGI&lt;/a&gt; is extremely promising as an application server given its huge
range of options and supported platforms. &amp;nbsp;For me, however, just getting
something seemingly simple up and running successfully was relatively
confusing. I'd like to contribute to the documentation when I can, but
thought a dedicated page about &lt;a class="reference external" href="http://tilestache.org"&gt;TileStache&lt;/a&gt; as a specific application
(and associated configuration) was warranted. It does make more sense
now, thankfully.&lt;/p&gt;
&lt;p&gt;I want to serve my TileStache application at &lt;a class="reference external" href="http://mydomain.com/tiles"&gt;http://mydomain.com/tiles&lt;/a&gt;
(taking careful note of the sub-directory present). I've chosen an
INI-style configuration for my instance and here's what the final result
looks like (loads using &lt;tt class="docutils literal"&gt;uwsgi &lt;span class="pre"&gt;--ini&lt;/span&gt; my_uwsgi.ini&lt;/tt&gt;):&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="k"&gt;[uwsgi]&lt;/span&gt;
&lt;span class="na"&gt;processes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;8&lt;/span&gt;
&lt;span class="na"&gt;vacuum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;master&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;socket&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;%(home)/var/uwsgi.sock&lt;/span&gt;
&lt;span class="na"&gt;home&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/opt/tilestache&lt;/span&gt;
&lt;span class="na"&gt;mount&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/tiles=app.py&lt;/span&gt;
&lt;span class="na"&gt;need-app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The available options for uWSGI are extremely comprehensive and fairly
bewildering for someone just starting off. The main issue I faced was
the fact the &lt;em&gt;--module&lt;/em&gt; option doesn't support argument passing. This
was a big one because documentation like &lt;a class="reference external" href="http://projects.unbit.it/uwsgi/wiki/Quickstart"&gt;this&lt;/a&gt; shows empty rounded
brackets and the programmer in me instinctively thought of this as an
Python object call. Not so. In order to pass arguments, you either need
&lt;em&gt;--eval&lt;/em&gt; or to do what I did and create a separate file and mount that.
Where I have &lt;em&gt;app.py&lt;/em&gt; specified above, this is the definition for said
file:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;TileStache&lt;/span&gt;
&lt;span class="n"&gt;application&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TileStache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WSGITileServer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'tilestache.cfg'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;So that's uWSGI serving TileStache. The final issue to solve is that of
serving against a sub-directory. Once you have your application mounted
against the relevant mount point (in my case &lt;em&gt;/tiles&lt;/em&gt;), then it's just a
case of telling uWSGI to use this as its &lt;strong&gt;SCRIPT_NAME&lt;/strong&gt; environment
variable.&lt;/p&gt;
&lt;p&gt;For me, this was telling our webserver (Cherokee) to provide the
&lt;strong&gt;UWSGI_SCRIPT_NAME&lt;/strong&gt;, ensuring the &lt;strong&gt;UWSGI_&lt;/strong&gt; is prepended, as a custom
environment variable against the relevant Directory behaviour. Once
Cherokee was pointed at the relevant socket and restarted, everything
'just worked'. In the case of other web servers like Nginx, it would be
a case of configuring a location with:&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="err"&gt;uwsgi_param&lt;/span&gt; &lt;span class="err"&gt;SCRIPT_NAME&lt;/span&gt; &lt;span class="err"&gt;/tiles&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;And there you have it.&lt;/p&gt;
</summary><category term="application"></category><category term="python"></category><category term="serving"></category><category term="uwsgi"></category><category term="web"></category><category term="wsgi"></category></entry><entry><title>mr.scripty - my new best friend</title><link href="http://davidjb.com/blog/2012/02/mr-scripty-my-new-best-friend/" rel="alternate"></link><updated>2012-02-24T08:34:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-02-24:blog/2012/02/mr-scripty-my-new-best-friend/</id><summary type="html">&lt;p&gt;If you're working with Buildout, then check out &lt;a class="reference external" href="http://github.com/collective/mr.scripty"&gt;mr.scripty&lt;/a&gt;, a
fantastic Buildout recipe that allows you to use Python code in
functions within its options. &amp;nbsp;This means that - in the few instances
I've used it so far - have conditional statements regarding effectively
anything.&lt;/p&gt;
&lt;p&gt;In the two examples I added to the &lt;a class="reference external" href="https://github.com/collective/mr.scripty/blob/master/mr/scripty/README.txt"&gt;source documentation&lt;/a&gt;, I go and
configure download links based upon architecture and separately,
configure some (Java) environment variables based upon which directories
exist (eg to handle different Linux distributions that might be
running). This is only the start, but it's a fantastic one.&lt;/p&gt;
&lt;p&gt;Amazing I hadn't gone looking for this earlier. Anyone know of any other
Buildout awesomeness out there?&lt;/p&gt;
</summary><category term="awesome"></category><category term="buildout"></category><category term="python"></category><category term="recipe"></category></entry><entry><title>Java HTTP request fails with "javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated"</title><link href="http://davidjb.com/blog/2012/02/java-http-request-fails-with-javax-net-ssl-sslpeerunverifiedexception-peer-not-authenticated/" rel="alternate"></link><updated>2012-02-16T15:16:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-02-16:blog/2012/02/java-http-request-fails-with-javax-net-ssl-sslpeerunverifiedexception-peer-not-authenticated/</id><summary type="html">&lt;p&gt;Searching the above-mentioned stack trace reveals lots and lots of
results, unsurprisingly. &amp;nbsp;Most results are workarounds where you modify
the code, but what about if an application (like Jenkins/Hudson CI, in
my case) throws this error at you? The reason the error is occurring is
because the SSL certificate of the target you're connecting to isn't
considered valid by your Java instance's keystore. This may be because
the certificate itself is invalid, or, in my case, the CA chain couldn't
be validated (my OS is RHEL (Red Hat) 5.7, with OpenJDK 1.6). &amp;nbsp;For
completeness, I should also mention that the issue here arose when I
asked Jenkins CI to use&amp;nbsp;GitHub OAuth. As GitHub's SSL certificate has
been signed by DigiCert, and this isn't included within RHEL 5.7, the
error arises. &amp;nbsp;A solution is, assuming you trust the cert or the CA, to
add the relevant certificates/root certificates to your Java keystore.&lt;/p&gt;
&lt;p&gt;To do so, get your relevant certificates/root certificates, locate your
keystore, and add them accordingly:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
wget https://www.digicert.com/CACerts/DigiCertHighAssuranceEVCA-1.crt
wget https://www.digicert.com/testroot/DigiCertHighAssuranceEVRootCA.crt
keytool -importcert -storepass changeit -keystore /etc/alternatives/java_sdk/jre/lib/security/cacerts -alias digicertevrootca -file DigiCertHighAssuranceEVRootCA.crt
keytool -importcert -storepass changeit -keystore /etc/alternatives/java_sdk/jre/lib/security/cacerts -alias digicertevca1 -file DigiCertHighAssuranceEVCA-1.crt
&lt;/pre&gt;
&lt;p&gt;This resolved the issue for me and GitHub OAuth completed successfully.
If you're having issues with just a single certificate, then just import
that one certificate.&lt;/p&gt;
&lt;p&gt;For the interested Googlers, here's what the relevant chunk of
stacktrace looked like:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
at sun.security.ssl.SSLSessionImpl.getPeerCertificates&lt;span class="o"&gt;(&lt;/span&gt;SSLSessionImpl.java:371&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.conn.ssl.AbstractVerifier.verify&lt;span class="o"&gt;(&lt;/span&gt;AbstractVerifier.java:128&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket&lt;span class="o"&gt;(&lt;/span&gt;SSLSocketFactory.java:390&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection&lt;span class="o"&gt;(&lt;/span&gt;DefaultClientConnectionOperator.java:148&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.conn.AbstractPoolEntry.open&lt;span class="o"&gt;(&lt;/span&gt;AbstractPoolEntry.java:149&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.conn.AbstractPooledConnAdapter.open&lt;span class="o"&gt;(&lt;/span&gt;AbstractPooledConnAdapter.java:121&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.client.DefaultRequestDirector.tryConnect&lt;span class="o"&gt;(&lt;/span&gt;DefaultRequestDirector.java:562&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.client.DefaultRequestDirector.execute&lt;span class="o"&gt;(&lt;/span&gt;DefaultRequestDirector.java:415&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.client.AbstractHttpClient.execute&lt;span class="o"&gt;(&lt;/span&gt;AbstractHttpClient.java:820&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.client.AbstractHttpClient.execute&lt;span class="o"&gt;(&lt;/span&gt;AbstractHttpClient.java:754&lt;span class="o"&gt;)&lt;/span&gt;
at org.apache.http.impl.client.AbstractHttpClient.execute&lt;span class="o"&gt;(&lt;/span&gt;AbstractHttpClient.java:732&lt;span class="o"&gt;)&lt;/span&gt;
at org.jenkinsci.plugins.GithubSecurityRealm.doFinishLogin&lt;span class="o"&gt;(&lt;/span&gt;GithubSecurityRealm.java:278&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;This &lt;a class="reference external" href="http://my.opera.com/karmazilla/blog/how-to-grab-the-certificate-from-a-website-and-import-it-with-java-keytool"&gt;fantastic post&lt;/a&gt; set me on the right track.&lt;/p&gt;
</summary><category term="certificate"></category><category term="java"></category><category term="key"></category><category term="linux"></category><category term="ssl"></category><category term="store"></category></entry><entry><title>Adding a return URL during logout with CAS</title><link href="http://davidjb.com/blog/2012/01/adding-a-return-url-during-logout-with-cas/" rel="alternate"></link><updated>2012-01-11T11:38:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2012-01-11:blog/2012/01/adding-a-return-url-during-logout-with-cas/</id><summary type="html">&lt;p&gt;CAS (Central Authentication Service) is a single-sign-on service (say
that several times quickly) and through accessing a CAS &lt;tt class="docutils literal"&gt;/logout&lt;/tt&gt; URL,
as an application, you're able to log the given user out. &amp;nbsp;What wasn't
clear (by Googling) was whether there's a possibility to redirect the
user back to the original application (or a given URL). &amp;nbsp;I now know,
thanks to the &lt;a class="reference external" href="http://www.jasig.org/cas/protocol"&gt;CAS Protocol Documentation&lt;/a&gt; (section 2.3), that any
posts that mention adding &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?service=http://my.url/&lt;/span&gt;&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;/logout&lt;/tt&gt;
URL are incorrect, as this isn't a valid parameter (at least not at time
of writing).&lt;/p&gt;
&lt;p&gt;However, you can add a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?url=http://my.url/&lt;/span&gt;&lt;/tt&gt; to the logout URL and get
this (likely, depends on your CAS settings) displayed as a link on the
logout page. So, a full URL like this is good to go:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
https://cas.foo.edu/cas/logout?url=http://davidjb.com/
&lt;/pre&gt;
</summary><category term="auth"></category><category term="cas"></category><category term="http"></category><category term="url"></category><category term="web"></category></entry><entry><title>Configuring pulseaudio-equalizer defaults</title><link href="http://davidjb.com/blog/2011/12/configuring-pulseaudio-equalizer-defaults/" rel="alternate"></link><updated>2011-12-16T11:26:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-12-16:blog/2011/12/configuring-pulseaudio-equalizer-defaults/</id><summary type="html">&lt;p&gt;I've recently been using the Logitech G930 headset with my Ubuntu 11.10
install and I've found that the default configuration offers nothing in
terms of decent sound (tinny, no bass, etc). Thankfully, I've been able
to turn to pulseaudio-equalizer for help with turning down the treble
and up the bass. However, using pulseaudio-equalizer-gtk wasn't an
entirely satisfying experience as the default volume for my headset kept
being set to 100% upon restart. Now, if you recall my &lt;a class="reference external" href="http://davidjb.com/blog/2011/10/logitech-g930-headphones-audio-quality-under-ubuntu"&gt;previous post on
this headset&lt;/a&gt;, having the volume for the device set at 100% leads to
static being audible and this is a very bad thing.&lt;/p&gt;
&lt;p&gt;Thankfully, pulseaudio-equalizer offers configuration in the form of
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.pulse/equalizerrc&lt;/span&gt;&lt;/tt&gt;.&amp;nbsp; It's not well documented (read: I had to go
dissect the source code) but essentially, you can control the output
device's volume by changing the 4th item within the configuration file.
So the start of my config looks like this:&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="err"&gt;mbeq\_1197&lt;/span&gt;
&lt;span class="err"&gt;mbeq&lt;/span&gt;
&lt;span class="err"&gt;Multiband&lt;/span&gt; &lt;span class="err"&gt;EQ&lt;/span&gt;
&lt;span class="err"&gt;1&lt;/span&gt;
&lt;span class="err"&gt;Laptop&lt;/span&gt;
&lt;span class="err"&gt;&amp;lt;&lt;/span&gt; &lt;span class="err"&gt;...snip...&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;and that number 1 is the volume percentage (eg 1 = 100%) that will end
up landing in &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.pulse/default.pa&lt;/span&gt;&lt;/tt&gt; as the default volume for the device
being equalized. Change this number, then run:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
pulseaudio-equalizer disable-config
pulseaudio-equalizer &lt;span class="nb"&gt;enable&lt;/span&gt;-config
pulseaudio -k
&lt;/pre&gt;
&lt;p&gt;and wait for PA to be restarted for you. Take notice that the default
volume is now set correctly.&lt;/p&gt;
&lt;p&gt;I should mention that if you want to know what the other options relate
to, inspect the source of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/usr/bin/pulseaudio-equalizer&lt;/span&gt;&lt;/tt&gt;, around line
54 onwards.&lt;/p&gt;
</summary><category term="audio"></category><category term="equalizer"></category><category term="linux"></category><category term="pulseaudio"></category><category term="settings"></category><category term="tip"></category><category term="ubuntu"></category><category term="volume"></category></entry><entry><title>Notes about Redmine and GitHub Post-commit Hooks</title><link href="http://davidjb.com/blog/2011/12/notes-about-redmine-and-github-post-commit-hooks/" rel="alternate"></link><updated>2011-12-14T10:50:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-12-14:blog/2011/12/notes-about-redmine-and-github-post-commit-hooks/</id><summary type="html">&lt;p&gt;We're currently using Redmine for our project tracking and recently have
wanted to have our GitHub projects automatically get updated within
Redmine. A post-commit hook to the rescue!&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;Download and install this super plugin:
&lt;a class="reference external" href="https://github.com/koppen/redmine_github_hook"&gt;https://github.com/koppen/redmine_github_hook&lt;/a&gt; and restart your
Redmine instance.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Set up your local Git instance for your repository.&amp;nbsp; This is simple,
but you need to follow these steps or else pulling your changes down
won't work:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
git clone --bare git://github.com/davidjb/123.git
&lt;span class="nb"&gt;cd &lt;/span&gt;123.git
git remote add origin git://github.com/davidjb/123.git
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Configure your Redmine project's Repository to be this Git directory.
(This is a given, but just so you know.)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Configure your GitHub repository to have a 'Post-Receive URL' service
hook and point that at your Redmine URL like so:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
https://davidjb.com/redmine/github_hook?project_id&lt;span class="o"&gt;=&lt;/span&gt;myproject
&lt;/pre&gt;
&lt;p&gt;where &lt;tt class="docutils literal"&gt;myproject&lt;/tt&gt; is your Redmine project ID. You can ignore the
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?project_id=myproject&lt;/span&gt;&lt;/tt&gt; if your GitHub repository name is the same
as your Redmine project ID.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Beware the pre-existing Redmine service hook in the current iteration of
GitHub (circa 2011) - it effectively doesn't do anything. This may
change in the future, but until then, this works fantastically.&lt;/p&gt;
</summary><category term="code"></category><category term="commit"></category><category term="dvcs"></category><category term="git"></category><category term="github"></category><category term="redmine"></category><category term="vcs"></category></entry><entry><title>User IDs show as comment authors in Plone 4.x after migration from plone.app.discussion</title><link href="http://davidjb.com/blog/2011/11/user-ids-show-as-comment-authors-in-plone-4-x-after-migration-from-plone-app-discussion/" rel="alternate"></link><updated>2011-11-01T13:18:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-11-01:blog/2011/11/user-ids-show-as-comment-authors-in-plone-4-x-after-migration-from-plone-app-discussion/</id><summary type="html">&lt;p&gt;If you've migrated your site from earlier versions of Plone to the
latest ones in the 4.x series, or else have started using
plone.app.discussion earlier than that, you might have come across a
situation where comments on your site show user IDs as authors rather
than a user's full name. If you see this anywhere, chances are your
comment's migration didn't go according to plan, and that the Creator
information didn't get recorded correctly on the comment.&lt;/p&gt;
&lt;p&gt;I've just written this on the Collective developer docs:
&lt;a class="reference external" href="http://readthedocs.org/docs/collective-docs/en/latest/misc/upgrade.html#fixing-creator-details-on-existing-comments"&gt;http://readthedocs.org/docs/collective-docs/en/latest/misc/upgrade.html#fixing-creator-details-on-existing-comments&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The script there should help by stepping through all comments on your
site and fixing up the creator details as required. As mentioned in the
comments beneath the script, the mileage you get may vary depending on
the state of your comments. I found half my site's comments were fine
and half weren't. Some of mine had no author name, email, or user ID in
the relevant fields, and the script there checks for these (and the
actual existence of a user after looking up what's in the Creator
property), so that should be enough to sanity-check so it won't stomp
over correct comments.&lt;/p&gt;
&lt;p&gt;That said, if for some reason, you happened to have a user with ID
&lt;em&gt;david&lt;/em&gt; and full name of &lt;em&gt;Administrator&lt;/em&gt;, also had a user with the ID of
&lt;em&gt;Administrator&lt;/em&gt;, and had a comment which had an incorrect &lt;em&gt;Creator&lt;/em&gt; but
did have the three fields of &lt;em&gt;author_username&lt;/em&gt;, &lt;em&gt;author_name&lt;/em&gt;, and
&lt;em&gt;author_email&lt;/em&gt;, then it won't affect those comments and you might just
have to manually fix them up.&lt;/p&gt;
</summary><category term="collective"></category><category term="comments"></category><category term="discussion"></category><category term="docs"></category><category term="documentation"></category><category term="fix"></category><category term="plone"></category></entry><entry><title>Logitech G930 Headphones audio quality under Ubuntu</title><link href="http://davidjb.com/blog/2011/10/logitech-g930-headphones-audio-quality-under-ubuntu/" rel="alternate"></link><updated>2011-10-24T09:28:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-10-24:blog/2011/10/logitech-g930-headphones-audio-quality-under-ubuntu/</id><summary type="html">&lt;p&gt;So I recently purchased a new set of Logitech G930 headphones and am
currently using them with the latest version of Ubuntu, 11.10.&amp;nbsp; Set up
was a breeze - just plug, check your PulseAudio config, and play.&amp;nbsp; For
those of you, like me originally, who were wondering whether the G930
works on Linux, it certain does on Ubuntu.&lt;/p&gt;
&lt;p&gt;Now, it wasn't all peaches and cream because of two things.&amp;nbsp; Firstly,
the audio output with the default configuration was completely lacking
any depth and 'substance' to the sound being produced.&amp;nbsp; I'm not an
audiophile and I have slight hearing problems, but the sound was
entirely lacking anything in the form of bass, and overall, just very
tinny and washed out.&amp;nbsp; Praying it's not the headset itself, I went and
obtained &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pulseaudio-equalizer&lt;/span&gt;&lt;/tt&gt; from &lt;a class="reference external" href="https://launchpad.net/~nilarimogard/+archive/webupd8"&gt;this PPA&lt;/a&gt; (and it comes with
its GTK counterpart, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pulseaudio-equalizer-gtk&lt;/span&gt;&lt;/tt&gt;).&amp;nbsp; Running the latter
of these two commands brings you up the interface, and I selected the
'Laptop' preset and enabled this.&amp;nbsp; I had to re-jig around a little with
clicking the 'EQ enabled' checkbox and the 'Apply Settings' button
whilst listening to music but this preset makes things 100% better.
First hurdle solved.&lt;/p&gt;
&lt;p&gt;The second issue was the constant static being introduced in my audio.
Only when sound was being played mind you, not just when the headset was
sitting turned on in silence, so this lead me to think it must
(hopefully) be something I could configure and not an interference issue
or something hardware related.&amp;nbsp; Thankfully, I was right.&amp;nbsp; Firing up
&lt;tt class="docutils literal"&gt;pavucontrol&lt;/tt&gt;, my much-preferred application over the default Ubuntu
sound panel, I found the static was being introduced when my headphone
output device was set at 100% volume (the Output Device, not anything
else). The static is gone after I dropped the device output back (I'm
using 33%). If I need more amplification, then I can simply use the
Equalizer virtual output device to increase the volume (and/or amplify
the applications behind the output).&lt;/p&gt;
&lt;p&gt;Now, the headset works fantastically.&lt;/p&gt;
</summary><category term="g930"></category><category term="headphones"></category><category term="linux"></category><category term="logitech"></category><category term="pulseaudio"></category><category term="ubuntu"></category></entry><entry><title>RSS Feed for OCZ Vertex 3 SSD firmware updates</title><link href="http://davidjb.com/blog/2011/10/rss-feed-for-ocz-vertex-3-ssd-firmware-updates/" rel="alternate"></link><updated>2011-10-20T18:04:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-10-20:blog/2011/10/rss-feed-for-ocz-vertex-3-ssd-firmware-updates/</id><summary type="html">&lt;p&gt;Here's a quick and dirty solution to me not being able to keep updated
with OCZ firmware updates for my Vertex 3 SSD.&amp;nbsp; For whatever reason, OCZ
doesn't provide a news feed of firmware updates (that I know of, correct
me if I'm wrong!) so I've sorted a screen scraping Yahoo Pipes pipe to
do it for me:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://pipes.yahoo.com/pipes/pipe.run?_id=a1f15d7ead0122567ad6537b2de484a3&amp;amp;_render=rss"&gt;http://pipes.yahoo.com/pipes/pipe.run?_id=a1f15d7ead0122567ad6537b2de484a3&amp;amp;_render=rss&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This RSS feed will (or should) only ever feature just 1 item - the
latest version information for the firmware.&amp;nbsp; So, it won't handle
keeping track of history, but if you (or I) add the feed to something
like Google Reader, that will keep track of changes to the RSS feed for
us/me.&amp;nbsp; So, when the target page on &lt;a class="reference external" href="http://www.ocztechnology.com/ssd_tools/OCZ_Vertex_3,_Vertex_3_Max_IOPS,_Agility_3,_Solid_3,_RevoDrive_3_and_RevoDrive_3_X2/"&gt;OCZ's site&lt;/a&gt;changes its version
information, the feed will update, and Google Reader knows
automagically.&lt;/p&gt;
&lt;p&gt;Yahoo Pipes and Google Reader strike again.&lt;/p&gt;
&lt;p&gt;Oh and apparently this firmware isn't just for the Vertex 3, but also
for the OCZ Vertex 3, Vertex 3 Max IOPS, Agility 3, Solid 3, RevoDrive 3
and RevoDrive 3 X2, so anyone using those other drives should be good
too.&lt;/p&gt;
</summary><category term="hack"></category><category term="ocz"></category><category term="pipes"></category><category term="regex"></category><category term="ssd"></category><category term="version"></category><category term="yahoo"></category></entry><entry><title>Dell SK-8135 keyboard not working during boot (POST, BIOS, GRUB) on OptiPlex 990</title><link href="http://davidjb.com/blog/2011/10/dell-sk-8135-keyboard-not-working-during-boot-post-bios-grub-on-optiplex-990/" rel="alternate"></link><updated>2011-10-20T15:19:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-10-20:blog/2011/10/dell-sk-8135-keyboard-not-working-during-boot-post-bios-grub-on-optiplex-990/</id><summary type="html">&lt;div class="note"&gt;
&lt;p class="first admonition-title"&gt;Note&lt;/p&gt;
&lt;p class="last"&gt;&lt;strong&gt;Update&lt;/strong&gt;: Since this was written, Dell has released version A10 of
their &lt;a class="reference external" href="http://www.dell.com/support/drivers/us/en/04/DriverDetails/DriverFileFormats?DriverId=N31V7&amp;amp;FileId=2775891360"&gt;OptiPlex 990 BIOS&lt;/a&gt;!&amp;nbsp; I've tested this on my 990 and my
keyboard now works!&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Just a quick note to anyone out there confused out of their mind if
their Dell keyboard isn't working with their computer during boot: there
is some incompatibility between the OptiPlex 990 and the Dell SK-8135
keyboard.&amp;nbsp; I'm using the A06 BIOS, which is latest at the time of
writing.&lt;/p&gt;
&lt;p&gt;The result of this is that you cannot use the keyboard during boot, so
not within POST, not to enter the boot menu or BIOS, and the keyboard
does not work in my GRUB until I unplug it and plug it in again.&amp;nbsp; I've
tried two of these specific keyboards, revision P and revision S, and
both show the same issue.&amp;nbsp; I've also tried the keyboard on two different
OptiPlex 990 machines, and the result is the same.&amp;nbsp; All sorts of other
keyboards work fine though, and the SK-8135 works fine once you load an
OS -- so through this detective work, there must be something wrong with
the computer (aka with the BIOS).&lt;/p&gt;
&lt;p&gt;So, just in case you hit the same issue, this is what I've found.&amp;nbsp; If
you find this too, please contact Dell and hopefully we can get a
resolution.&lt;/p&gt;
&lt;p&gt;Cheers!&lt;/p&gt;
</summary><category term="bios"></category><category term="dell"></category><category term="keyboard"></category><category term="post"></category></entry><entry><title>Epic-sized (Really Large) Files with Plone 4.1.2</title><link href="http://davidjb.com/blog/2011/10/epic-sized-files-with-plone-4-1-2/" rel="alternate"></link><updated>2011-10-12T16:10:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-10-12:blog/2011/10/epic-sized-files-with-plone-4-1-2/</id><summary type="html">&lt;p&gt;In case you were ever curious, it's definitely possible to upload
epic-sized files within the Plone CMS. Browser support aside (Firefox
and your 2 GB limits, I'm looking you), I'd previously had issues with
being able to upload files larger than 4 GB, if memory serves correctly.
Previously, there was an issue with files causing out-of-memory issues,
and I'm fairly sure the errors I was getting were related to what was
fixed by &lt;a class="reference external" href="https://dev.plone.org/collective/changeset/244916/Products.CMFEditions/trunk/"&gt;this change&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For today's test, Google Chrome was able to upload a 26.3 GB
(28212643840 bytes) .tar file into Plone on my local machine:&lt;/p&gt;
&lt;img alt="|filename|images/2011-10-12-j9bibwU5DR.png" src="http://davidjb.com/static/images/2011-10-12-j9bibwU5DR.png" /&gt;
&lt;p&gt;It took a long while (even with my SSD) but it made it. No tracebacks or
memory leaks with Plone/Zope so kudos to the developers. It's
interesting to note that the file upload process seemingly took 2x
(double) the amount of disk space -- half was for a file in the /tmp/
directory, and I didn't end up tracking down the other one. Presumably
something like pre-allocated space for the final file, perhaps.&lt;/p&gt;
&lt;p&gt;Anyway, it works! Should you do this? Maybe, if you've got space and
don't mind hammering your CPU for your server during the upload
process.&amp;nbsp; I'll go for larger next time..only problem is my SSD is only
240GB so something like a 500GB file (eg 1TB needed at least) will just
have to wait.&lt;/p&gt;
</summary><category term="blob"></category><category term="file"></category><category term="large"></category><category term="plone"></category></entry><entry><title>AttributeError: 'NoneType' object has no attribute 'items': Can't upgrade Plone 3 to 4.x</title><link href="http://davidjb.com/blog/2011/09/attributeerror-nonetype-object-has-no-attribute-items-cant-upgrade-plone-3-to-4-x/" rel="alternate"></link><updated>2011-09-14T08:57:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-09-14:blog/2011/09/attributeerror-nonetype-object-has-no-attribute-items-cant-upgrade-plone-3-to-4-x/</id><summary type="html">&lt;p&gt;You may have seen an error like the one below when you've gone to
upgrade your Plone site to something in the Plone 4.x series from Plone
3:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;2011-09-14 08:43:32 ERROR plone.app.upgrade Upgrade aborted. Error:
&lt;/span&gt;&lt;span class="gt"&gt;Traceback (most recent call last):
&lt;/span&gt;  File &lt;span class="nb"&gt;&amp;quot;/home/david/.buildout/eggs/Products.CMFPlone-4.1-py2.6.egg/Products/CMFPlone/MigrationTool.py&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;175&lt;/span&gt;, in &lt;span class="n"&gt;upgrade&lt;/span&gt;
    &lt;span class="n"&gt;step&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'step'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;doStep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;/home/david/.buildout/eggs/Products.GenericSetup-1.6.3-py2.6.egg/Products/GenericSetup/upgrade.py&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;142&lt;/span&gt;, in &lt;span class="n"&gt;doStep&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tool&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;/home/david/.buildout/eggs/plone.app.upgrade-1.1-py2.6.egg/plone/app/upgrade/v41/alphas.py&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;105&lt;/span&gt;, in &lt;span class="n"&gt;add_siteadmin_role&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;permission_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;roles&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;state&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permission_roles&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="gr"&gt;AttributeError&lt;/span&gt;: &lt;span class="n"&gt;'NoneType' object has no attribute 'items'&lt;/span&gt;
&lt;span class="x"&gt;2011-09-14 08:43:32 INFO plone.app.upgrade End of upgrade path, migration has finished
2011-09-14 08:43:32 ERROR plone.app.upgrade The upgrade path did NOT reach current version
2011-09-14 08:43:32 ERROR plone.app.upgrade Migration has failed&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;If you've hit this, this means that you have a &lt;strong&gt;workflow state&lt;/strong&gt;
somewhere on your portal that has no specific permissions associated
with it (or otherwise has all permissions set as &lt;tt class="docutils literal"&gt;Acquire&lt;/tt&gt;). An easy way
around this is to go find that workflow state (look in custom
workflows!) in portal_workflow in the ZMI and temporarily change the
state or states so they have a permission.&lt;/p&gt;
&lt;p&gt;Then, go ahead and upgrade your portal to Plone 4.x and you can change
your permission back.&lt;/p&gt;
</summary><category term="4.1"></category><category term="plone"></category><category term="plone 4"></category><category term="traceback"></category><category term="upgrade"></category></entry><entry><title>SCP remote files back home using reverse SSH (in 1 command)</title><link href="http://davidjb.com/blog/2011/09/scp-files-back-home-using-reverse-ssh-in-1-command/" rel="alternate"></link><updated>2011-09-13T12:55:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-09-13:blog/2011/09/scp-files-back-home-using-reverse-ssh-in-1-command/</id><summary type="html">&lt;p&gt;My recent work has involved copying files from a remote host, only
accessible via a hop, back to my local computer. This has been simple in
the past as the remote host has been able to connect to the local
computer and SCP files directly, on account of the firewall allowing
this. Recently, the firewall against the local computer has been
reconfigured for security and direct connection is no longer possible. I
could pass my files through a 3rd-party that both the remote and local
machines can get to, but let's say I don't have one.&lt;/p&gt;
&lt;p&gt;What you can do is use SSH to tunnel your local SSH port onto the remote
machine, with something like:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
ssh -R 9999:localhost:22 hop.example.com
&lt;/pre&gt;
&lt;p&gt;where &lt;tt class="docutils literal"&gt;22&lt;/tt&gt; is your local SSH port, and &lt;tt class="docutils literal"&gt;9999&lt;/tt&gt; is where you can SCP
files onto your local machine to.&lt;/p&gt;
&lt;p&gt;This works great, but my files are beyond the hop on the remote machine.
So, you can chain SSH commands together like so:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
ssh -A -R 9999:localhost:22 hop.example.com &lt;span class="s1"&gt;'ssh -A -R 9999:localhost:9999 remote.example.com scp -P 9999 /path/to/file.tgz david&amp;#64;localhost:/tmp/'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;which maps your SSH port onto the hop and then maps that over to the
remote host. Using the &lt;tt class="docutils literal"&gt;ssh &lt;span class="pre"&gt;-A&lt;/span&gt;&lt;/tt&gt; fowards your authentication so the
&lt;tt class="docutils literal"&gt;scp&lt;/tt&gt; will work automatically (assuming your own SSH public key is in
your own &lt;tt class="docutils literal"&gt;.ssh/authorized_keys&lt;/tt&gt; file). Thus, one command to pull
whatever files you need onto your local machine. The command could be
extended, if need be, if there were more hops in the middle.&lt;/p&gt;
&lt;p&gt;In my specific case I needed to add &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-o&lt;/span&gt; &amp;quot;StrictHostKeyChecking no&amp;quot;&lt;/tt&gt;
into the second SSH command because, for whatever reason, the hop is not
allowed to edit the &lt;tt class="docutils literal"&gt;.ssh/known_hosts&lt;/tt&gt; file. This SSH option disables
this check, but I would take great care using it.&lt;/p&gt;
</summary><category term="files"></category><category term="linux"></category><category term="scp"></category><category term="security"></category><category term="ssh"></category><category term="transfer"></category></entry><entry><title>ImportError: No module named BeautifulSoup</title><link href="http://davidjb.com/blog/2011/08/importerror-no-module-named-beautifulsoup/" rel="alternate"></link><updated>2011-08-26T12:02:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-08-26:blog/2011/08/importerror-no-module-named-beautifulsoup/</id><summary type="html">&lt;p&gt;Had this issue when you've been trying to run something like
&lt;a class="reference external" href="http://pypi.python.org/pypi/funnelweb"&gt;Funnelweb&lt;/a&gt;, and you hit an ImportError for BeautifulSoup?&amp;nbsp; You're
definitely not alone, because I just hit the same issue.&amp;nbsp; The answer is
simple -- just ensure that you don't use BeautifulSoup 4 or above (this
is still beta) -- it uses a different namespace, specifically bs4.
Thus, whilst you might have the BeautifulSoup egg satisfying your
dependencies, any imports of this package are going to fail.&lt;/p&gt;
&lt;p&gt;For me, I'm using buildout, so I just pinned my version of BeautifulSoup
thusly:&lt;/p&gt;
&lt;pre class="code cfg literal-block"&gt;
&lt;span class="k"&gt;[buildout]&lt;/span&gt;
&lt;span class="err"&gt;...&lt;/span&gt;
&lt;span class="na"&gt;versions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;versions&lt;/span&gt;

&lt;span class="k"&gt;[versions]&lt;/span&gt;
&lt;span class="na"&gt;BeautifulSoup&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;3.2.0&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Now, we stop using BeautifulSoup 4.0 and everything works again.&lt;/p&gt;
</summary><category term="egg"></category><category term="error"></category><category term="import"></category><category term="packages"></category><category term="python"></category></entry><entry><title>Watch out: Python 2.4 ZEO client and Python 2.6 ZEO Server</title><link href="http://davidjb.com/blog/2011/07/watch-out-python-2-4-zeo-client-and-python-2-6-zeo-server/" rel="alternate"></link><updated>2011-07-11T16:23:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-07-11:blog/2011/07/watch-out-python-2-4-zeo-client-and-python-2-6-zeo-server/</id><summary type="html">&lt;p&gt;Today was interesting when an issue with saving content on a Plone 3.3.5
site got reported to me. The system was producing undecipherable error
messages about ZEO disconnections and database conflicts whenever
someone would try and create some content within Plone (folders,
particularly). Errors looked like:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;Module ZEO.zrpc.connection, line 796, in wait. DisconnectedError&amp;quot; and &amp;quot;raise ReadConflictError().
ReadConflictError: database read conflict error&amp;quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;and also:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;ERROR ZEO.zrpc (2515) can't decode message: '(K\x11K\x01U\tserialnos(]((U\x08\x00\x00\x00\x00\x00X\x...'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;-- essentially the issue described &lt;a class="reference external" href="https://mail.zope.org/pipermail/zodb-dev/2010-December/013893.html"&gt;here&lt;/a&gt;. My ZEO server was running
ZODB3 3.9.5 with Python 2.6, and my client running ZODB3 3.8.3 with
Python 2.4; almost everything worked.&lt;/p&gt;
&lt;p&gt;The long and the short of this issue appears to be, as the &lt;a class="reference external" href="http://pypi.python.org/pypi/ZODB3/3.9.5#compatibility"&gt;ZODB
documentation mentions&lt;/a&gt;, is that Python 2.4 servers work with 2.5+
clients, but not the other way around.&amp;nbsp; It's slightly misleading when
you read further and see that:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ZODB ZEO clients from ZODB 3.2 on can talk to ZODB 3.9 servers. ZODB
ZEO Clients can talk to ZODB 3.8 and 3.9 ZEO servers.
&lt;/pre&gt;
&lt;p&gt;So, despite this seeming interoperability, dang - I can't use my
pre-existing ZEO server setup (based on the Plone 4 buildout for
versions, etc) which is currently in place and running.&lt;/p&gt;
&lt;p&gt;Thankfully, building being what it is, the solution for me was to simply
re-use that buildout for any Plone instances that are Python 2.4
clients.&amp;nbsp; This was as simple as re-cloning my git repository where I
keep the buildouts, firing up a brand new virtualenv for Python 2.4, and
moving the data across.&lt;/p&gt;
&lt;div class="section" id="one-more-thing"&gt;
&lt;h2&gt;One more thing...&lt;/h2&gt;
&lt;p&gt;There is one final thing worth mentioning, which I got awfully caught
out by.&amp;nbsp; I was finding that my ZEO processes, under this new
environment, just would not start - essentially, they would keep
respawning again and again until they stopped (triggered by some
'quick-respawn' safety mechanism, seemingly).&amp;nbsp; I thought this was some
issue concerning the fact I'd had my databases and files loaded against
newer ZEO versions, but this actually not.&amp;nbsp; This was a by-product of not
having my ZEO authentication database present - because there was no
file, presumably the processes kept crashing.&amp;nbsp; Sadly, no error message,
so hence this note.&amp;nbsp; Take care with this one.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="database"></category><category term="fs"></category><category term="plone"></category><category term="server"></category><category term="zeo"></category><category term="zope"></category></entry><entry><title>Extracting a Buildout versions.cfg from a Zope instance script</title><link href="http://davidjb.com/blog/2011/06/extracting-a-buildout-versions-cfg-from-a-zope-instance-script/" rel="alternate"></link><updated>2011-06-02T16:07:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-06-02:blog/2011/06/extracting-a-buildout-versions-cfg-from-a-zope-instance-script/</id><summary type="html">&lt;p&gt;Today, I needed to migrate some legacy Plone installs set up using
Buildout. If I were to simply move the buildout files and re-run
buildout, I'd end up with the latest versions of add-on products - and
since I'm using legacy versions of Plone 3, that'd almost certainly
break the system.&amp;nbsp; I do know about the Buildout extension
&lt;a class="reference external" href="http://pypi.python.org/pypi/buildout.dumppickedversions"&gt;buildout.dumppickedversions&lt;/a&gt; (which does what its name suggests and
exports picked versions of eggs) but I can't re-run buildout to get this
extension for risk of updating existing products (what I'm trying to
avoid!).&lt;/p&gt;
&lt;p&gt;The good news is that with just one line of bash in Linux (and a bunch
of helper commands :)), you can extract all your current egg versions
from a Zope instance script (eg bin/instance), like so, running the
command in your buildout directory:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
cat bin/instance1 | grep eggs | sed -r &lt;span class="s1"&gt;'s#.*eggs/(.*)-py2.[0-9].*#\1#g'&lt;/span&gt; | sed -r &lt;span class="s1"&gt;'s#-# = #g'&lt;/span&gt; | sed -r &lt;span class="s1"&gt;'s#_#-#g'&lt;/span&gt; | grep -E &lt;span class="s1"&gt;' = [0-9\.]'&lt;/span&gt; | xargs -0 &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;[versions]\n&amp;quot;&lt;/span&gt; | sed -r &lt;span class="s1"&gt;'s#^\s+##g'&lt;/span&gt; &amp;gt; versions.cfg; cat versions.cfg
&lt;/pre&gt;
&lt;p&gt;Copy the &lt;tt class="docutils literal"&gt;versions.cfg&lt;/tt&gt; to the new buildout location and make buildout
extend off it.&lt;/p&gt;
&lt;p&gt;Hopefully having &lt;a class="reference external" href="http://pypi.python.org/pypi/buildout.dumppickedversions"&gt;buildout.dumppickedversions&lt;/a&gt; in place now should
resolve doing this again if/when I'm migrating any of my new Plone
installs. (Interesting to note my current dev install uses over 320
eggs).&lt;/p&gt;
</summary><category term="buildout"></category><category term="cat"></category><category term="cfg"></category><category term="eggs"></category><category term="grep"></category><category term="plone"></category><category term="sed"></category><category term="versions"></category><category term="zope"></category></entry><entry><title>Building Cherokee RPMs on RHEL 6 (x86_64)</title><link href="http://davidjb.com/blog/2011/05/building-cherokee-rpms-on-rhel-6-x86_64/" rel="alternate"></link><updated>2011-05-31T12:27:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-05-31:blog/2011/05/building-cherokee-rpms-on-rhel-6-x86_64/</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://www.cherokee-project.com/"&gt;Cherokee&lt;/a&gt; is a fast web server and something I'm looking
at using instead of my current Apache installs in order to squeeze a bit
(lot) more juice out of my web services.&lt;/p&gt;
&lt;p&gt;You can easily install Cherokee via its automated scripting and that's
really useful.&amp;nbsp; Unfortunately, since I'm within a RedHat environment,
init scripts and other useful aspects that come packaged with Apache
don't get installed when installing from source. Now, there's a lot of
activity regarding installing the latest packages for Ubuntu, but not
much of anything recent for RHEL (current Cherokee is 1.2.98 and latest
RHEL packages are 1.2.1).&amp;nbsp; Since development of Cherokee appears to be
moving very fast, having the most recent version is always a good choice
for bug fixes and new features.&lt;/p&gt;
&lt;p&gt;So, how about creating packages for RHEL 6?&amp;nbsp; The good news is that
Fedora does have a git repo for the RPM spec and relevant scripts, and
that repo has a branch for EL6.&lt;/p&gt;
&lt;p&gt;That said, there's no guarantee this branch will continue to work for
future Cherokee or EL versions, so if there's a problem running the
following RPM build, then someone will have to fix whatever error takes
place. That said, for now, on version 1.2.98 of Cherokee, things work,
as far as I can tell for Cherokee (also, disclaimer: I'm not an RHEL/RPM
expert). That said, here's what I did:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
yum install rpm-build spectool pam-devel gettext
cherokee&lt;span class="se"&gt;\_&lt;/span&gt;version&lt;span class="o"&gt;=&lt;/span&gt;1.2.98
git clone git://pkgs.fedoraproject.org/cherokee.git -b el6
cp cherokee/&lt;span class="se"&gt;\*&lt;/span&gt; &lt;span class="se"&gt;\`&lt;/span&gt;rpm --eval &lt;span class="s1"&gt;'%{\_sourcedir}'&lt;/span&gt;&lt;span class="se"&gt;\`&lt;/span&gt;
&lt;span class="nb"&gt;cd &lt;/span&gt;cherokee
sed -i -r &lt;span class="s2"&gt;&amp;quot;s/(Version:\\s+)[0-9\\.]+/\\1\`echo $cherokee\_version\`/g&amp;quot;&lt;/span&gt; cherokee.spec
spectool -g -R cherokee.spec
rpmbuild -ba cherokee.spec
&lt;span class="nb"&gt;cd&lt;/span&gt; &lt;span class="se"&gt;\`&lt;/span&gt;rpm --eval &lt;span class="s1"&gt;'%{\_rpmdir}'&lt;/span&gt;&lt;span class="se"&gt;\`&lt;/span&gt;
&lt;span class="nb"&gt;cd &lt;/span&gt;x86&lt;span class="se"&gt;\_&lt;/span&gt;64
ls -lah
yum install cherokee-&lt;span class="se"&gt;\*&lt;/span&gt;
&lt;/pre&gt;
</summary><category term="build"></category><category term="cherokee"></category><category term="el"></category><category term="red hat"></category><category term="rhel"></category><category term="rpm"></category></entry><entry><title>How to: Updating OCZ Vertex 3 SSD Firmware (on a Dell M1530 laptop)</title><link href="http://davidjb.com/blog/2011/05/how-to-updating-ocz-vertex-3-ssd-firmware-on-a-dell-m1530-laptop/" rel="alternate"></link><updated>2011-05-21T23:45:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-05-21:blog/2011/05/how-to-updating-ocz-vertex-3-ssd-firmware-on-a-dell-m1530-laptop/</id><summary type="html">&lt;div class="note"&gt;
&lt;p class="first admonition-title"&gt;Note&lt;/p&gt;
&lt;p class="last"&gt;&lt;strong&gt;Update 3:&lt;/strong&gt; This guide is effectively now entirely outdated
with regards to the available tools.  I've gone back to simply using
a Windows boot disk to handle the firmware upgrades, although they've
gotten less frequent as of late.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;I've just shelled out a good chunk of money in buying an OCZ Vertex 3
240GB solid state drive (SSD) and it's amazingly quick. So amazingly
quick that I thought I may just have fallen into a coma when I had to
temporarily switch back to my old mechanical hard drive and boot from it
again. And this is only using the Vertex 3 on a SATA II interface - not
even the SATA III it's designed for. I actually just bought a new laptop
with the intention (at least one of ;)) of being able to utilise the
drive's full potential on SATA III, but I digress.&lt;/p&gt;
&lt;p&gt;After having only had this drive for a week, I've noticed that there are
firmware upgrades available from the OCZ website, and the Vertex 3's
firmware stands at 2.06 at time of writing. Now, you can upgrade this
firmware (and upgrading did &lt;strong&gt;not&lt;/strong&gt; erase my drive!) but it's not the
easiest if you're like me and only have a laptop with the SSD as your
only drive. Thankfully, a bit of trial and error on my part got this
licked. Here's a guide to how I did it.&lt;/p&gt;
&lt;p&gt;Now, as the OCZ site mentions, you can't upgrade a disk that you've
booted off. I've also learned that you need to have your SSD connected
in via a dedicated SATA controller (NOT a USB-to-SATA converter or any
such thing) and in my case of my M1530 laptop, is the internal drive
bay. This means we need to be booting off a USB stick or optical disc -
something Windows essentially won't do easily. Thankfully, this is
something that Linux shines at. And the good news here is that OCZ have
a Linux-based updater tool available. Hurray!&lt;/p&gt;
&lt;p&gt;Here's what you can do. Warning: your mileage &lt;strong&gt;will&lt;/strong&gt; likely vary for
you if using a different laptop, different model version, different
firmware to A12, different SSD firmware, etc, so be very careful
following my words verbatim.&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;Download and install a Linux distribution to a USB stick or burn an
optical disc.&amp;nbsp; In my case, I chose Ubuntu 11.04, because that's what
I'm comfortable with.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Head to the OCZ forums and download the linked &lt;a class="reference external" href="http://www.ocztechnologyforum.com/forum/showthread.php?82289-OCZ-SandForce-Linux-based-firmware-update-tool"&gt;Linux OCZ Firmware
Update Tool&lt;/a&gt;. At time of writing, the version is 1.15.&amp;nbsp; Put the zip
or tar file close to hand (eg on the USB stick is a good idea).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Shut down your computer.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Potentially optional step:&amp;nbsp; change the SATA mode on your drive to
'ATA' (away from 'AHCI') within the BIOS.&amp;nbsp; As far as I had read, this
is necessary.&amp;nbsp; That said,&amp;nbsp; I haven't tried it without doing this as
of yet.&amp;nbsp; When changed, shut down your computer.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Disconnect all power from the computer - in the case of my laptop,
this was the AC and the battery.&amp;nbsp; Wait for a minute before
reconnecting.&amp;nbsp; Apparently this is enough time for the AHCI security
'freeze' to be cleared from the SSD.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Connect power again and boot from your USB stick.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;When your Linux distro is loaded, inspect your SSD's parameters with
this command, replacing /dev/sda with your drive's device:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo hdparm -I /dev/sda
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;If all is well, then you should see 'not frozen' and 'not locked' in
the output, near the very bottom.&amp;nbsp; If you only see 'frozen' (for
instance) as one of the lines, then your device needs to be unfrozen
before continuing&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;In my case, I had to turn off the swap partition on the drive
(done easily with gparted) and&lt;/li&gt;
&lt;li&gt;I had to suspend and resume my computer whilst on running off the
USB stick.&amp;nbsp; This last point clinched it for me and the security
freeze was lifted.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Once you're ready, make sure your computer is connected to the
Internet as the firmware updater downloads the latest version from
OCZ on the fly.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Locate your zip/tar of the firmware tool and extract it somewhere
convenient.&amp;nbsp; For argument's sake, I've put mine in my home directory.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Run the appropriate command from the following to update the firmware
(linux32 is for if you are presently booted into a 32 bit OS and
linux64 is for 64 bit; replacing /dev/sda with your drive's device):&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sudo ~/fwupd\_v115/linux32/fwupd -log /dev/sda
sudo ~/fwupd\_v115/linux64/fwupd -log /dev/sda
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;You should be greeted with a message of success, if it all worked. If
it didn't, then check to make sure your drive isn't reported as
locked or frozen - this is what it was for me 99% of the time.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So that's about it. This guide and how-to is mostly posted for my own
information for later, but hopefully it might help someone else. Like
always, make sure you've backed up your data before beginning anything
like this.&lt;/p&gt;
</summary><category term="boot"></category><category term="drive"></category><category term="firmware"></category><category term="guide"></category><category term="linux"></category><category term="live"></category><category term="ssd"></category><category term="update"></category><category term="usb"></category></entry><entry><title>Putting a NASA Human Space Flight Sightings RSS feed into your calendar program</title><link href="http://davidjb.com/blog/2011/05/putting-a-nasa-human-space-flight-sightings-rss-feed-into-your-calendar-program/" rel="alternate"></link><updated>2011-05-14T07:34:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-05-14:blog/2011/05/putting-a-nasa-human-space-flight-sightings-rss-feed-into-your-calendar-program/</id><summary type="html">&lt;p&gt;I stumbled upon &lt;a class="reference external" href="http://spaceflight.nasa.gov/realdata/sightings/index.html"&gt;NASA's space sightings page&lt;/a&gt; a little while ago. For
those of you that don't know, it's a great site that lists opportunities
to view satellites that will be visible in your location and when/where
to look to see them. Amongst the fact this service exists and is free, I
was amazed (and thankful!) that it actually lists lots of different
locations, one of which is where I like in regional Australia.&lt;/p&gt;
&lt;p&gt;It's a great setup and they offer an RSS feed for each location which
keeps you updated. That's great, but if I'm trying to manage my time, I
don't really want to have be porting information between my Google
Reader and my Google Calendar manually. This wasn't a problem when I
wanted to insert one or two records into my calendar, but since this
feed always gets updated, it's clogging my Reader and less useful this
way.&lt;/p&gt;
&lt;p&gt;Never to let a good thing go, I decided to resolve this issue by using
my new favourite tool, &lt;a class="reference external" href="http://pipes.yahoo.com/pipes/"&gt;Yahoo Pipes&lt;/a&gt;. Read on for how to access.&lt;/p&gt;
&lt;p&gt;If you've not heard of Yahoo Pipes, I encourage you to go and take a
look. It's not exactly the easiest tool to use, granted, but it is
extremely powerful for as they say &amp;quot;rewiring the web&amp;quot; (oh, it's FREE so
you don't need to use your own computing resources!). There are a number
of oddities in how it does business, but the end result is extremely
useful.&lt;/p&gt;
&lt;p&gt;So back to what I've built, check out
&lt;a class="reference external" href="http://pipes.yahoo.com/pipes/pipe.info?_id=853d413076c16a20cc0c219188158033"&gt;http://pipes.yahoo.com/pipes/pipe.info?_id=853d413076c16a20cc0c219188158033&lt;/a&gt;
for the Pipe. Here's the instructions:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Go to &lt;a class="reference external" href="http://spaceflight.nasa.gov/realdata/sightings/"&gt;http://spaceflight.nasa.gov/realdata/sightings/&lt;/a&gt; and locate
the RSS feed for your location&lt;/li&gt;
&lt;li&gt;Make note of your location's time offset, plus or minus hour many
hours GMT.&lt;/li&gt;
&lt;li&gt;Once you have these, go to my Pipe at
&lt;a class="reference external" href="http://pipes.yahoo.com/pipes/pipe.info?_id=853d413076c16a20cc0c219188158033"&gt;http://pipes.yahoo.com/pipes/pipe.info?_id=853d413076c16a20cc0c219188158033&lt;/a&gt;
and input the URL and time offset in the relevant boxes&lt;/li&gt;
&lt;li&gt;Click 'Run Pipe'. If successful, you should see a list of sightings
(assuming they exist for your location and time!).&lt;/li&gt;
&lt;li&gt;Click onto 'More options' on the left-hand side and choose 'Get as
iCal'. Copy this URL into your calendaring product, like Google
Calendar, and enjoy!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Note that you'll need to update your time offset when/if you change into
or out of daylight saving time - you can just go back to my Pipe and do
that to get your new calendar URL. I might see what I can do in the
future about this, but since my location doesn't have daylight saving,
you can understand why auto-changing isn't a feature :)&lt;/p&gt;
&lt;p&gt;Enjoy this creation! As long as I stay interested, I'll keep it running
as best I can. However, given the nature of people's websites to change
formatting, I can't guarantee that NASA won't break my Pipe. Also, I
give no guarantees that this will work for anything but the one location
I live in because I don't test anything but this one RSS feed as an
input.&lt;/p&gt;
</summary><category term="nasa"></category><category term="pipes"></category><category term="sightings"></category><category term="space"></category><category term="yahoo"></category><category term="yahoo pipes"></category></entry><entry><title>Can't run Plone/Zope buildout on Ubuntu 11.04 after upgrade from 10.10</title><link href="http://davidjb.com/blog/2011/05/cant-run-plonezope-buildout-on-ubuntu-11-04-after-upgrade-from-10-10/" rel="alternate"></link><updated>2011-05-11T09:33:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-05-11:blog/2011/05/cant-run-plonezope-buildout-on-ubuntu-11-04-after-upgrade-from-10-10/</id><summary type="html">&lt;p&gt;After upgrading from Ubuntu 10.10 (Maverick Meerkat) to Ubuntu 11.04
(Natty Narwhal), you'll probably find that if you're running a Plone 4
buildout where you need to upgrade the Plone version, that compilation
of Zope will fail. The output will look something like this:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;Getting distribution for 'Zope2==2.12.17'.
In file included from src/AccessControl/cAccessControl.c:51:0:
include/ExtensionClass/ExtensionClass.h:83:20: fatal error: Python.h: No such file or directory
compilation terminated.
error: Setup script exited with error: command 'gcc' failed with exit status 1
An error occured when trying to install Zope2 2.12.17. Look above this message for any errors that were output by easy_install.&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The reason for this is that the default Python version in Ubuntu 11.04
is now Python 2.7, rather than 2.6 as was previously the case. The
message here is telling us our Python development libraries/headers
aren't available, so do this:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get install python2.6-dev
&lt;/pre&gt;
&lt;p&gt;and re-run your buildout. Make sure too that if you're using Plone 4
that you're using Python 2.6, as newer versions like 2.7 aren't
supported (yet).&lt;/p&gt;
</summary><category term="buildout"></category><category term="plone"></category><category term="python"></category><category term="zope"></category></entry><entry><title>Ubuntu 11.04 boot freezes with 2.6.38-8-generic-pae kernel</title><link href="http://davidjb.com/blog/2011/05/ubuntu-11-04-boot-freezes-with-2-6-38-8-generic-pae-kernel/" rel="alternate"></link><updated>2011-05-05T15:46:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-05-05:blog/2011/05/ubuntu-11-04-boot-freezes-with-2-6-38-8-generic-pae-kernel/</id><summary type="html">&lt;p&gt;So you've just installed 32-bit Ubuntu 11.04 (Natty Narwhal), and in my
case, upgraded from Ubuntu 10.04 (Maverick Meerkat). &amp;nbsp;The upgrade
process seemingly went fine and then you were asked to restart your
computer. &amp;nbsp;You diligently do so, only to come back to find that your
computer has frozen at GRUB2 upon trying to boot the
2.6.38-8-generic-pae kernel from the GRUB list. &amp;nbsp;Now what? &amp;nbsp;How do you
fix this?&lt;/p&gt;
&lt;p&gt;The issue appears to stem from some form of installation issue where
this new kernel isn't set up right. &amp;nbsp;Note: I don't actually know what's
wrong and can't investigate.&lt;/p&gt;
&lt;p&gt;The good news is that you can use the 'Previous Versions' entry in the
GRUB listing to boot to one of your older kernels and get your system
started. &amp;nbsp;Once you're booted, then load up Synaptic Package Manager and
(re-)install:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
linux-image-2.6.38-8-generic-pae&amp;nbsp;linux-generic-pae&amp;nbsp;linux-headers-generic-pae&amp;nbsp;linux-image-generic-pae&amp;nbsp;linux-headers-2.6.38-8-generic-pae
&lt;/pre&gt;
&lt;p&gt;You should now be able to restart your computer and use the PAE-based
kernel. Thanks to a post on the Ubuntu forums for pointing me in the
right direction.&lt;/p&gt;
</summary><category term="11.04"></category><category term="boot"></category><category term="frozen"></category><category term="kernel"></category><category term="natty"></category><category term="ubuntu"></category></entry><entry><title>Disabling caching for sensitive web pages (aka how to prevent logged out users going 'back')</title><link href="http://davidjb.com/blog/2011/03/disabling-caching-for-sensitive-web-pages-aka-how-to-prevent-logged-out-users-going-back/" rel="alternate"></link><updated>2011-03-24T12:50:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-03-24:blog/2011/03/disabling-caching-for-sensitive-web-pages-aka-how-to-prevent-logged-out-users-going-back/</id><summary type="html">&lt;p&gt;We all see web pages like Internet banking, HR systems, email, and more
that allow you to log in, do something and load pages, log out, and then
prevent you from using your browser's history to see that sensitive
information.&amp;nbsp; I'm amazed that in my searches I couldn't quickly find a
definitive source of information on how to achieve this.&amp;nbsp; Pages across
the web in a search for 'stop caching' range from blog posts, to forum
posts, to other pages, and people asking the question (try it: &lt;a class="reference external" href="http://www.google.com/search?q=stop+caching"&gt;here&lt;/a&gt;,
or &lt;a class="reference external" href="http://www.google.com/search?q=stop+caching+firefox"&gt;maybe here&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Maybe I got unlucky, but finding a definitive answer to the questions of
&amp;quot;how to prevent the use of the back button&amp;quot; or &amp;quot;how to stop browsers
caching&amp;quot; etc wasn't a piece of cake. Hence this post.&lt;/p&gt;
&lt;p&gt;The answer isn't concrete in itself either due to differing browser
support, but the most useful information comes from RFC2616, the RFC for
HTTP/1.1. In &lt;a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9.2"&gt;section 14.9.2&lt;/a&gt;, we learn about &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;no-store&lt;/span&gt;&lt;/tt&gt;. This cache
directive should see a correctly-implemented browser not storing a
request/response on disk (non-volatile storage) and deleting the info as
quick as possible from RAM (volatile storage).&lt;/p&gt;
&lt;p&gt;I've found that combining this, with an Expires header, and other
Cache-Control directives, has worked across Firefox 4, Chrome 10,
Internet Explorer 6, 7, 8, and 9 to keep relevant pages entirely out of
the cache. Here's a snippet from some Python code:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Expires'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;formatDateTime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;getExpiration&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Cache-Control'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;'no-store, no-cache, max-age=0, must-revalidate, private'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;You could likely use this in the &amp;lt;meta&amp;gt; tags in your page too.&lt;/p&gt;
&lt;p&gt;This, by all means, isn't a guaranteed solution as the RFC may not be
followed by all browsers.&amp;nbsp; I've also noted that the RFC isn't exactly
clear with regards to a browser's history this sort of thing.&amp;nbsp; &lt;a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.13"&gt;Section
13.13&lt;/a&gt; mentions that &amp;quot;a history mechanism is meant to show exactly what
the user saw at the time when the resource was retrieved&amp;quot;, and using the
RFC-specified &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;no-store&lt;/span&gt;&lt;/tt&gt; on a logged in page (or anything dynamic)
would seemingly break this implication.&lt;/p&gt;
&lt;p&gt;At any rate, seems like this implementation works successfully on the
browsers I've tested. Apparently IE doesn't like the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;no-store&lt;/span&gt;&lt;/tt&gt; or
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;no-cache&lt;/span&gt;&lt;/tt&gt; settings in certain circumstances but it's been fine for me
thus far.&lt;/p&gt;
</summary><category term="caching"></category><category term="http"></category><category term="no-store"></category><category term="rfc"></category><category term="web"></category></entry><entry><title>Increasing Plone's session timeout</title><link href="http://davidjb.com/blog/2011/03/increasing-plones-session-timeout/" rel="alternate"></link><updated>2011-03-08T10:01:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-03-08:blog/2011/03/increasing-plones-session-timeout/</id><summary type="html">&lt;p&gt;What you may notice if you're developing with Plone/Zope, is that if
you're storing small pieces of data within Plone's session variable (the
session_data_manager tool), data expires after a few minutes.&amp;nbsp; By
default, this timeout is 20 minutes, but is far too short if you're
expecting the information stored to last for say the whole time a user
is logged in.&amp;nbsp; In this situation, you'll need to increase the timeout.&lt;/p&gt;
&lt;p&gt;Documentation on changing the session timeout is potentially a little
sketchy (Google &amp;quot;session-timeout-minutes zope&amp;quot;), but it's clear that you
need to change the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;session-timeout-minutes&lt;/span&gt;&lt;/tt&gt; directive in your
&lt;tt class="docutils literal"&gt;zope.conf&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;What's not immediately obvious is how to make a session persist
indefinitely (until server reboot), but this can be achieved by setting
the value to 0. Within a buildout environment for Plone, adding this
under your Plone's instance section will add the configuration to your
zope.conf.&lt;/p&gt;
&lt;pre class="code cfg literal-block"&gt;
&lt;span class="k"&gt;[instance]&lt;/span&gt;
&lt;span class="err"&gt;...&lt;/span&gt;
&lt;span class="na"&gt;zope-conf-additional&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;
    session-timeout-minutes 0&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;There are obviously implications for performance and other issues
associated with persisting session data like this, but for arguments
sake, let's say we've considered them.&amp;nbsp; You'll probably also want to
consider deleting session data stored like this on logout (see &lt;a class="reference external" href="http://collective-docs.plone.org/sessions/session_variables.html"&gt;Session
Variables&lt;/a&gt; in the Plone collective documentation) but that's dependant
on your use case.&lt;/p&gt;
</summary><category term="buildout"></category><category term="plone"></category><category term="session"></category><category term="timeout"></category><category term="zope"></category></entry><entry><title>Migrating Plone 2.5 content straight onto Plone 4</title><link href="http://davidjb.com/blog/2011/01/migrating-plone-2-5-content-straight-onto-plone-4/" rel="alternate"></link><updated>2011-01-14T15:07:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-01-14:blog/2011/01/migrating-plone-2-5-content-straight-onto-plone-4/</id><summary type="html">&lt;p&gt;It's my very last Plone 2.5 site and I'm very happy to see the back of
it.&amp;nbsp; Using the joy that is &lt;strong&gt;quintagroup.transmogrifier&lt;/strong&gt;, I was able
to, without much manual effort, migrate my content from a Plone 2.5 site
(constructed with instancemanager, of all things!) straight into a shiny
new Plone 4 site on Buildout.&lt;/p&gt;
&lt;p&gt;My only key need was to port the content and structure, and I was happy
to make big allowances for the sake of certain content and time.&amp;nbsp; So, my
thoughts here mightn't (probably won't!) suit everyone.My requirements
and allowances were these:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Content and structure only needed to be migrated.&amp;nbsp; Plone settings,
theme, user accounts, and everything else would either come from my
newly-created Plone 4 theme or be manually re-added.&lt;/li&gt;
&lt;li&gt;There were/are only a handful of users on the site.&lt;/li&gt;
&lt;li&gt;My Plone 2.5 site used a lot of custom content types (IronicWiki,
Wicked, Quills, PloneSoftwareCentre, Poi and more).&lt;ul&gt;
&lt;li&gt;I want to avoid ever going through migrating custom 'document'
types again.&amp;nbsp; Thankfully, the 'wiki'-based content types translate
easily to pure Plone documents.&lt;/li&gt;
&lt;li&gt;I was happy to jettison content in PSC, Poi, and Quills
(Weblogs).&amp;nbsp; This is a big issue but it wasn't worth my time since
the content was already 5+ years out of date and never used.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Default folder view selections don't appear to migrate.&amp;nbsp; I was able
to manually fix things up.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;That out of the way, here's my process.&lt;/p&gt;
&lt;div class="section" id="for-plone-2-5"&gt;
&lt;h2&gt;For Plone 2.5&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Follow Step 1 of &lt;a class="reference external" href="http://projects.quintagroup.com/products/wiki/quintagroup.transmogrifier/plone2-3"&gt;QuintaGroup's instructions&lt;/a&gt; for migrating a
Plone 2.1 site to Plone 3.&amp;nbsp; I had a Plone 2.5 site and this worked
well.&amp;nbsp; Essentially, you want to use ZopeSkel (paster) to create
yourself a Plone 2.5 buildout and then checkout the relevant packages
(as per the instructions).&amp;nbsp; I created mine on my local Ubuntu machine
for my sanity as the old server the site was running on was ages out
of date.&lt;/li&gt;
&lt;li&gt;Figure out what you need to actually get the Plone 2.5 instance to
start up.&amp;nbsp; Now, my site had a huge amount of 3rd party packages that
caused me grief, and I had to add these into the buildout before the
instance would even start successfully.&amp;nbsp; In my case, it was a matter
of copying out the old product web links from my instancemanager
script and putting them in the &lt;strong&gt;productdistros&lt;/strong&gt; section of my Plone
2.5 buildout.&lt;ul&gt;
&lt;li&gt;Note that if your Plone instance was entirely manually managed,
then I'm guess you either on a hunt, or you could try copying the
files into your relevant directory.&lt;/li&gt;
&lt;li&gt;I also had a number of SVN-based products too so I employed my
fried, mr.developer, to check them out from the right SVN location
to the buildout src directory.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Once you've got your instance started (in the foreground), then you
should be able to access
&lt;a class="reference external" href="http://localhost:8080"&gt;http://localhost:8080&lt;/a&gt;/&amp;lt;your_site_name&amp;gt;/&amp;#64;&amp;#64;pipeline-config which is
the configuration for Transmogrifier.&lt;ol class="arabic"&gt;
&lt;li&gt;You can modify your configuration to suit you.&amp;nbsp; There's a little
learning involved here, but there are a good number of
Transmogrifier resources around.&lt;/li&gt;
&lt;li&gt;My configuration looks like this: &lt;a class="reference external" href="http://davidjb.com/wp-content/uploads/2011/01/transmogrifier-export.txt"&gt;transmogrifier-export.txt&lt;/a&gt;,
where I explicitly ignore a whole bunch of content types (read:
problematic for export/import), and export my content out to a
temporary directory&lt;/li&gt;
&lt;li&gt;Make changes to the export configuration and save the result.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Under the ZMI, head into portal_setup and click the 'Properties'
tab.&amp;nbsp; Change the active site configuration to be 'Transmogrifier' and
save this.&lt;/li&gt;
&lt;li&gt;Click the 'Export' tab at the top, and then export the 'Content' step
you see listed.&amp;nbsp; Watch your console output for progress and anything
that might be a problem.&lt;/li&gt;
&lt;li&gt;If successful, then you'll get presented with a generic setup .tar.gz
to download.&amp;nbsp; Save this somewhere useful; you'll need it shortly.&amp;nbsp; If
you were like me and exported to a directory, then you'll get an
'empty' .tar.gz download and your content will be in the directory
you specified.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="manually-modify-content-before-import"&gt;
&lt;h2&gt;Manually modify content before import&lt;/h2&gt;
&lt;p&gt;The reason I outputted to a directory so was I could hack a few things
around in my content. Transmogrifier is powerful, but a bit complicated.
I couldn't find out how to rename a field to another in the pipeline (eg
IronicWiki content use the &amp;quot;body&amp;quot; field rather than &amp;quot;text&amp;quot; as do normal
Document content), and likewise I couldn't successfully translate
content type names.&lt;/p&gt;
&lt;p&gt;So, find and replace it is. WickedDocs and IronicWiki are essentially
modern Plone Documents in disguise (as wiki markup is the same), so we
can just translate them over. In addition, I go ahead and rename
anything that's called &amp;quot;index_html&amp;quot; as this would otherwise be
displayed as the actual page on a given folder automagically (and not
through being selected in the Display drop down menu):&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt; /path/to/our/temp/directory
grep -lr -e &lt;span class="s1"&gt;'WickedDoc'&lt;/span&gt; * | xargs sed -i &lt;span class="s1"&gt;'s/WickedDoc/Document/g'&lt;/span&gt;
grep -lr -e &lt;span class="s1"&gt;'IronicWiki'&lt;/span&gt; * | xargs sed -i &lt;span class="s1"&gt;'s/name=\&amp;quot;body\&amp;quot;/name=\&amp;quot;text\&amp;quot;/g'&lt;/span&gt;
grep -lr -e &lt;span class="s1"&gt;'IronicWiki'&lt;/span&gt; * | xargs sed -i &lt;span class="s1"&gt;'s/IronicWiki/Document/g'&lt;/span&gt;
find . -name index_html | xargs rename -v &lt;span class="s1"&gt;'s/index_html/main_page/g'&lt;/span&gt;
grep -lr -e &lt;span class="s1"&gt;'index_html'&lt;/span&gt; * | xargs sed -i &lt;span class="s1"&gt;'s/index_html/main_page/g'&lt;/span&gt;
grep -lr -e &lt;span class="s1"&gt;'copy_of_main_page'&lt;/span&gt; * | xargs sed -i &lt;span class="s1"&gt;'s/copy_of_main_page/copy_of_index_html/g'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Once done with this, I copied the 'structure' directory (inside the temp
directory) into the .tar.gz you have from earlier, ready for upload to
the new site.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="for-plone-4"&gt;
&lt;h2&gt;For Plone 4&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Set up your Plone 4 like normal.&amp;nbsp; You should (are?) using Buildout,
so follow the instructions &lt;a class="reference external" href="http://projects.quintagroup.com/products/wiki/quintagroup.transmogrifier/plone3-4#Installationonbuildout"&gt;here&lt;/a&gt;, again from QuintaGroup, to
install the same quintagroup.transmogrifier product into your Plone 4
instance (eg just add it into your eggs and zcml for your instance).&lt;/li&gt;
&lt;li&gt;Create a Plone site if you haven't already.&lt;/li&gt;
&lt;li&gt;Like before, you can use the configuration page at
&lt;a class="reference external" href="http://localhost:8080"&gt;http://localhost:8080&lt;/a&gt;/&amp;lt;your_site_name&amp;gt;/&amp;#64;&amp;#64;pipeline-config , except
this time, configure the import options.&amp;nbsp; My config looks like this:
&lt;a class="reference external" href="http://davidjb.com/wp-content/uploads/2011/01/transmogrifier-import.txt"&gt;transmogrifier-import.txt&lt;/a&gt; - pretty much the same as the default.&lt;/li&gt;
&lt;li&gt;When you're ready, head into the ZMI and into 'portal_setup', this
time clicking on the 'Import' tab.&lt;/li&gt;
&lt;li&gt;Browse down to the very bottom of the page, and use the file field
(hint: Browse button) to locate your .tar.gz file you've prepared.&lt;/li&gt;
&lt;li&gt;Click 'Import uploaded tarball' and watch your console output for
progress.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="cleaning-up"&gt;
&lt;h2&gt;Cleaning up&lt;/h2&gt;
&lt;p&gt;This process wasn't without manual work, unfortunately.&amp;nbsp; But, it
certainly took care of 95% of the pain of copying content across!
Here's an overview of the manual work I had to do:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Set default pages of folders.&amp;nbsp; This could have probably been carried
out by a script but I didn't write one because I only had a 20
folders to fix.&amp;nbsp; In Plone 2.5, I believe the default view was when
you set a page to be called 'index_html' (happy for corrections),
but AFAIK, there weren't options to set a certain page as the view.&lt;/li&gt;
&lt;li&gt;Set site settings.&amp;nbsp; This involved going through all control panels to
pick and manually port settings, but because of so many changes from
Plone 2.5 to 4, there's probably not an obvious migration path
anyway.&lt;/li&gt;
&lt;li&gt;Convert legacy portlets.&amp;nbsp; These settings do get copied across, but
you'll need to go to the 'Manage portlets' link on your main homepage
and click the 'Convert' button.&amp;nbsp; At time of writing (Plone 4.0.2)
this migration is actually broken (ticket logged already!) but you
can just as easily migrate manually -- look in the ZMI properties at
the site root for your portlet listings.&lt;/li&gt;
&lt;li&gt;Fix some workflow states.&amp;nbsp; My old site used a non-default workflow,
so workflow states needed correcting.&amp;nbsp; Thankfully, I was able to push
most content around just using the Types control panel.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;And the rest of the actions I did were simply boilerplate for setting up
a Plone 4 site (theme installation, etc).&lt;/p&gt;
&lt;p&gt;This isn't the most straightforward path, but it did work and get my
content across.&amp;nbsp; Hopefully moving to Plone 5 and above won't be too much
of a problem.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="content"></category><category term="migration"></category><category term="plone"></category><category term="settings"></category><category term="site"></category></entry><entry><title>Checking Plone REQUEST for Ajax'd requests (XMLHttpRequest)</title><link href="http://davidjb.com/blog/2011/01/checking-plone-request-for-ajaxd-requests-xmlhttprequest/" rel="alternate"></link><updated>2011-01-07T10:54:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-01-07:blog/2011/01/checking-plone-request-for-ajaxd-requests-xmlhttprequest/</id><summary type="html">&lt;p&gt;Recently, I've needed a PloneFormGen (PFG) form of mine to have certain
fields excluded when the form is displayed in one of Plone 4's fancy
popups.&amp;nbsp; At the same time, I need this field to still persist within the
'standard' view of the form.&amp;nbsp; It's the request object to the rescue, and
all I've had to do is insert this TALES expression against the &lt;em&gt;Enabling
Expression&lt;/em&gt; for my PFG field:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'HTTP_X_REQUESTED_WITH'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s"&gt;'XMLHttpRequest'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;and the end result is that unless the request is one of XMLHttpRequest,
then we'll show the field.&lt;/p&gt;
&lt;p&gt;Shouldn't be any reason this same TALES couldn't be applied in a page
template against XHTML, or elsewhere.&lt;/p&gt;
</summary><category term="ajax"></category><category term="fields"></category><category term="form"></category><category term="http"></category><category term="pfg"></category><category term="plone"></category><category term="request"></category></entry><entry><title>Buildout: order of 'extends' configuration files</title><link href="http://davidjb.com/blog/2011/01/buildout-order-of-extends-configuration-files/" rel="alternate"></link><updated>2011-01-06T15:00:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-01-06:blog/2011/01/buildout-order-of-extends-configuration-files/</id><summary type="html">&lt;p&gt;Yet another word to the wise: take care of your ordering of the
'extends' configuration files within your buildout.&amp;nbsp; It makes complete
sense, and especially so with respect to version pinning: the later
configuration's versions will be the last one applied.&lt;/p&gt;
&lt;p&gt;So, it makes a lot of sense (in hindsight!) that this configuration, and
the fact I have version pins in my base.cfg, isn't going to end well:&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="k"&gt;[buildout]&lt;/span&gt;
&lt;span class="na"&gt;extends&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;
    base.cfg
    http://good-py.appspot.com/release/dexterity/1.0b2&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The Dexterity version pins are going to override the ones I have in my
base.cfg.&amp;nbsp; This ends up meaning that Plone 4's version pins get applied
first (Plone's main cfg is included in my base.cfg), then my 'custom'
pins in base.cfg, then Dexterity's over the top.&amp;nbsp; Any custom pins I had
for packages used in Dexterity's KGS just got squashed.&lt;/p&gt;
&lt;p&gt;Essentially, if it looks like Buildout isn't paying attention to your
package pins, it's not because it's being disobedient, it's likely
because something's overriding your settings.&lt;/p&gt;
</summary><category term="buildout"></category><category term="config"></category><category term="dexterity"></category><category term="extends"></category><category term="ordering"></category><category term="plone"></category></entry><entry><title>Python eggs and missing files (like 'docs')</title><link href="http://davidjb.com/blog/2011/01/python-eggs-and-missing-files-like-docs/" rel="alternate"></link><updated>2011-01-06T11:57:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-01-06:blog/2011/01/python-eggs-and-missing-files-like-docs/</id><summary type="html">&lt;p&gt;This is pretty trivial (and trivial to fix), but I'm chronicling it for
my knowledge as much as anyone else's.&amp;nbsp; The issue is that a given Python
egg is missing some form of files, most commonly the 'docs' directory in
my experience, because the build wasn't configured correctly.&lt;/p&gt;
&lt;p&gt;The error goes somewhat like this:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;Getting distribution for 'my.theme'.
error: docs/HISTORY.txt: No such file or directory
An error occured when trying to install my.theme 1.5.0. Look above this message for any errors that were output by easy_install.&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The solution is simple: just add the relevant missing directories or
similar into your &lt;tt class="docutils literal"&gt;my.theme/MANIFEST.in&lt;/tt&gt; file, so the end results
looks like so:&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="err"&gt;recursive-include&lt;/span&gt; &lt;span class="err"&gt;docs&lt;/span&gt; &lt;span class="err"&gt;*&lt;/span&gt;
&lt;span class="err"&gt;recursive-include&lt;/span&gt; &lt;span class="err"&gt;my&lt;/span&gt; &lt;span class="err"&gt;*&lt;/span&gt;
&lt;span class="err"&gt;global-exclude&lt;/span&gt; &lt;span class="err"&gt;*py[co],&lt;/span&gt; &lt;span class="err"&gt;*mo&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;where &lt;tt class="docutils literal"&gt;my&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;docs&lt;/tt&gt; are the top-level packages I need.&lt;/p&gt;
&lt;p&gt;Just rebuild the Python egg and away we go. As I said, simple fix. Now
just have to get it stuck in my head to remember.&lt;/p&gt;
</summary><category term="build"></category><category term="docs"></category><category term="egg"></category><category term="file"></category><category term="install"></category><category term="missing"></category><category term="problem"></category><category term="python"></category></entry><entry><title>Bailing on Outlook Web App (Windows Live) and using Gmail with POP/SMTP instead</title><link href="http://davidjb.com/blog/2011/01/bailing-on-outlook-web-app-windows-live-and-using-gmail-with-popsmtp-instead/" rel="alternate"></link><updated>2011-01-05T12:33:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2011-01-05:blog/2011/01/bailing-on-outlook-web-app-windows-live-and-using-gmail-with-popsmtp-instead/</id><summary type="html">&lt;p&gt;I'm not a fan of Microsoft's solutions for mail (Exchange, Outlook,
Outlook Web Access, etc) because they simply aren't as smooth as other
alternatives. In my case, my weapon of choice is Gmail for all my mail.
Unless you really like the old-school style popup windows and Web 1.0
feel of Microsoft's options, you're probably opting for something else,
too. Now, there's no helping my institutional mail account as they've
disabled all standards-compliant forms of access (POP, IMAP, SMTP; short
of going down the route of &lt;a class="reference external" href="http://davmail.sourceforge.net/"&gt;DavMail&lt;/a&gt;). But, that said, there &lt;strong&gt;is&lt;/strong&gt;
hope to be had for my personal account, which is using &amp;quot;Outlook Web App&amp;quot;
or whatever the hosted version of Hotmail is really called. Here's how
you can connect via POP and SMTP.&lt;/p&gt;
&lt;p&gt;This works for me on my tertiary institution's Microsoft-hosted Outlook
solution, so it may or may not work on yours (or work if you're not
using a 'hosted' option). Try it and see!&amp;nbsp; All settings and details I'm
providing here should work with any mail app, but I'm specifically using
Gmail.&lt;/p&gt;
&lt;div class="section" id="before-we-begin"&gt;
&lt;h2&gt;Before we begin&lt;/h2&gt;
&lt;p&gt;Find your POP/SMTP server details by first logging into your Outlook Web
account as normal, and then clicking the drop-down arrow on the Help
icon (it's a &amp;quot;?&amp;quot; icon) on the right-hand side.&amp;nbsp; Click &amp;quot;About&amp;quot; and scroll
down until you find &amp;quot;External POP setting&amp;quot; and &amp;quot;External SMTP setting&amp;quot;.
Make a record of these details (or just keep this popup open while you
configure away).&amp;nbsp; Apparently the addresses can be different for users on
the same domain, so if your friends are trying this, make sure they
follow the same process.&lt;/p&gt;
&lt;p&gt;As a side note, if you're using something that supports IMAP (like
Thunderbird), then you'll find the IMAP settings for Outlook Web under
the About settings too.&amp;nbsp; Gmail doesn't (yet), hence we're using
POP/SMTP.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pop3-downloading-your-mail"&gt;
&lt;h2&gt;POP3 - Downloading your mail&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Go into Gmail and find your account settings (Settings &amp;gt; Accounts)
and click on 'Add a mail account you own'.&lt;/li&gt;
&lt;li&gt;Enter your email address, and click 'Next Step'&lt;/li&gt;
&lt;li&gt;Specify the following details:&lt;ol class="arabic"&gt;
&lt;li&gt;Username: your full email address&lt;/li&gt;
&lt;li&gt;Password: your institutional or other password&lt;/li&gt;
&lt;li&gt;POP Server: [what setting you found before]&lt;/li&gt;
&lt;li&gt;Port: [what setting you found before]&lt;/li&gt;
&lt;li&gt;Check &amp;quot;Always use a secure connection (SSL) when retrieving mail&amp;quot;.&lt;/li&gt;
&lt;li&gt;Other options are up to you.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Click 'Save Changes' and Gmail should now start checking your mail
via POP.&amp;nbsp; Look in the accounts listing to make sure everything is
working.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="smtp-sending-your-mail"&gt;
&lt;h2&gt;SMTP - Sending your mail&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Go into Gmail and find your account settings (Settings &amp;gt; Accounts)
and click on 'Add another email address you own'.&lt;/li&gt;
&lt;li&gt;Enter your name and email address you'd like shown on the mail you
send and click 'Next Step'&amp;nbsp; This should be the same as the email
above.&lt;/li&gt;
&lt;li&gt;Select &amp;quot;Sent through xxx.com SMTP servers (recommended for
professional domains)&amp;quot;, and enter these details:&lt;ol class="arabic"&gt;
&lt;li&gt;SMTP Server:&amp;nbsp; [what setting you found before]&lt;/li&gt;
&lt;li&gt;Port: [what setting you found before]&lt;/li&gt;
&lt;li&gt;Username: your full email address&lt;/li&gt;
&lt;li&gt;Password: your institutional or other password&lt;/li&gt;
&lt;li&gt;Check &amp;quot;Always use a secure connection (SSL) when sending mail&amp;quot;.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Click the 'Add Account' button and Gmail will check your settings.
Everything should be fine unless your domain settings disallow you
from this sort of access.&lt;/li&gt;
&lt;li&gt;Try and send an email!&amp;nbsp; You should be able to do so successfully.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="wrapping-up"&gt;
&lt;h2&gt;Wrapping up&lt;/h2&gt;
&lt;p&gt;Log out of Outlook Web App and forget it even exists.&amp;nbsp; Problem solved.&lt;/p&gt;
&lt;p&gt;Now if only things were this easy for Microsoft's BPOS / Exchange for my
university...&lt;/p&gt;
&lt;/div&gt;
</summary><category term="email"></category><category term="freedom"></category><category term="gmail"></category><category term="live"></category><category term="microsoft"></category><category term="outlook"></category><category term="pop3"></category><category term="smtp"></category></entry><entry><title>DIY - Replace your Logitech Premium Notebook Headset foam ear pads</title><link href="http://davidjb.com/blog/2010/12/replace-your-logitech-premium-notebook-headset-foam-ear-pads/" rel="alternate"></link><updated>2010-12-04T00:56:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-12-04:blog/2010/12/replace-your-logitech-premium-notebook-headset-foam-ear-pads/</id><summary type="html">&lt;p&gt;So, I'm the proud owner of a set of a &lt;a class="reference external" href="http://www.logitech.com/en-gb/speakers-audio/headphones/devices/223"&gt;Logitech Premium Notebook
Headset&lt;/a&gt;. I purchased these headphones a fair while ago - around 2
years - and just like any set of headphones, the foam ear pads
deteriorated away when I took them out to use them after a long spell in
storage. Usually, this wouldn't be a problem if it were a set of
headphones that used a standard shaped ear pad -- just buy some
replacement foam pages and put them on. These headphones aren't so, with
the shape being more like a D shape rather than an oval or circle.&lt;/p&gt;
&lt;p&gt;Now, Googling around lead me to find posts like &lt;a class="reference external" href="http://forums.logitech.com/t5/Headphones-Headsets-Microphones/Premium-Notebook-Headset-Foam-Earpad-Replacements/td-p/87499"&gt;this&lt;/a&gt; discussing that
Logitech don't sell replacement pads. That post's pretty old but it's
still relevant, since I can't find anywhere that mentions a solution.
People might want to give up and buy another set, but I for one am not
going to settle for letting a $60 pair of headphones go to waste for
such a trivial reason. In addition, looking around on eBay for &lt;strong&gt;cheap&lt;/strong&gt;
replacement foam pads meant it was circular pads or bust. Hmm.&amp;nbsp; This
post covers how to quickly and cheaply &lt;em&gt;replace your pads&lt;/em&gt;!&lt;/p&gt;
&lt;p&gt;The short answer is to buy this or similar:
&lt;a class="reference external" href="http://cgi.ebay.com.au/ws/eBayISAPI.dll?ViewItem&amp;amp;item=160508622179"&gt;http://cgi.ebay.com.au/ws/eBayISAPI.dll?ViewItem&amp;amp;item=160508622179&lt;/a&gt;--
it's a 4.5cm-diameter (45mm) black foam pad, with a good amount of depth
to it (for stretching). Buy this, and replace your pads. Problem solved
for a mere &lt;strong&gt;$2&lt;/strong&gt; including shipping (give or take)..and I got 4 pairs
of pads.&amp;nbsp; For a more detailed outline, read on.&lt;/p&gt;
&lt;p&gt;So, my solution is simply buy a suitably sized set of circular pads, and
I have a very good feeling this is what Logitech use. Measuring up my
ear speaker housing on the headphones, I approximated the shape to be an
oval. Thanks to the fact foam has a bit of flexibility and give, I
figured that you can &amp;quot;squish&amp;quot; a circular pad, and have it almost form
the right shape. Using some maths, I calculated what sort of circle size
could be squashed to result in a correctly-sized oval (eg reduce height
to increase width) and the answer is a &lt;strong&gt;4.5cm (45mm) foam pad&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;I've since discarded my actual working out, but my working depended on
the axiom that the foam pad's area (in a 2D plane) remains constant when
being squished.&amp;nbsp; Whether my theory and calculations were perfect, I
don't know, but I do know that I bought that given item from eBay, and
with the tiniest amount of manipulation, the pads slipped on and my
headphones are perfect.&amp;nbsp; The fit is nice and snug; seemingly, I won't
need glue to keep them on.&amp;nbsp; Yay for maths in the real world!&lt;/p&gt;
&lt;p&gt;The item mentioned above has sold and I'm not sure if the seller has any
more (or will have in 2 years when I need more pads!).&amp;nbsp; In any case, as
long as the pads are that diameter, and have a decent depth/height to
them (eg will fit around the earphones and be held in place), then you
should be fine.&lt;/p&gt;
&lt;p&gt;Good luck fixing your headsets.&lt;/p&gt;
</summary><category term="foam"></category><category term="headphones"></category><category term="logitech"></category><category term="maths"></category><category term="pads"></category><category term="problem"></category><category term="solution"></category></entry><entry><title>Bad relationships: RelationChoice, RelationCatalog and removed Dexterity content in Plone</title><link href="http://davidjb.com/blog/2010/10/bad-relationships-relationchoice-relationcatalog-and-removed-dexterity-content-in-plone/" rel="alternate"></link><updated>2010-10-26T17:38:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-10-26:blog/2010/10/bad-relationships-relationchoice-relationcatalog-and-removed-dexterity-content-in-plone/</id><summary type="html">&lt;p&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; this post isn't giving relationship advice (or..it is in
some twisted way).&amp;nbsp; Unsurprisingly, removing content in Plone via the
ZMI when Plone says something can't be deleted is likely to cause
problems.&lt;/p&gt;
&lt;p&gt;In my case, the fact I removed a Dexterity-based container (&amp;quot;Project&amp;quot;)
caused users to no longer add or edit content of my Project type.&amp;nbsp; The
reason for this boiled down to my use of RelationChoice fields, in order
link Projects to Person objects and vice versa.&amp;nbsp; The backend storage for
the RelationChoice field is an instance of
&lt;tt class="docutils literal"&gt;z3c.relationfield.index.RelationCatalog&lt;/tt&gt;, and this keeps records of where
the relations are going to and going from.&lt;/p&gt;
&lt;p&gt;Now, I created a test Project and some content underneath it.&amp;nbsp; Due to
some strange KSS errors I was getting on said content, I decided to try
deleting the parent Project.&amp;nbsp; Plone complained, telling me that the
content couldn't be deleted, and giving the same KSS traceback errors.
Needing to get rid of the Project, I decided to traipse into the ZMI and
manually delete the Project that way.&amp;nbsp; I thought I was successful.&amp;nbsp; I
was, but I caused more problems because the Project I made was still
pointing at a Person object.&lt;/p&gt;
&lt;p&gt;Several days later, users began complaining of not being able to add new
Projects or edit existing Project content either.&amp;nbsp; The traceback looked
like this:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;2010-10-26 13:30:02 ERROR Zope.SiteErrorLog 1288063802.910.831336088181 http://localhost:8080/plone/programs/sample-project/&amp;#64;&amp;#64;edit
Traceback (innermost last):
  Module ZPublisher.Publish, line 119, in publish
  Module ZPublisher.mapply, line 88, in mapply
  Module ZPublisher.Publish, line 42, in call_object
  Module plone.z3cform.layout, line 64, in __call__
  Module plone.z3cform.layout, line 54, in update
  Module plone.dexterity.browser.edit, line 32, in update
  Module plone.z3cform.fieldsets.extensible, line 59, in update
  Module plone.z3cform.patch, line 30, in GroupForm_update
  Module z3c.form.group, line 138, in update
  Module z3c.form.action, line 99, in execute
  Module z3c.form.button, line 311, in __call__
  Module z3c.form.button, line 170, in __call__
  Module plone.dexterity.browser.edit, line 21, in handleApply
  Module z3c.form.group, line 117, in applyChanges
  Module zope.event, line 23, in notify
  Module zope.component.event, line 26, in dispatch
  Module zope.component._api, line 130, in subscribers
  Module zope.component.registry, line 290, in subscribers
  Module zope.interface.adapter, line 535, in subscribers
  Module zope.component.event, line 33, in objectEventNotify
  Module zope.component._api, line 130, in subscribers
  Module zope.component.registry, line 290, in subscribers
  Module zope.interface.adapter, line 535, in subscribers
  Module z3c.relationfield.event, line 82, in updateRelations
  Module zc.relation.catalog, line 546, in unindex
  Module zc.relation.catalog, line 556, in unindex_doc
  Module zc.relation.catalog, line 622, in _remove
KeyError: 128268893&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;These errors were strange, because the KeyError was different every
time. After several hours of delving through code, it was clear that the
ZC relation catalog was expecting a given key but not finding it (as the
traceback suggests). After poking around in the RelationCatalog's
storage, there were a variety of references sticking around that
involved the old Project that I'd deleted. I hacked in a:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;\&lt;span class="n"&gt;_object&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;catalog&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;findRelations&lt;/span&gt;&lt;span class="p"&gt;({}))]&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;at line 84 of &lt;tt class="docutils literal"&gt;z3c/relationfield/event.py&lt;/tt&gt;, and it showed references
to objects that no longer existed.&lt;/p&gt;
&lt;p&gt;Trying to use the &lt;tt class="docutils literal"&gt;removeRelations&lt;/tt&gt; method of
&lt;tt class="docutils literal"&gt;z3c/relationfield/event.py&lt;/tt&gt; isn't useful, because that swallows up
the same KeyError, so in order to remove the borked relations, it would
have to be done manually. That said, the underlying storage for the
RelationCatalog goes over my head.&lt;/p&gt;
&lt;p&gt;So, due to time constraints, I resolved my issues by using the catalog's
&amp;quot;clear&amp;quot; method to remove all records. Easily done by inserting:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;catalog&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;at line 84 of &lt;tt class="docutils literal"&gt;z3c/relationfield/event.py&lt;/tt&gt; (and removing
after I edited a Project and invoked said code). Clearing the catalog
didn't break any of relations for my content, and everything's now
re-indexed after each Project was edited and saved again.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Word to the wise:&lt;/strong&gt; if you're working with this sort of tech, figure
out why you can't delete something and solve that, rather than hacking
away. It will come back to bite you. Let me know if you've fixed a
similar issue without needing to clear the catalog.&lt;/p&gt;
</summary><category term="borked"></category><category term="dexterity"></category><category term="plone"></category><category term="problem"></category><category term="zope"></category></entry><entry><title>Linux: Printing at James Cook University</title><link href="http://davidjb.com/blog/2010/10/linux-printing-at-james-cook-university/" rel="alternate"></link><updated>2010-10-04T15:57:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-10-04:blog/2010/10/linux-printing-at-james-cook-university/</id><summary type="html">&lt;p&gt;Printing at JCU is difficult on Linux, given JCU exists as a Windows
environment. The fact that Xerox Postscript drivers for Linux aren't
exactly straight forward to install doesn't help either - they require
custom filter applications to be compiled.&lt;/p&gt;
&lt;div class="section" id="setting-up-the-drivers"&gt;
&lt;h2&gt;Setting up the drivers&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;To make sure you have the right drivers, get this file:
&lt;a class="reference external" href="http://davidjb.com/wp-content/uploads/2008/12/fxlinuxprint-src-1.0.1.tar.gz"&gt;fxlinuxprint-src-1.0.1.tar.gz&lt;/a&gt;, which is the drive source kindly
obtained from the &lt;a class="reference external" href="http://www.fujixerox.co.jp/download/apeosport/download/c4300series/linux_module.html"&gt;Japanese Xerox site&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Extract the archive somewhere on your hard drive:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
tar -xf fxlinuxprint-src-1.0.1.tar.gz
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Make sure you've got &lt;strong&gt;build-essential&lt;/strong&gt; and &lt;strong&gt;libcups2-dev&lt;/strong&gt;
packages installed (if on Debian/Ubuntu). Other systems (Red Hat,
CentOS) will require equivalent packages; post if you've done it.&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get install build-essential libcups2-dev
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;CMMI:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
./configure
make
sudo make install
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Select this as your PPD when adding your printer as this file:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
/usr/share/cups/model/FujiXerox/en/fxlinuxprint.ppd&lt;span class="o"&gt;[&lt;/span&gt;/sourcecode&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="setting-up-the-printer"&gt;
&lt;h2&gt;Setting up the printer&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Add a new &lt;tt class="docutils literal"&gt;Windows printer via SAMBA&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Specify the printer address as
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;smb://AD/137.219.9.111/DB017-51-Colour&lt;/span&gt;&lt;/tt&gt;, where 'DB017-51-Colour'
is your printer name (you'll probably need to ask someone or browse
the machine at 137.219.9.111 to find out; on Linux you can use
&lt;tt class="docutils literal"&gt;smbclient &lt;span class="pre"&gt;-L&lt;/span&gt; [hostname]&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;Set your authentication details (JC number and password)&lt;/li&gt;
&lt;li&gt;Press Verify to make sure it works, and then click Forward&lt;/li&gt;
&lt;li&gt;Under &amp;quot;Choose Driver&amp;quot; (or when selecting a Make and Model), make sure
you choose to &amp;quot;Provide PPD file&amp;quot;, and use the one that you've just
installed using the instructions above.
(&lt;tt class="docutils literal"&gt;/usr/share/cups/model/FujiXerox/en/fxlinuxprint.ppd&lt;/tt&gt;). Click
'Forward' when done.&lt;/li&gt;
&lt;li&gt;Add the rest of your printer's details and click Apply.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Try and print something and it should be good now.&lt;/p&gt;
&lt;/div&gt;
</summary></entry><entry><title>Oh Microsoft, we do tire of thy bugs in IE</title><link href="http://davidjb.com/blog/2010/07/oh-microsoft-we-do-tire-of-thy-bugs-in-ie/" rel="alternate"></link><updated>2010-07-22T17:20:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-07-22:blog/2010/07/oh-microsoft-we-do-tire-of-thy-bugs-in-ie/</id><summary type="html">&lt;p&gt;Yes, it's another post about Microsoft and its poor implementation of
Internet Explorer. This time it's version 8 and its rendering of lists,
and in specific, links within list items. Most humorously, Microsoft's
own documentation (separate issue; about &lt;a class="reference external" href="http://msdn.microsoft.com/en-us/library/bb250413%28VS.85%29.aspx"&gt;rounded corners&lt;/a&gt;) gave me a
laugh when it said:&lt;/p&gt;
&lt;blockquote&gt;
&amp;quot;Microsoft is committed to providing a browser that
accurately supports Web standards.&amp;quot;&lt;/blockquote&gt;
&lt;p&gt;Maybe it's just me, but I've given up waiting for the day that IE actually
supports anything correctly.&lt;/p&gt;
&lt;p&gt;So, the issue I found was that with a &lt;tt class="docutils literal"&gt;&amp;lt;ul&amp;gt;&lt;/tt&gt; with a number of &lt;tt class="docutils literal"&gt;&amp;lt;li&amp;gt;&lt;/tt&gt;
tags inside wouldn't stop displaying the list bullets, despite a very
explicit CSS definition on the &lt;tt class="docutils literal"&gt;&amp;lt;li&amp;gt;&lt;/tt&gt; tags.&amp;nbsp; Why this was the case,
I'm not sure, and am happy to chalk it up to IE being IE, like it always
is.&lt;/p&gt;
&lt;p&gt;In order to fix the issue, however, I just started poking and prodding
IE in its Developer Toolbar with extra styles until it did what I wanted
it to.&amp;nbsp; Turns out that at least in my case, that in order to remove all
trace of bullets, I needed to have the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;list-style:none&lt;/span&gt; outside none;&lt;/tt&gt;
CSS declaration attached to the &lt;tt class="docutils literal"&gt;&amp;lt;ul&amp;gt;&lt;/tt&gt;, each &lt;tt class="docutils literal"&gt;&amp;lt;li&amp;gt;&lt;/tt&gt;, and the top
level &lt;tt class="docutils literal"&gt;&amp;lt;a&amp;gt;&lt;/tt&gt; tags that were inside the &lt;tt class="docutils literal"&gt;&amp;lt;li&amp;gt;&lt;/tt&gt; tags.&amp;nbsp; Talk about
repeating myself.&amp;nbsp; You'd think that the CSS would be applied to the
&lt;tt class="docutils literal"&gt;&amp;lt;ul&amp;gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&amp;lt;li&amp;gt;&lt;/tt&gt;, which are list elements, and not be needed for
the &lt;tt class="docutils literal"&gt;&amp;lt;a&amp;gt;&lt;/tt&gt; tag, which shouldn't matter despite it being in an &lt;tt class="docutils literal"&gt;&amp;lt;li&amp;gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I guess the good news is that you can bash the crap out of IE until it
works and Microsoft has provided the Developer Toolbar.&amp;nbsp; The bad news is
that &amp;quot;fixes&amp;quot; aren't always so obvious because you can never trust where
the bug could be.&lt;/p&gt;
&lt;p&gt;As a final aside about IE 8, here's another snippet from that &lt;a class="reference external" href="http://msdn.microsoft.com/en-us/library/bb250413%28VS.85%29.aspx"&gt;same
documentation&lt;/a&gt; about IE8:&lt;/p&gt;
&lt;blockquote&gt;
In Internet Explorer 8, we shipped several features from HTML5 and
CSS3. Our primary goal was implementing CSS 2.1 (a specification
that has reached final candidate stage) &lt;em&gt;completely and correctly&lt;/em&gt;
before moving on to specifications that are still in development and
may change.&lt;/blockquote&gt;
&lt;p&gt;Completely and correctly implemented?&amp;nbsp; Again, I'm still waiting.&lt;/p&gt;
</summary><category term="bug"></category><category term="css"></category><category term="html"></category><category term="IE"></category><category term="ie8"></category><category term="internet explorer"></category><category term="rendering"></category><category term="tag"></category><category term="tags"></category></entry><entry><title>Plone/Zope: Truncating a Data.fs back to a certain date/time</title><link href="http://davidjb.com/blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/" rel="alternate"></link><updated>2010-07-20T13:39:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-07-20:blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/</id><summary type="html">&lt;p&gt;Okay. So, anyone out here who's listening -- particularly those
overly-enthusiastic users -- don't try to recursively &lt;tt class="docutils literal"&gt;wget&lt;/tt&gt; your
Plone site (or other CMS, for that matter) whilst you're logged in with
an account that can make edits. It &lt;strong&gt;will&lt;/strong&gt; lead to a very bad situation
where your site administrator and technical team need to step in and fix
your mistakes. For the uninitiated, a loose recursive wget (when logged
in with some degree of Edit rights) will hit every link that's on your
pages, and I mean in the (X)HTML &lt;em&gt;source&lt;/em&gt;. For a Plone site, this means
hitting every &amp;quot;Edit&amp;quot; link, every &amp;quot;Revert to this version&amp;quot; link, and
every other link that might be dangerous when clicked randomly. Oh, and
if the account you've got has admin rights, well, it's not getting any
better and requires the Data.fs to be undone back to before it happened.
Here's how to do that easily.&lt;/p&gt;
&lt;p&gt;So enough of the backstory. How to fix a suitably bollocks'd Data.fs?
Well, the easy answer is to recover from a backup. Of course you've got
plenty of those, right? No? Oh dear. Never to stress, you can use your
existing Data.fs file and strip away any number of transactions, to
bring your file back to any date, time, or transaction you'd like.&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;Realise you'll be losing everything from now back until then, so take
a copy of data off your Plone site, back up your Data.fs (twice, if
need be), and make it crystal clear to your users changes are going
bye-by.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Figure out when you want to go back to.&amp;nbsp; If you want a particular
transaction, consider checking your Zope Undo log to locate the
specific date/time of a given transaction.&amp;nbsp; Otherwise, figure out the
date and time.&amp;nbsp; Then, convert that date and time to UTC as that what
date/times are in the Data.fs.&amp;nbsp; In Queensland, Australia, we're +10
hours.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Shut down ZEO if it's still running.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Edit &lt;tt class="docutils literal"&gt;parts/zope2/lib/python/ZODB/FileStorage/fsdump.py&lt;/tt&gt;, and add
this to allow you to run this file:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Get your PYTHONPATH sorted for running this file.&amp;nbsp; Consider
&lt;tt class="docutils literal"&gt;./bin/instance1&lt;/tt&gt; shell, if you've got a Plone instance, or using
zopepy.&amp;nbsp; Manually update it if necessary.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Run the the &lt;tt class="docutils literal"&gt;fsdump.py&lt;/tt&gt; script thusly, substituting the date for
yours (or a date/time):&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
./bin/python parts/zope2/lib/python/ZODB/FileStorage/fsdump.py var/filestorage/Data.fs | grep 2010-07-12
&lt;/pre&gt;
&lt;p&gt;This will tell you exactly the offset you need to truncate the
Data.fs file.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Take that offset amount and truncate your Data.fs file, inserting the
number after &amp;quot;seek=&amp;quot;:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
dd &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/dev/zero &lt;span class="nv"&gt;of&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;var/filestorage/Data.fs &lt;span class="nv"&gt;seek&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;199340531 &lt;span class="nv"&gt;bs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1 &lt;span class="nv"&gt;count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Restart your ZEO service and re-connect to it from your Plone/Zope
instance.&amp;nbsp; Your database should be back to the date and time you
specified.&amp;nbsp; If it's close, but not quite right, check your times and
that they're UTC.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Get some backups and politely ask your users to think twice about any
such consequences next time.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;And we're done!&lt;/p&gt;
</summary><category term="data.fs"></category><category term="database"></category><category term="date"></category><category term="fix"></category><category term="linux"></category><category term="plone"></category><category term="python"></category><category term="time"></category><category term="truncate"></category><category term="zeo"></category><category term="zodb"></category><category term="zodb3"></category><category term="zope"></category></entry><entry><title>Plone: running Plone without copies of blobs</title><link href="http://davidjb.com/blog/2010/07/plone-running-plone-without-copies-of-blobs/" rel="alternate"></link><updated>2010-07-13T16:30:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-07-13:blog/2010/07/plone-running-plone-without-copies-of-blobs/</id><summary type="html">&lt;p&gt;Having a bad day? Just bombed your only copies of some files that you'd
been storing as blobs together with your Plone database? Maybe you had
the blobs stored incorrectly on your Zeo client, rather than the server,
and then in a hasty effort to free some space (due to an on-going issue
with blobs eating HDD space), deleted them. Whoops..they're gone and
their references are still in your Plone database. Or, in a less
disastrous situation, maybe you just want to be able to run your Plone
database without needing lost blobs? Read on.The suggestion, as
mentioned elsewhere on the Interwebs, is to catch the exception that
gets raised on accessing relevant blobs. The two locations to catch (as
of plone.app.blob 1.0b18) are:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;plone/app/blob/mixins.py&lt;/strong&gt;&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;getScale&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; get scale by name or original &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getUnwrapped&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;handler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IImageScaleHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getScale&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;plone/app/blob/field.py&lt;/strong&gt;&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; return the size of the blob &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;blob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;openBlob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;blob&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fstat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;blob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;st_size&lt;/span&gt;
        &lt;span class="n"&gt;blob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;If you put these try/catch statements in, you'll stop your site from
dying when accessing the View and Edit pages for your content. This
means you can safely replace lost blobs with files again, or otherwise
just use your site without the files, like if your client sends you only
the database to save on size. Happy days.&lt;/p&gt;
</summary><category term="blob"></category><category term="blobs"></category><category term="files"></category><category term="patch"></category><category term="plone"></category><category term="problem"></category><category term="python"></category></entry><entry><title>Plone: Overrides.zcml gets auto-included with z3c.autoinclude</title><link href="http://davidjb.com/blog/2010/07/plone-overrides-zcml-gets-auto-included-with-z3c-autoinclude/" rel="alternate"></link><updated>2010-07-13T15:01:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-07-13:blog/2010/07/plone-overrides-zcml-gets-auto-included-with-z3c-autoinclude/</id><summary type="html">&lt;p&gt;Unsurprisingly, specifying a z3c.autoinclude entry point in your Plone
product egg means your ZCML gets automatically included. That's great
because it means you don't have to specify your product under the ZCML
section of your instance in buildout. One thing that isn't so obvious
(it's not mentioned that I can see on &lt;a class="reference external" href="http://plone.org/products/plone/roadmap/247"&gt;plone.org&lt;/a&gt;) is that if your
package is marked for ZCML autoinclude, then Plone will automatically
load an &lt;tt class="docutils literal"&gt;overrides.zcml&lt;/tt&gt; file in your product.&lt;/p&gt;
&lt;p&gt;Nothing hits you like a slippery wet fish in the face more than hitting
this issue and having it obfuscated through a lot of different layers.
The first symptom was that my content icons weren't appearing within my
Plone site. Only some of them though -- the ones in folder listings and
the navigation portlet. I thought nothing much of it initially, just
thinking the setting for displaying content icons had been changed in
the Plone control panel.&lt;/p&gt;
&lt;p&gt;I started digging into this issue a bit more because it was annoying me.
That, and changing the control panel's options weren't working. Hacking
a few bits into the folder_listing.pt view showed me that icons were
there, just not outputting any HTML. Weird. Outputting the actual type
of the icon brain itself showed me:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
myorg.theme.layout.icons.CatalogBrainContentIcon
&lt;/pre&gt;
&lt;p&gt;and didn't think much of it. So what, a class is being generated at run
time for my theme? It wouldn't surprise me -- Python can do some pretty
cool things and that's probably just one of them.&lt;/p&gt;
&lt;p&gt;Taking the &lt;tt class="docutils literal"&gt;CatalogBrainContentIcon&lt;/tt&gt; string and &lt;tt class="docutils literal"&gt;grep&lt;/tt&gt;'ing for it
showed me otherwise. My theme package had this class, amongst others,
hanging around in it's &lt;tt class="docutils literal"&gt;layout&lt;/tt&gt; module. Moving the module and
restarting Zope showed me that the ZCML was being loaded.&lt;/p&gt;
&lt;p&gt;But how/why? It was definitely excluded from my main &lt;tt class="docutils literal"&gt;configure.zcml&lt;/tt&gt;
files..but not excluded entirely though. Little did I realise that I had
an &lt;tt class="docutils literal"&gt;overrides.zcml&lt;/tt&gt; file floating around. Commented out from
&lt;tt class="docutils literal"&gt;configure.zcml&lt;/tt&gt;, but still there all the same. Turns out adding the
z3c.autoinclude entry point to the theme product makes Plone
auto-include all &lt;tt class="docutils literal"&gt;overrides.zcml&lt;/tt&gt; (unless told otherwise).
&lt;strong&gt;*fish-smack to face*&lt;/strong&gt; This behaviour was modified slightly in Plone
4.0a5, so that you can make your &lt;tt class="docutils literal"&gt;overrides.zcml&lt;/tt&gt; be excluded, but
that doesn't mean anything about Plone 3.3.5.&lt;/p&gt;
&lt;p&gt;So, watch out with seemingly innocuous ZCML files floating around. They
can still be brought into play.&lt;/p&gt;
</summary><category term="auto"></category><category term="icons"></category><category term="include"></category><category term="plone"></category><category term="plone 3"></category><category term="problem"></category><category term="theme"></category><category term="z3c"></category><category term="zcml"></category><category term="zope"></category></entry><entry><title>Linux: Make time with faketime</title><link href="http://davidjb.com/blog/2010/07/linux-make-time-with-faketime/" rel="alternate"></link><updated>2010-07-12T12:02:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-07-12:blog/2010/07/linux-make-time-with-faketime/</id><summary type="html">&lt;p&gt;So you, like me, have hit a situation where you've got a time-sensitive
application that won't run? Maybe you've downloaded one of those apps
(like a demo) that won't run after a certain date and time because it's
&amp;quot;expired&amp;quot;. Or else, maybe some other arbitrary time constraint is
keeping you from running a Linux (or even Windows) program. On Linux
(Ubuntu for me), there's &lt;tt class="docutils literal"&gt;faketime&lt;/tt&gt; to the rescue - a very handy tool
that does what it says on the box, changes the system time for given
command.&lt;/p&gt;
&lt;p&gt;After installing faketime by something like:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get install faketime
&lt;/pre&gt;
&lt;p&gt;you can run your program like this, and see the results:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
faketime &lt;span class="s1"&gt;'last Friday 5 pm'&lt;/span&gt; /bin/date
faketime &lt;span class="s1"&gt;'2008-12-24 08:15:42'&lt;/span&gt; /bin/date
&lt;/pre&gt;
&lt;p&gt;Sweet as. Now, if you're running a Windows app in Wine (or any other app
with arguments), you can do that too. In my specific use-case, I was
trying to use &lt;a class="reference external" href="http://www.zonums.com/shp2kml.html"&gt;shp2kml&lt;/a&gt;. Ignoring the fact their website fails at
actually letting me download the file (I had to get my version
elsewhere; copied here for posterity: &lt;a class="reference external" href="http://davidjb.com/static/files/Shp2kml.zip"&gt;Shp2kml.zip&lt;/a&gt;), their program fails
at running due to it being &amp;quot;expired&amp;quot;. Noting other posts about people
turning back their clocks to 2006, I did the same thing with faketime,
so as not to stuff around with my system clock.&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
faketime &lt;span class="s1"&gt;'2006-09-20'&lt;/span&gt; wine Shp2kml.exe
&lt;/pre&gt;
&lt;p&gt;and voila, it works. Seems like the change affects Wine's start-up a
little when first starting with the new date, but it does work just
fine. Yay for Linux!&lt;/p&gt;
</summary><category term="faketime"></category><category term="fix"></category><category term="linux"></category><category term="shp2svg"></category><category term="time"></category><category term="wine"></category></entry><entry><title>Plone 4: Local Zeo blobs conflict with Plone instance</title><link href="http://davidjb.com/blog/2010/07/plone-4-local-zeo-blobs-conflict-with-plone-instance/" rel="alternate"></link><updated>2010-07-06T16:04:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-07-06:blog/2010/07/plone-4-local-zeo-blobs-conflict-with-plone-instance/</id><summary type="html">&lt;p&gt;As the title suggests, there's a conflict between a Zeo database
instance being run together with a Plone 4/Zope instance, and them
trying to share the same blob storage folder.&amp;nbsp; But, this only happens if
you misunderstand or incorrectly set the option of&amp;nbsp; &lt;em&gt;shared-blob = off&lt;/em&gt;,
and &lt;em&gt;blob-storage&lt;/em&gt; to be the same location as for Zeo in your buildout.
If that previous set of (seemingly jumbled) thoughts doesn't make any
sense to you, then move along, nothing to see here.&lt;/p&gt;
&lt;p&gt;By default, at the time of writing, blob support within Zeo runs with
the &lt;em&gt;bushy&lt;/em&gt;layout, and creates this format by default when starting up
for the first time. Plone 4, however, when trying to stream blobs from
your Zeo database, uses a customised &lt;em&gt;zeocache&lt;/em&gt; blob layout. See where
I'm going with this? You try and inadvertently use these aspects
together and you've got a conflict.&lt;/p&gt;
&lt;p&gt;If you're having this problem, then you'll get weird errors concerning
the &lt;em&gt;layout&lt;/em&gt; of your blobs. Starting the Zope instance before the Zeo
server results in Zope setting the &lt;strong&gt;.layout&lt;/strong&gt; file for the blob storage
to &lt;em&gt;zeocache&lt;/em&gt;. Once your Zope instance errors out and you realise that
your Zeo instance isn't running, you'll inevitably try and start Zeo up.
When you do, you get an error about the layout type not existing:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;/home/david/buildout/parts/zeo/bin/runzeo
&lt;/span&gt;&lt;span class="gt"&gt;Traceback (most recent call last):
&lt;/span&gt;  &lt;span class="c"&gt;...&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;/home/david/buildout/eggs/ZODB3-3.9.5-py2.6-linux-i686.egg/ZODB/blob.py&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;714&lt;/span&gt;, in &lt;span class="n"&gt;__init__&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_blob_init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;base_directory&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;/home/david/buildout/eggs/ZODB3-3.9.5-py2.6-linux-i686.egg/ZODB/blob.py&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;600&lt;/span&gt;, in &lt;span class="n"&gt;_blob_init&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fshelper&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FilesystemHelper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;blob_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;/home/david/buildout/eggs/ZODB3-3.9.5-py2.6-linux-i686.egg/ZODB/blob.py&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;339&lt;/span&gt;, in &lt;span class="n"&gt;__init__&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;layout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LAYOUTS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;layout_name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="gr"&gt;KeyError&lt;/span&gt;: &lt;span class="n"&gt;'zeocache'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Now, if you try to fix this by dumping your now-existing blob storage
folder (a method mentioned to work elsewhere on the web) and starting
your Zeo server first, you'll still get problems. The blob storage gets
created correctly with the 'bushy' layout by Zeo, but trying to start
the Zope instance fails, because Zeo's created its storage accordingly
in the same spot. This is part of the error:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="gt"&gt;Traceback (most recent call last):
&lt;/span&gt;  &lt;span class="c"&gt;...&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;/home/david/buildout/eggs/ZODB3-3.9.5-py2.6-linux-i686.egg/ZODB/blob.py&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;362&lt;/span&gt;, in &lt;span class="n"&gt;create&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;layout_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;base_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="gr"&gt;ValueError&lt;/span&gt;: &lt;span class="n"&gt;Directory layout `zeocache` selected for blob directory /home/david/buildout/var/blobstorage/, but marker found for layout `bushy`&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The two ways of solving this are to:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Change the &lt;em&gt;shared-blob&lt;/em&gt; option to be &lt;strong&gt;on&lt;/strong&gt;. Both Zeo and Zope will
exist in harmony again, both using the &lt;em&gt;bushy&lt;/em&gt; layout.&lt;/li&gt;
&lt;li&gt;Changing the &lt;em&gt;blob-storage&lt;/em&gt; location for either the Zeo server or the
Zope instance. This will result in two separate folders and likely
duplicate files and HDD wastage, but hey, it'll work, right? This is
probably a useful option for testing.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The &lt;em&gt;zeocache&lt;/em&gt; layout is new with Plone 4 (aka, I haven't seen it before
so it probably is), so watch out for this when upgrading.&lt;/p&gt;
&lt;p&gt;Stay tuned for more in this series of Plone 4 upgrade notes.&lt;/p&gt;
</summary><category term="blob"></category><category term="conflict"></category><category term="database"></category><category term="db"></category><category term="files"></category><category term="plone"></category><category term="plone 4"></category><category term="problem"></category><category term="upgrade"></category><category term="zeo"></category></entry><entry><title>Plone: SiteManager leftovers; not the good kind</title><link href="http://davidjb.com/blog/2010/06/plone-sitemanager-leftovers-not-the-good-kind/" rel="alternate"></link><updated>2010-06-28T14:35:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-06-28:blog/2010/06/plone-sitemanager-leftovers-not-the-good-kind/</id><summary type="html">&lt;div class="note"&gt;
&lt;p class="first admonition-title"&gt;Note&lt;/p&gt;
&lt;p class="last"&gt;&lt;strong&gt;Update:&lt;/strong&gt; You should check out &lt;a class="reference external" href="http://pypi.python.org/pypi/wildcard.fixpersistentutilities"&gt;wildcard.fixpersistentutilities&lt;/a&gt;
- it's a fantastic solution to problems like this. Many thanks to
Nathan Van Gheem, the author of the add on. Check out the link and
see how to install it (temporarily) on your Plone instance that
needs its site manager cleaned up.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Leftovers are typically useful when they're in your fridge at home. They
mean you don't have to mess around making lunch for the next day for
work, and can just grab them, and walk right out the door. Now,
leftovers in the zope.component SiteManager aren't so nice, especially
when some Plone products fail to remove what they've registered. The
consequences of this are that you've got references left which will
break things when you uninstall/remove the physical eggs/files. These
leftovers would be ones would be mutated food that comes to kill you
after you've thrown it in the bin, assuming we follow the same analogy.
But how to fix them?&lt;/p&gt;
&lt;p&gt;Here's the error message you might be faced with when trying to install
or uninstall products -- something that stops you might in your tracks:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;2010-06-22T10:38:48 ERROR Zope.SiteErrorLog https://mysite.com/portal_quickinstaller/uninstallProducts
Traceback (innermost last):
Module ZPublisher.Publish, line 125, in publish
Module Zope2.App.startup, line 238, in commit
Module transaction._manager, line 96, in commit
Module transaction._transaction, line 395, in commit
Module transaction._transaction, line 495, in _commitResources
Module ZODB.Connection, line 510, in commit
Module ZODB.Connection, line 555, in _commit
Module ZODB.Connection, line 582, in _store_objects
Module ZODB.serialize, line 407, in serialize
Module ZODB.serialize, line 416, in _dump
PicklingError: Can't pickle &amp;lt;class 'p4a.plonevideoembed.interfaces.IVideoLinkSupport'&amp;gt;: import of module p4a.plonevideoembed.interfaces failed&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Unsurprisingly, it's similar to something I encountered before. Way back
when, I hit the same issue with &lt;a class="reference external" href="http://davidjb.com/blog/2009/04/plone-issues-with-products/"&gt;ZipFileTransport&lt;/a&gt;, and my fix for it
is just as relevant today as it was then. Start up a zopepy session (or
ipython) that still has the relevant classes in the system path, and run
this:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;p4a.plonevideoembed.interfaces&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;IVideoLinkSupport&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;intclass&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;p4a.video.interfaces&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;IVideoSupport&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;intclass2&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;zope.app.component.hooks&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;setSite&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;zope.component&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;getSiteManager&lt;/span&gt;
&lt;span class="n"&gt;setSite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;portal&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;getSiteManager&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unregisterUtility&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;provided&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;intclass&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unregisterUtility&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;provided&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;intclass2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;#Even though unregister happened, it probably said it worked but left crap around.&lt;/span&gt;
&lt;span class="c"&gt;#Let's clean it up.&lt;/span&gt;

&lt;span class="c"&gt;#This intclass variables might not be right or perfectly complete. It's going to be the key present below,&lt;/span&gt;
&lt;span class="c"&gt;#so you can always find the right InterfaceClass manually and set it accordingly.&lt;/span&gt;
&lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_adapters&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;intclass&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_subscribers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;intclass&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_subscribers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;intclass2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_adapters&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;intclass2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c"&gt;#From here, search for a term to see if it's gone&lt;/span&gt;
&lt;span class="c"&gt;#Each should return -1. If not, you've done something wrong!&lt;/span&gt;
&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_adapters&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'p4a'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_subscribers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'p4a'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__bases__&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__dict__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'p4a'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;transaction&lt;/span&gt;
&lt;span class="n"&gt;transaction&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Shut down your existing Plone/Zope instance and restart it. You should
now be able to install or remove products accordingly again -- and also
get rid of those old packages' physical files you don't need.&lt;/p&gt;
</summary><category term="egg"></category><category term="error"></category><category term="install"></category><category term="plone"></category><category term="problem"></category><category term="site"></category><category term="update"></category><category term="zope"></category></entry><entry><title>Plone, Dexterity, and Incorrect Widgets</title><link href="http://davidjb.com/blog/2010/06/plone-dexterity-and-incorrect-widgets/" rel="alternate"></link><updated>2010-06-21T15:09:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-06-21:blog/2010/06/plone-dexterity-and-incorrect-widgets/</id><summary type="html">&lt;p&gt;A nice 'gotcha' is the distinction between Zope's schema.Date and
schema.Datetime. The difference is obvious and straightforward when the
two terms are laid out side-by-side: one is for dates only and the other
adds a time component. Where things fell down for me in my usage of
these fields with a Dexterity-based content type in Plone is the human
component. When these fields are mashed in together within a lot of
other text/Python/names, it's easy to miss those 4 little letters of
'time'. This lead me trying to use a DatetimeFieldWidget when I really
could only use a DateFieldWidget. &lt;strong&gt;Wrong widget for the wrong type =
unpredictable.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;When it's all laid out like that, things are clear and simple. When the
small typo has been made, however, things are far less forgiving and
informative. Thankfully, the typo wasn't my fault, but was caused by a
ZopeSkel template for Dexterity (&lt;a class="reference external" href="http://pypi.python.org/pypi/zopeskel.dexterity"&gt;zopeskel.dexterity&lt;/a&gt;) so I'm not
kicking myself over it. Essentially, the error message (for those of you
possibly experiencing something similar) is like this:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;2010-06-18 16:32:03 ERROR Zope.SiteErrorLog 1276842723.120.730292360531 http://localhost:8080/test/kss_z3cform_inline_validation/validate_input
    Traceback (innermost last):
    Module ZPublisher.Publish, line 119, in publish
    Module ZPublisher.mapply, line 88, in mapply
    Module ZPublisher.Publish, line 42, in call_object
    Module &amp;lt;wrapper&amp;gt;, line 5, in wrapper
    Module kss.core.actionwrapper, line 238, in apply
    Module plone.app.z3cform.kss.validation, line 48, in validate_input
    Module z3c.form.group, line 92, in extractData
    Module z3c.form.form, line 143, in extractData
    Module z3c.form.field, line 302, in extract
    Module z3c.form.converter, line 164, in toFieldValue
    Module zope.i18n.format, line 79, in parse
    Module sre, line 129, in match
    TypeError: expected string or buffer&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;And the end result of this is that you can't validate fields in your
Dexterity content Add form (eg the above traceback is echoed whenever
you click in/out of a field), nor can you actually save your content.
Unfortunately, even if you were to go hunting through the traceback,
you'd probably end up like me and find that the code is trying to
validate a completely different field than the problematic one. No help
whatsoever.&lt;/p&gt;
&lt;p&gt;After going through each of the different fields I had on my content
type, I figured out the cause. If you're hitting a similar issue, check
your widgets. If you're using &lt;a class="reference external" href="http://pypi.python.org/pypi/zopeskel.dexterity"&gt;zopeskel.dexterity&lt;/a&gt;, don't worry though.
I checked in a fix for this issue this morning, correcting the widget to
be used. You'll need to use the latest version from the Plone Collective
SVN to make the templates work correctly.&lt;/p&gt;
&lt;p&gt;On the other hand, you could look at &lt;a class="reference external" href="http://pypi.python.org/pypi/collective.z3cform.datepicker"&gt;collective.z3cform.datepicker&lt;/a&gt;,
which implements a much more user-friendly Date and DateTime widgets
(using jQuery UI etc).&lt;/p&gt;
</summary><category term="content type"></category><category term="datetime"></category><category term="dexterity"></category><category term="fields"></category><category term="form"></category><category term="plone"></category><category term="problem"></category><category term="product"></category><category term="zope"></category></entry><entry><title>Plone/Zope: Using LDAPUserFolder with posixGroups</title><link href="http://davidjb.com/blog/2010/06/plonezope-using-ldapuserfolder-with-posixgroups/" rel="alternate"></link><updated>2010-06-03T16:03:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-06-03:blog/2010/06/plonezope-using-ldapuserfolder-with-posixgroups/</id><summary type="html">&lt;p&gt;Due to various reasons, the Products.LDAPUserFolder package available
for Plone and Zope doesn't support POSIX groups.&amp;nbsp; The 'official' (ish)
reason for this is because of the fact that these groups don't store
full distinguished names (DNs) for members.&amp;nbsp; It makes some degree of
sense, because a user ID like 'david.test' isn't strictly unique.&amp;nbsp; On
the other hand, these types of groups are quite common in LDAP
implementations; not supporting them without giving it at least half a
shot to find the user seems a bit strange.&lt;/p&gt;
&lt;p&gt;Here's where a quick patch steps in. Thanks to Weblion's infinity of
Plone resources (specifically, their article on &lt;a class="reference external" href="https://weblion.psu.edu/trac/weblion/wiki/LDAPWithPlone"&gt;Plone LDAP&lt;/a&gt;), I
patched part of my Products.LDAPUserFolder.&lt;/p&gt;
&lt;p&gt;Now, what they've got wasn't infallible. Whilst the patch they have on
their site took care of enumerating the groups, and the groups a user is
in, it didn't ensure looking a group showed its users. Whether this was
a change in LDAPUserFolder recently (since version 2.12) or not, I'm not
sure.&lt;/p&gt;
&lt;p&gt;In any case, the reason for the issue is that deep down, the code
attempts to query group members by DN. Obviously our POSIX groups don't
have full DNs, so with a quick bit of string manipulation (read:
hacking), I assume that the &lt;em&gt;user base&lt;/em&gt; you specify will have your user.
&lt;strong&gt;Note:&lt;/strong&gt; this won't do one iota if your user isn't at the user base,
but if it is -- like all the LDAPs I've used -- you're golden. Here's
the patch for Products.LDAPUserFolder 2.17.&lt;/p&gt;
&lt;pre class="code diff literal-block"&gt;
&lt;span class="gh"&gt;diff --git a/Products/LDAPUserFolder/LDAPUserFolder.py b/Products/LDAPUserFolder/LDAPUserFolder.py
index 0e61396..a235e74 100644
&lt;/span&gt;&lt;span class="gd"&gt;--- a/Products/LDAPUserFolder/LDAPUserFolder.py
&lt;/span&gt;&lt;span class="gi"&gt;+++ b/Products/LDAPUserFolder/LDAPUserFolder.py
&lt;/span&gt;&lt;span class="gu"&gt;&amp;#64;&amp;#64; -950,6 +950,7 &amp;#64;&amp;#64; class LDAPUserFolder(BasicUserFolder):
&lt;/span&gt;
for dn in all_dns.keys():
try:
&lt;span class="gi"&gt;+                if 'uid=' not in dn: dn = ('uid='+dn+','+self.users_base)
&lt;/span&gt;user = self.getUserByDN(dn)
except:
user = None
&lt;span class="gu"&gt;&amp;#64;&amp;#64; -1216,6 +1217,8 &amp;#64;&amp;#64; class LDAPUserFolder(BasicUserFolder):
&lt;/span&gt;f_template = '(&amp;amp;amp;amp;(objectClass=%s)(%s=%s))'
group_filter = '(|'

&lt;span class="gi"&gt;+                dn = dn.replace('uid=','').replace(','+self.users_base,'')
+
&lt;/span&gt;for g_name, m_name in GROUP_MEMBER_MAP.items():
fltr = filter_format(f_template, (g_name, m_name, dn))
group_filter += fltr
&lt;span class="gh"&gt;diff --git a/Products/LDAPUserFolder/utils.py b/Products/LDAPUserFolder/utils.py
index 4a88cd7..26b73bc 100644
&lt;/span&gt;&lt;span class="gd"&gt;--- a/Products/LDAPUserFolder/utils.py
&lt;/span&gt;&lt;span class="gi"&gt;+++ b/Products/LDAPUserFolder/utils.py
&lt;/span&gt;&lt;span class="gu"&gt;&amp;#64;&amp;#64; -48,6 +48,7 &amp;#64;&amp;#64; GROUP_MEMBER_MAP = { 'groupOfUniqueNames' : 'uniqueMember'
&lt;/span&gt;, 'accessGroup' : 'member'
, 'group' : 'member'
, 'univentionGroup' : 'uniqueMember'
&lt;span class="gi"&gt;+                  , 'posixGroup' : 'memberUid'
&lt;/span&gt;}

VALID_GROUP_ATTRIBUTES = Set(list(GROUP_MEMBER_MAP.values()) +
&lt;/pre&gt;
</summary><category term="groups"></category><category term="ldap"></category><category term="ldapuserfolder"></category><category term="openldap"></category><category term="patch"></category><category term="plone"></category><category term="python"></category><category term="zope"></category></entry><entry><title>Virtualenv, Python 2.4, Plone 3.x and Lucid Lynx (Ubuntu 10.04)</title><link href="http://davidjb.com/blog/2010/05/virtualenv-python-2-4-plone-3-x-and-lucid-lynx-ubuntu-10-04/" rel="alternate"></link><updated>2010-05-12T14:47:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-05-12:blog/2010/05/virtualenv-python-2-4-plone-3-x-and-lucid-lynx-ubuntu-10-04/</id><summary type="html">&lt;p&gt;These titles of my posts just keep getting longer and longer.&amp;nbsp; For those
of you paying close attention (I know who you are), this is the next in
my series of getting the above-mentioned tools working together.
Previously, it was Centos 5.x, Jaunty (9.04), Karmic (9.10) and now
Lucid (10.04).&amp;nbsp; Only subtly different, each of this distributions has
pretty much called for its own post on the matter of getting a working
Plone 3.x / Python 2.4 virtualenv installation going.&amp;nbsp; So, here goes
this time around.&lt;/p&gt;
&lt;div class="section" id="install-python-2-4-first"&gt;
&lt;h2&gt;Install Python 2.4 first&lt;/h2&gt;
&lt;p&gt;If you've not done so already, you need to install Python 2.4.&amp;nbsp; Lucid
now no longer comes with the packages for Python 2.4 (at all; so not
even python2.4, python2.4-dev) in its repositories, so you need to wind
back the clock and get the Karmic packages.&amp;nbsp; Don't worry, everything
seems to work okay.&amp;nbsp; &lt;a class="reference external" href="http://davidjb.com/blog/2010/05/installing-python-2-4-on-ubuntu-10-04-lucid-lynx"&gt;Read my post about this&lt;/a&gt; and come back here.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="prerequisites"&gt;
&lt;h2&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;Ready to roll? You might want to make sure that you've got python2.4
available (eg run &lt;tt class="docutils literal"&gt;python2.4&lt;/tt&gt;) and that you can &lt;tt class="docutils literal"&gt;import&amp;nbsp; profile&lt;/tt&gt;.
If not, go back to the other post and read carefully (or complain loudly
:)). You should also check the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;Got easy_install-2.4?&amp;nbsp; Try and type it in your terminal.&amp;nbsp; No good?
Then do this:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
wget http://pypi.python.org/packages/2.4/s/setuptools/setuptools-0.6c11-py2.4.egg
sudo sh setuptools-0.6c11-py2.4.egg
rm -f setuptools-0.6c11-py2.4.egg
sudo easy_install-2.4 -U setuptools
sudo easy_install-2.4 virtualenv
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;If you've got the python-virtualenv Ubuntu package installed.&amp;nbsp; If you
do, have a serious think about uninstalling it and getting the one
for Python2.4 via easy_install-2.4. Your warranty ends here if you
continue with the Ubunutu-installed virtualenv.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;If you need to install system-level packages. Even if you've run this
before on an old Karmic (or older install), do it again as you've
likely lost packages in the upgrade.&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get install libtk-img-dev libfreeimage-dev libjpeg62-dev libfreetype6-dev libtk-img-dev tcl8.5-dev tk8.5-dev lynx poppler-utils xpdf wv xlhtml ppthtml
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="make-your-virtualenv-happen"&gt;
&lt;h2&gt;Make your virtualenv happen&lt;/h2&gt;
&lt;p&gt;Now that's sorted, convert an existing buildout folder over to
Virtualenv:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
virtualenv -p /usr/bin/python2.4 .
&lt;span class="nb"&gt;source&lt;/span&gt; ./bin/activate
python bootstrap.py -v1.4.3
easy_install ipython
easy_install --find-links http://www.pythonware.com/products/pil/ Imaging
easy_install --find-links http://download.zope.org/distribution PILwoTK
easy_install python-ldap
./bin/buildout
&lt;/pre&gt;
&lt;p&gt;And that handles setting up and activating virtualenv, &lt;strong&gt;making sure we
bootstrap with version 1.4.3 of buildout&lt;/strong&gt;, installing useful/necessary
python packages, and reworking everything via buildout. As highlighted
with the &lt;strong&gt;bold&lt;/strong&gt; text, you must make sure you add the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-v1.4.3&lt;/span&gt;&lt;/tt&gt;
option to running bootstrap.py.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;So, that wraps things up. You should now have a fully functional
virtualenv, just like you did back in the good old days (or, if you're
new to this game, a fresh new install). Now, if you're a Plonista, you
can fire up your instance and it should start just fine.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="10.04"></category><category term="how-to"></category><category term="install"></category><category term="installation"></category><category term="lucid"></category><category term="plone"></category><category term="python"></category><category term="virtualenv"></category></entry><entry><title>Things to do on Ubuntu 10.04 Lucid Lynx after install</title><link href="http://davidjb.com/blog/2010/05/things-to-do-on-ubuntu-10-04-lucid-lynx-after-install/" rel="alternate"></link><updated>2010-05-05T11:31:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-05-05:blog/2010/05/things-to-do-on-ubuntu-10-04-lucid-lynx-after-install/</id><summary type="html">&lt;p&gt;I'm skipping actually quantifying the number of things to do because
this post will undoubtedly get updated as time goes on.&amp;nbsp; I've just
updated both my computers (personal laptop and work desktop) to Ubuntu
10.04 from 9.10 and I'm very happy with how things have gone. That isn't
to say a few minor things haven't annoyed me, such as Project Hamster
removing its Day view for task management or Python 2.4 being dropped
entirely, but overall, it's gone well. Here's my thoughts on what you
should do as soon as you've made the jump (or installed).&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;strong&gt;Set up Plymouth (graphical boot) and Virtual Terminals for
High-resolution:&lt;/strong&gt; &lt;a class="reference external" href="http://idyllictux.wordpress.com/2010/04/26/lucidubuntu-10-04-high-resolution-plymouth-virtual-terminal-for-atinvidia-cards-with-proprietaryrestricted-driver/"&gt;Tux's Idyllic Life&lt;/a&gt; has a perfect guide that has
worked for both my machines with proprietary Nvidia drivers
installed.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Learn how to change the splash screen image (and install some new
ones):&lt;/strong&gt; see &lt;a class="reference external" href="http://www.ubuntugeek.com/how-do-you-change-the-boot-splash-screen-image-for-10-04-lucid-lynx.html"&gt;Ubuntu Geek's guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Follow the next 10 steps&lt;/strong&gt; over at &lt;a class="reference external" href="http://www.omgubuntu.co.uk/2010/04/10-things-to-do-after-installing-ubuntu.html"&gt;OMG Ubuntu's guide&lt;/a&gt; - you
might have already done some of these, but it's a very useful
combined post.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;More to come as time progresses...&lt;/p&gt;
</summary><category term="10.04"></category><category term="drivers"></category><category term="graphics"></category><category term="install"></category><category term="lucid"></category><category term="ubuntu"></category><category term="update"></category></entry><entry><title>Installing Python 2.4 on Ubuntu 10.04 Lucid Lynx</title><link href="http://davidjb.com/blog/2010/05/installing-python-2-4-on-ubuntu-10-04-lucid-lynx/" rel="alternate"></link><updated>2010-05-04T12:00:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-05-04:blog/2010/05/installing-python-2-4-on-ubuntu-10-04-lucid-lynx/</id><summary type="html">&lt;p&gt;Whoops.&amp;nbsp; No one sent me the memo that Python
2.4 support was being removed entirely from the latest version of
Ubuntu, 10.04 Lucid Lynx.&amp;nbsp; To be fair, I was presented with the message
that 'these outdated packages will be removed' and in that list was
python2.4.&amp;nbsp; I made the unfortunate assumption that this just mean the
package was outdated (which it certainly is) and I'd have the ability to
install it again in Lucid.&amp;nbsp; There were a number of different packages on
the list and in order to save time, I let the updater remove them all.
End result?&amp;nbsp; No more Python 2.4 on Lucid.Now, installing it back again
isn't too much of a hassle. You just need the old packages again from
the Jaunty repositories.&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
wget http://mirror.aarnet.edu.au/pub/ubuntu/archive/pool/main/p/python2.4/python2.4-minimal_2.4.6-1ubuntu3.2.9.10.1_i386.deb -O python2.4-minimal.deb
wget http://mirror.aarnet.edu.au/pub/ubuntu/archive/pool/main/p/python2.4/python2.4_2.4.6-1ubuntu3.2.9.10.1_i386.deb -O python2.4.deb
wget http://mirror.aarnet.edu.au/pub/ubuntu/archive/pool/main/p/python2.4/python2.4-dev_2.4.6-1ubuntu3.2.9.10.1_i386.deb -O python2.4-dev.deb
sudo dpkg -i python2.4-minimal.deb python2.4.deb python2.4-dev.deb
rm python2.4-minimal.deb python2.4.deb python2.4-dev.deb
&lt;/pre&gt;
&lt;p&gt;You can use your own mirror for the Ubuntu repository as required. I've
selected the AARNet mirror since it's about one of the quickest
(typically) for me here in Australia on an AARNet-connected educational
institution. Also, I'm using the i386 packages -- presumably this should
be fine with the amd64 counterparts as well.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note on Python 2.4 packages:&lt;/strong&gt; watch out for old Python 2.4
system-level packages you had installed (like python-virtualenv and
similar) previously on Jaunty or earlier.&amp;nbsp; These will now likely be
their Python 2.6 counterparts and installed differently than the old
ones.&amp;nbsp; So, if you try and &lt;tt class="docutils literal"&gt;easy_install&lt;/tt&gt; something like virtualenv
again, expect that you'll have two apps with the same identical name (vs
virtualenv-2.4 previously) in your system path.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note on Virtualenv:&lt;/strong&gt; Exercise caution -- especially with the example
of virtualenv. Its latest incarnation has some deeper emotional issues
when mixing and matching the python-virtualenv package from the official
Lucid repos and Python2.4. I get the feeling &lt;a class="reference external" href="https://bugs.launchpad.net/ubuntu/+source/python-virtualenv/+bug/339904"&gt;this bug&lt;/a&gt; is related.&lt;/p&gt;
&lt;div class="section" id="python-2-4-profiler-reinstallation"&gt;
&lt;h2&gt;Python 2.4 Profiler Reinstallation&lt;/h2&gt;
&lt;p&gt;If you find that some of your code (hello, Plone unit testing and
functional testing, I'm talking about you) won't run because you can't
&amp;quot;import profile&amp;quot; (&lt;tt class="docutils literal"&gt;ImportError: No module named profile&lt;/tt&gt;), then you'll
need to get a hold of the python2.4-profiler package and install that.
Now, life is made more fun by the fact that python-profiler (Ubuntu's
new Python 2.6 version) explicitly conflicts with this package. Soooo...
do this to install it:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get remove python-profiler
wget http://mirror.aarnet.edu.au/pub/ubuntu/archive/pool/multiverse/p/python-profiler/python2.4-profiler_2.4.3-1ubuntu3_all.deb -O python2.4-profiler.deb
sudo dpkg-deb -x python2.4-profiler.deb /
rm python2.4-profiler.deb
sudo apt-get install python-profiler
&lt;/pre&gt;
&lt;p&gt;and hey presto, you've got your profile module installed for ye olde
Python 2.4.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="help guide"></category><category term="installation"></category><category term="linux"></category><category term="lucid"></category><category term="packages"></category><category term="python"></category><category term="ubuntu"></category></entry><entry><title>Good Morning World Plone Day!</title><link href="http://davidjb.com/blog/2010/04/good-morning-world-plone-day/" rel="alternate"></link><updated>2010-04-28T00:00:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-04-28:blog/2010/04/good-morning-world-plone-day/</id><summary type="html">&lt;p&gt;Good morning from the land down under and welcome to World Plone Day
2010! It's right on the hour (well, just after now) and 28 April 2010 --
and yes, that's World Plone Day to the uninitiated. To celebrate and to
mark the occasion, I'll be holding a bit of a discussion today about
what Plone is, why it's so useful, and what we, as users, are hanging
out for in Plone 4 and above. But, what fun is that without sweets to
eat?&amp;nbsp; And what's potentially tastier than Plone?&amp;nbsp; Plone cupcakes!&lt;/p&gt;
&lt;p&gt;Thanks to some great work by my lovely partner, she's whipped up some
cupcakes for WPD.&amp;nbsp; I didn't do much save for helping with design and
icing -- woo!&amp;nbsp; Here's the end results:&lt;/p&gt;
&lt;img alt="|filename|images/cupcakes1.jpg" src="http://davidjb.com/static/images/cupcakes1.jpg" style="width: 45%;" /&gt;
&lt;img alt="|filename|images/cupcakes2.jpg" src="http://davidjb.com/static/images/cupcakes2.jpg" style="width: 45%;" /&gt;
&lt;p&gt;Okay, so the CMYK colour might be a little off and I'm thinking I'm not
conforming to all Plone logo usage guidelines but they look good.
Haven't tasted them yet but I'm sure they'll be excellent.&amp;nbsp; I had
thought of a line like &amp;quot;Open Source never tasted so sweet&amp;quot;, but I think
I'll let that go.&lt;/p&gt;
&lt;p&gt;Viva la World Plone Day!&lt;/p&gt;
</summary><category term="date"></category><category term="food"></category><category term="life"></category><category term="plone"></category><category term="sweets"></category><category term="tasty"></category><category term="wpd"></category></entry><entry><title>Plone and Dexterity: Working with computed fields</title><link href="http://davidjb.com/blog/2010/04/plone-and-dexterity-working-with-computed-fields/" rel="alternate"></link><updated>2010-04-19T14:03:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-04-19:blog/2010/04/plone-and-dexterity-working-with-computed-fields/</id><summary type="html">&lt;p&gt;Today, we're looking at how to utilise computed fields within a
Dexterity-based content type. The specific use-case is that of having
two separate fields (first name and surname, for a Person type, for
example) generate the complete object title. The first part of this --
having the title of the content displayed correctly -- is pretty
straight forward once you know what documentation to read and understand
how things happen. The second part -- having the ID of the content
correctly generated to be first name/surname is slightly more
complicated.&lt;/p&gt;
&lt;div class="section" id="title-computation-and-display"&gt;
&lt;h2&gt;Title computation and display&lt;/h2&gt;
&lt;p&gt;Let's look at the first part.&amp;nbsp; What we need is a custom content class,
and this is documented in the &lt;a class="reference external" href="http://plone.org/products/dexterity/documentation/manual/developer-manual/advanced/classes"&gt;Dexterity Developer Manual&lt;/a&gt;.&amp;nbsp; As per the
documentation, you need to create a class and derive it off from either
Item or Container, depending on what your content originally is.&amp;nbsp; Then,
specify your new class as the 'klass' in your relevant type XML file in
your GenericSetup profile.&lt;/p&gt;
&lt;p&gt;Now, with an empty class definition, like in the manual page, you can
start to add your computed fields. Your class might look something like
this (don't worry, I'll explain):&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Item&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Customised Person content class&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nd"&gt;&amp;#64;property&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;hasattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;'first_names'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="nb"&gt;hasattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;'surname'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first_names&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;' '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;surname&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;''&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;setTitle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;So, we have our relevant function defined and decorated to be a
property. I've found that in at least this specific use-case (setting
the title from other fields), that this method is getting called before
the object's fields are instantiated. Hence the presence of the hasattr
checks.&lt;/p&gt;
&lt;p&gt;Now, having a setTitle function seems a bit odd yes? Especially so since
it doesn't do anything meaningful at all. Odds are that you probably
won't need this type of function &lt;em&gt;unless&lt;/em&gt; you're like me and needing to
set the &lt;strong&gt;title&lt;/strong&gt; specifically. The reason you need it for the title
attribute is because you've got &amp;quot;def title(self)&amp;quot; as a function and your
default DublinCore functionality (called by Dexterity &amp;#64;
plone.dexterity.content, line 221, in __init__) attempts to
initialise the title, amongst other DC metadata. Interesting!&lt;/p&gt;
&lt;p&gt;So, without a setTitle function, attempting to create a new instance of
your content fails with a &amp;quot;AttributeError: can't set attribute&amp;quot; error
because DC (Module Products.CMFDefault.DublinCore, line 369, in
setTitle) wants to set the title. Sorry, it can't do this (we don't want
it to, and it physically can't), so we override what would be the
default setTitle function to do nothing at all.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="correct-id-at-creation-time-from-computed-title"&gt;
&lt;h2&gt;Correct ID at creation time from computed title&lt;/h2&gt;
&lt;p&gt;Now, this one's a little trickier. Unfortunately, there's no
documentation that I could find on the web about doing this, save a
&lt;a class="reference external" href="http://n2.nabble.com/Dexterity-computed-fields-td3498400.html"&gt;very short thread&lt;/a&gt; on Nabble. In that thread, Martin Aspeli provides
some good pointers to this very use-case, but the example of
INameFromTitle provides the title as a field, rather than a function
(and isn't specifically registered as an adapter).&lt;/p&gt;
&lt;p&gt;After a bit of poking and prodding, here's my solution:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;plone.app.content.interfaces&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;INameFromTitle&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;INameFromPersonNames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;INameFromTitle&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;title&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Return a processed title&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;NameFromPersonNames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;implements&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;INameFromPersonNames&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;

    &lt;span class="nd"&gt;&amp;#64;property&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first_names&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;' '&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;surname&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;So, we extend off from the default functionality, making sure that our
title function is going to override the title field that's in
INameFromTitle by default. Then, we create our adapter and return the
processed title (function decorated as a property). No need for hasattr
checks here; the object is already initialised.&lt;/p&gt;
&lt;p&gt;Then, register this in some ZCML, where the 'for' is the Dexterity
interface class and the latter two attributes are the classes we just
specified:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;adapter&lt;/span&gt; &lt;span class="na"&gt;for=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sample.project.person.ISamplePerson&amp;quot;&lt;/span&gt;
    &lt;span class="na"&gt;provides=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sample.project.person.INameFromPersonNames&amp;quot;&lt;/span&gt;
    &lt;span class="na"&gt;factory=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sample.project.person.NameFromPersonNames&amp;quot;&lt;/span&gt;
    &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Then, the magic of inheritance takes over and the relevant code that
would normally generate the ID off from the title field comes from the
processed title. Tada!&lt;/p&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;Put all these things together with Dexterity and that's it. I'm still in
the process of doing this, but you should be able to apply the same
processes to other fields. Just watch out for DublinCore initialisation.
If you see that sort of error message about a setXXX function and
attribute, then you'll know what to do.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note to self:&lt;/strong&gt; the reason I didn't use a behaviour here is because
things like INameFromTitle give us a field (see source file). We don't
want this, but rather just programmatic generation of the title.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</summary><category term="computation"></category><category term="content"></category><category term="dexterity"></category><category term="extension"></category><category term="function"></category><category term="plone"></category><category term="product"></category><category term="python"></category></entry><entry><title>Plone/Zope: Utilising zope.testrecorder for unit testing</title><link href="http://davidjb.com/blog/2010/03/plonezope-utilising-zope-testrecorder-for-unit-testing/" rel="alternate"></link><updated>2010-03-25T09:40:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-03-25:blog/2010/03/plonezope-utilising-zope-testrecorder-for-unit-testing/</id><summary type="html">&lt;p&gt;Writing unit tests (especial doctests) for your Plone product is
reasonably time consuming. For us developers, having tested code is
absolutely essential. This is especially true when clients are beating
down your door looking for a fully functional product and you need to
know what you've written works and isn't going to fall over (just yet,
anyway). Web apps are able to be tested using a multitude of frameworks,
and whilst not the most fully featured (eg lacking Javascript support),
Zope's doctest machinery is right there within your Plone product. In
order to write these, enter zope.testrecorder to more-or-less automate
replicating your actions into tests.&lt;/p&gt;
&lt;p&gt;zope.testrecorder is simple to install: just add it to your eggs list
under your buildout's relevant instance section, and also the
corresponding zcml list too. Re-run your buildout and you will now have
the latest version of the package installed.&lt;/p&gt;
&lt;p&gt;There's some good documentation out there about this, such as &lt;a class="reference external" href="http://plone.org/documentation/kb/testing/zope-testrecorder"&gt;Martin
Aspeli's article&lt;/a&gt; on plone.org, but it's slightly dated given latest
updates with the package. Essentially, everything is relevant with the
exception of how to actually access the test recorder now. Enter
&lt;a class="reference external" href="http://pyyou.wordpress.com/2008/04/11/how-to-install-zopetestrecorder-with-buildout/"&gt;PyYou's post&lt;/a&gt; about this same topic. Thanks to that article I now know
you should go to
&lt;strong&gt;http://zopehost:port/++resource++recorder/index.html&lt;/strong&gt; to access the
test recorder, and not try and add an object in the root of Zope (or
elsewhere).&lt;/p&gt;
&lt;p&gt;Aside from that, the recorder works like a charm. You input the address
of what site (it can be anything or anywhere) you want to test and click
the 'Go' button. Everything you do (mostly) gets monitored and recorded.
A few words to the wise though:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;No testing or recording Javascript-based or centric actions.&amp;nbsp; So
don't expect that product you wrote with the Google Maps API to work
so well with recording tests.&amp;nbsp; Or, don't expect the test recorder to
understand correctly that you clicking on the 'Add New...' menu in
Plone isn't actually a real link.&lt;/li&gt;
&lt;li&gt;No ability to just browse with Javascript turned off.&amp;nbsp; Essentially,
as the zope.testrecorder itself needs Javascript to run, you can't
turn it off, thinking you'll record things correctly, or at all.
Maybe there's a way around this issue, but it's likely more
complicated than I care to concern myself with.&lt;/li&gt;
&lt;li&gt;Specialised form widgets are problematic.&amp;nbsp; The Plone visual editor is
one (Javascript, again), but does work if you switch the editor to be
HTML before saving a form.&amp;nbsp; Another example that will require some
fancy work around is z3c.relationfield -- there's no non-Javascript
fall back here (that I can see).&lt;/li&gt;
&lt;li&gt;You'll need to manually intervene with the rendered tests and fix
some things up.&amp;nbsp; For example, testing the default title of a Plone
site doesn't work because there's a hyphen in the title.&amp;nbsp; It's a
special character and thus saved &amp;quot;incorrectly&amp;quot; within the doctests.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Aside from all that, most of the heavy lifting is done for you, so
cheers to the creators of zope.testrecorder for making my life just that
bit easier.&lt;/p&gt;
</summary><category term="buildout"></category><category term="install"></category><category term="plone"></category><category term="product"></category><category term="recorder"></category><category term="test"></category><category term="unit tests"></category><category term="zope"></category></entry><entry><title>GenericSetup and "mismatched" tags in ZCML</title><link href="http://davidjb.com/blog/2010/03/genericsetup-and-mismatched-tags-in-zcml/" rel="alternate"></link><updated>2010-03-12T11:01:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-03-12:blog/2010/03/genericsetup-and-mismatched-tags-in-zcml/</id><summary type="html">&lt;p&gt;Ever the issue-magnet, I've spent the better part of my morning trying
to debug a mistmatched tag error from within some ZCML (aka XML for the
non-initiated).&amp;nbsp; Essentially, the issue boiled down to the system
telling me that it was certain that I had a mistmatched tag within my
configuration, and presented me with the problematic XML tag (complete
with line numbers).&amp;nbsp; However, life's not always that simple.&lt;/p&gt;
&lt;p&gt;The traceback looked like this:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="gt"&gt;Traceback (most recent call last):
&lt;/span&gt;&lt;span class="gr"&gt;zope.configuration.config.ConfigurationExecutionError&lt;/span&gt;: &lt;span class="n"&gt;xml.parsers.expat.ExpatError: mismatched tag: line 6, column 70&lt;/span&gt;
&lt;span class="x"&gt;in:
File &amp;quot;/home/david/buildout/src/aaa.project/aaa/project/profiles.zcml&amp;quot;, line 9.2-15.6&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;And specified the exact genericsetup:registerProfile configuration that
was problematic. After much poking and prodding and thinking that there
must be some random character hidden in my configuration file (and
checking other files that call this one), no dice. Even copying and
pasting some new code that I knew worked just simply didn't when I put
it here.&lt;/p&gt;
&lt;p&gt;So, I just happened to actually think about what I'm calling with this
ZCML: a Plone product generic setup profile. And, yes, now it seems so
clear that the issue was in fact in that GS profile. My vim editor had
kindly re-auto-closed a tag that it shouldn't have (because it was
already closed) in my metadata.xml. Fixing that solved the issue and let
my Zope instance start up again.&lt;/p&gt;
</summary><category term="configuration"></category><category term="error"></category><category term="mismatched"></category><category term="plone"></category><category term="tags"></category><category term="xml"></category><category term="zcml"></category><category term="zope"></category></entry><entry><title>Wget a Plone site (and make it actually work)</title><link href="http://davidjb.com/blog/2010/02/wget-a-plone-site-and-make-it-actually-work/" rel="alternate"></link><updated>2010-02-25T15:01:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-02-25:blog/2010/02/wget-a-plone-site-and-make-it-actually-work/</id><summary type="html">&lt;p&gt;There's a lot of different resources and posts on the
web about how to export a Plone site to static html content, but no
methodology would actually solve all of my problems. Now, Plone is
inherently a complicated beast, given just how much it does, and that's
definitely putting it lightly. But here goes at my attempt to provide an
actual, workable solution.&amp;nbsp; Word for the wise though, this is for more
than just your front-end administrator to handle.&amp;nbsp; Also, instructions
are designed for Ubuntu 9.10.&amp;nbsp; Mileage may/will vary on other distros or
OSes.&lt;/p&gt;
&lt;div class="section" id="requirements"&gt;
&lt;h2&gt;Requirements&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Needs to get all pages, including default views of folders, correctly&lt;/li&gt;
&lt;li&gt;Needs to rewrite all links to be relative, because I want to run the
site locally on CD/DVD (or move it anywhere)&lt;/li&gt;
&lt;li&gt;Should get all the CSS from the site, and images from the CSS&lt;/li&gt;
&lt;li&gt;Doesn't have to be in 1 command (relaxed to make life easy ;-) )&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="how-to"&gt;
&lt;h2&gt;How to&lt;/h2&gt;
&lt;p&gt;Issues I've had with other methods (specifically, wget options) either
don't get the right pages, manage to ignore default folder views, or
other random problems.&amp;nbsp; Here's my take on the situation -- it's not a
one-click solution, but it worked for me:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Go into your site and change all portal_css entries' Render Type to
'Link'.&amp;nbsp; This solves issues with wget and &amp;#64;import for CSS.&lt;/li&gt;
&lt;li&gt;Make invisible any actions in portal_actions that you don't want
saved.&amp;nbsp; For example, &amp;quot;Register&amp;quot; and &amp;quot;Contact&amp;quot; might want to be hidden
as they won't be useful on a static site.&lt;/li&gt;
&lt;li&gt;When ready, run the following script on your site (thanks to
&lt;a class="reference external" href="http://kiilerix.blogspot.com/2008/10/mirroring-plone-site.html"&gt;kiilerex&lt;/a&gt; for the wget command):
&lt;a class="reference external" href="https://github.com/jcu-eresearch/static-plone-wget"&gt;https://github.com/jcu-eresearch/static-plone-wget&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Looking inside the bash script, you'll see uses wget to download the
site, then gets a list of images referenced within the CSS files, and
downloads them accordingly to the location where the CSS file(s)
are.&amp;nbsp; Then, it corrects your CSS files to have relative URLs, rather
than absolute as does Plone by default.&lt;/li&gt;
&lt;li&gt;Your site should now be ready for distribution to any web location or
distribution media!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Please let me know if there's any problems with the script. It's on GitHub
at &lt;a class="reference external" href="https://github.com/jcu-eresearch/static-plone-wget"&gt;https://github.com/jcu-eresearch/static-plone-wget&lt;/a&gt; so go crazy and
fork as you'd like.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="cd"></category><category term="content"></category><category term="download"></category><category term="dvd"></category><category term="export"></category><category term="media"></category><category term="offline"></category><category term="plone"></category><category term="site"></category><category term="static"></category><category term="wget"></category></entry><entry><title>CSS: Internet Explorer and Self-Imposed Limitations (+ Plone)</title><link href="http://davidjb.com/blog/2010/01/css-internet-explorer-and-self-imposed-limitations-plone/" rel="alternate"></link><updated>2010-01-28T11:52:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-01-28:blog/2010/01/css-internet-explorer-and-self-imposed-limitations-plone/</id><summary type="html">&lt;p&gt;Microsoft and IE are insane.&amp;nbsp; Yes, we all knew this, but
here's the proof:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
IE won't accept more than 30 style sheets to be loaded via &amp;lt;style&amp;gt; tags within a single page.
&lt;/pre&gt;
&lt;p&gt;Insanity?&amp;nbsp; Yes.&amp;nbsp; It's made even worse by the fact they openly admit this
lunacy!&amp;nbsp; See the relevant &lt;a class="reference external" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;262161"&gt;support article&lt;/a&gt; from MS as proof.&lt;/p&gt;
&lt;p&gt;Good gosh.&amp;nbsp; I can just imagine the staff (managers, probably) from
Microsoft thinking &amp;quot;30 style sheets?&amp;nbsp; Who needs more than 30 style
sheets?&amp;nbsp; Just kill off anything after that and those sites that use that
many can &lt;em&gt;BURN&lt;/em&gt;.&amp;quot;&lt;/p&gt;
&lt;p&gt;I mean, really, who does need 30 style sheets?&amp;nbsp; Never mind that a lot of
CMSes (like Plone, or Drupal) have CSS debug modes that can be turned on
in order -- you guessed it -- debug the styles.&amp;nbsp; Add this to the fact
that IE gives two middle fingers to standards compliance and not only
can you not have it understand your CSS correctly, but you can't even
&lt;strong&gt;debug&lt;/strong&gt; it normally when IE screws up!&amp;nbsp; So, this solves the issue of
my ploneCustom.css file wouldn't load -- it's the last CSS import being
brought in from portal_css in Plone.&lt;/p&gt;
&lt;p&gt;This issue is admitted by them and has been around since&lt;strong&gt;Internet
Explorer 4&lt;/strong&gt;.&amp;nbsp; Yes, that's right, back from when the dinosaurs roamed
the earth and array indices only went to 30.&amp;nbsp; Get real IE developers and
Microsoft.&lt;/p&gt;
&lt;p&gt;And to anyone who's reading this on IE:&amp;nbsp; get a &lt;a class="reference external" href="http://getfirefox.com"&gt;real&lt;/a&gt; browser.&lt;/p&gt;
</summary><category term="bug"></category><category term="css"></category><category term="IE"></category><category term="issue"></category><category term="limitation"></category><category term="plone"></category><category term="problem"></category><category term="styles"></category><category term="stylesheets"></category></entry><entry><title>Apache: Directories and trailing slashes</title><link href="http://davidjb.com/blog/2010/01/apache-directories-and-trailing-slashes/" rel="alternate"></link><updated>2010-01-18T11:51:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-01-18:blog/2010/01/apache-directories-and-trailing-slashes/</id><summary type="html">&lt;p&gt;Apache does something interesting (yes, I still
think it's logical) when you're accessing a directory that it's serving:
if you access it without a trailing slash, it'll add one by default.
This makes sense if you're going after some static content or a folder
index (or pretty much any sane usage) but it didn't fit my use case of
serving Plone using rewrite rules in a .htaccess file.&lt;/p&gt;
&lt;p&gt;The issue that arises for myself with Plone is that my sites need to
have their access customised through that .htaccess file and that's been
placed within a &lt;tt class="docutils literal"&gt;public_html&lt;/tt&gt; directory thus:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
/home/user/public_html/
&lt;/pre&gt;
&lt;p&gt;Because this is a directory, Apache adds that trailing slash by default
when accessing an aliased URL like:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
http://mysite.org/user
&lt;/pre&gt;
&lt;p&gt;because it's actually pointing to &lt;tt class="docutils literal"&gt;/home/user/public_html/&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I wasn't aware, but you can disable this functionality with just one
line:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
DirectorySlash Off
&lt;/pre&gt;
&lt;p&gt;Pages like &lt;a class="reference external" href="http://httpd.apache.org/docs/1.3/mod/mod_dir.html"&gt;this&lt;/a&gt; don't help since it's outdated doco for Apache httpd;
they are annoying since it's what came up first in Google. It ended up
being the &lt;a class="reference external" href="http://httpd.apache.org/docs/2.2/mod/mod_dir.html"&gt;latest version&lt;/a&gt; of that same doco page that solved it for me
by chance.&lt;/p&gt;
&lt;p&gt;As a side note, you apparently need Apache 2.0.51 or later to make this
happen for you.&lt;/p&gt;
</summary><category term="apache"></category><category term="directories"></category><category term="folder"></category><category term="http"></category><category term="httpd"></category><category term="problem"></category><category term="web"></category><category term="web server"></category></entry><entry><title>Ubuntu: Crackling audio noises on a Dell M1530 (or HDA cards)</title><link href="http://davidjb.com/blog/2010/01/ubuntu-crackling-audio-noises-on-a-dell-m1530-or-hda-cards/" rel="alternate"></link><updated>2010-01-16T12:18:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-01-16:blog/2010/01/ubuntu-crackling-audio-noises-on-a-dell-m1530-or-hda-cards/</id><summary type="html">&lt;p&gt;The problem I found (so did everyone else) when updating to Ubuntu 9.10
Karmic was static/popping noises when your sound card is silent (aka
goes into power-save mode). It applies to my Dell XPS M1530 laptop's
on-board sound and probably to the same chipset elsewhere.&lt;/p&gt;
&lt;p&gt;The fix couldn't be simpler! Simply edit this file (as root):&lt;/p&gt;
&lt;pre class="literal-block"&gt;
/etc/modprobe.d/alsa-base.conf
&lt;/pre&gt;
&lt;p&gt;and comment out the last line. Then, restart ALSA to save you having to
do a reboot to check it worked:&lt;/p&gt;
&lt;blockquote&gt;
sudo /etc/init.d/alsa-utils stop
sudo alsa force-reload
sudo /etc/init.d/alsa-utils start&lt;/blockquote&gt;
&lt;p&gt;Thanks to Ubuntu Geek &lt;a class="reference external" href="http://www.ubuntugeek.com/ubuntu-tip-how-to-fix-crackling-noise-on-hda-audio-cards-in-ubuntu-9-10.html"&gt;here&lt;/a&gt;.&lt;/p&gt;
</summary><category term="9.10"></category><category term="audio"></category><category term="computer"></category><category term="crackling"></category><category term="dell"></category><category term="intel"></category><category term="karmic"></category><category term="laptop"></category><category term="m1530"></category><category term="popping"></category><category term="sound"></category><category term="ubuntu"></category></entry><entry><title>(Lack of) Kupu CSS Styles, Plone and Deliverance</title><link href="http://davidjb.com/blog/2010/01/lack-of-kupu-css-styles-plone-and-deliverance/" rel="alternate"></link><updated>2010-01-14T14:13:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2010-01-14:blog/2010/01/lack-of-kupu-css-styles-plone-and-deliverance/</id><summary type="html">&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; see &lt;a class="reference external" href="http://www.coactivate.org/projects/deliverance/lists/deliverance-discussion/archive/2010/01/1263439188459/forum_view"&gt;this post&lt;/a&gt; for up-to-date details.&lt;/p&gt;
&lt;p&gt;Essentially, the issue is that Deliverance doesn't theme (and rightly
so) the Kupu editor within Plone and hence any styles applied to normal
pages by Deliverance don't show up.&amp;nbsp; My workaround, as detailed on that
post, is to customise the &amp;quot;emptypageresources&amp;quot; page template and include
a suitable link to the CSS file, like so:&lt;/p&gt;
&lt;pre class="code html literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;link&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;site.css&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;rel=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;StyleSheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;tal:attributes=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;href string:${context/&amp;#64;&amp;#64;plone_portal_state/navigation_root_url}/static/theme/site.css;&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;(changing the tal:attributes section accordingly).&amp;nbsp; This should
introduce perfectly correct styles for your editor from your Deliverance
(or other) static theme.&lt;/p&gt;
&lt;p&gt;This feels to be a very common use case, but I can't seem to find any
other suggestions on a workaround/solution. I'd have to think that this
is likely to be a widespread issue, though. It's definitely not
something that should happen if we're actually able to have the WYSIWYG
editor be WYSIWYG (unlike some other CMS products).&lt;/p&gt;
</summary><category term="css"></category><category term="deliverance"></category><category term="editor"></category><category term="kupu"></category><category term="plone"></category><category term="static"></category><category term="style"></category><category term="theme"></category></entry><entry><title>Logged out users can't bring up the Plone popup calendar</title><link href="http://davidjb.com/blog/2009/12/logged-out-users-cant-bring-up-the-plone-popup-calendar/" rel="alternate"></link><updated>2009-12-18T12:10:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-12-18:blog/2009/12/logged-out-users-cant-bring-up-the-plone-popup-calendar/</id><summary type="html">&lt;p&gt;It's another one of those 'strange' problems that has cropped up, but by
default in Plone, users who aren't authenticated aren't actually able to
bring up a pop-up calendar on a date field.&lt;/p&gt;
&lt;p&gt;It's amazing that I haven't run into this issue before with something
like PloneFormGen, where you'd think that a simple Date input field
would be pretty common.&amp;nbsp; Although, I guess it's the case that even
though I've used these given forms, I've probably never taken much
notice of the popup calendar icon and just selected a random date from
the drop-down lists.&amp;nbsp; I suppose entering a random number on they
keyboard and hitting tab across the fields 3 times is simpler than going
for the mouse.&amp;nbsp; Who knows.&lt;/p&gt;
&lt;p&gt;Anyway, the issue presents itself with an error in the Javascript on the
page, with something like 'plone.jscalendar not defined', if my memory
serves me correctly.&amp;nbsp; I believe that Firebug/Firefox didn't show up an
error for me (because I was logged in!) so make sure you test this on
your site when you're logged out, if you've got such fields.&amp;nbsp; Testing in
IE revealed the problem since my IE versions in my VM can't actually
enter details into form fields, thus preventing me &lt;em&gt;from&lt;/em&gt; actually
logging in.&lt;/p&gt;
&lt;div class="section" id="solution"&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;The solution was the only Google result at the time, and that was at:
&lt;a class="reference external" href="http://plone.org/products/ploneformgen/issues/232"&gt;http://plone.org/products/ploneformgen/issues/232&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Essentially, head into the portal_css and portal_javascripts areas in
the ZMI and look search on the page for &amp;quot;calendar&amp;quot;.&amp;nbsp; You should find
that the 'condition' on these resources isn't right (eg only logged in
users or &amp;quot;not: portal/portal_membership/isAnonymousUser&amp;quot; is set or
isn't correct at all).&amp;nbsp; Correct it accordingly to be blank (easiest
way!) and save.&amp;nbsp; You may need to enable/reload/disable the debugging
modes for the CSS and JS to see the change immediately.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="authenticated"></category><category term="calendar"></category><category term="css"></category><category term="javascript"></category><category term="members"></category><category term="plone"></category><category term="popup"></category><category term="problem"></category><category term="testing"></category><category term="users"></category></entry><entry><title>David tries Plone 4.0a2 (Part 2)</title><link href="http://davidjb.com/blog/2009/12/david-tries-plone-4-0a2-part-2/" rel="alternate"></link><updated>2009-12-08T16:21:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-12-08:blog/2009/12/david-tries-plone-4-0a2-part-2/</id><summary type="html">&lt;p&gt;Rightio!&amp;nbsp; So we've got Plone 4.0a2 installed and up and running.&amp;nbsp; Boy,
she looks sweet:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The new Plone site setup is flawlessly simple.&amp;nbsp; No more ZMI for those
of us that don't want to use it.&amp;nbsp; It'll always still be useful, but
having Plone throw up a simple, no no-nonsense front-end installer is
just what it needed.&amp;nbsp; Other PHP based CMSes always had it too easy
;-)&lt;/li&gt;
&lt;li&gt;Editing view:&amp;nbsp; clearer tabs at the top (no idea how many clients miss
those, me included to start!) and resizable editing fields.&amp;nbsp; Great.
TinyMCE as the editor -- just what the doctor ordered as Kupu just
wasn't quite up to task.&amp;nbsp; (Note that I'm using Wordpress with
TinyMCE, so I could be a little biased).&amp;nbsp; Still needs work with the
Image insert page, but anyway, in good time.&lt;ul&gt;
&lt;li&gt;Also, it seems like the &amp;quot;auto-link text from Plone content title&amp;quot;
feature is gone.&amp;nbsp; I've opened a ticket, hopefully it'll get fixed:
&lt;a class="reference external" href="https://dev.plone.org/plone/ticket/9908"&gt;https://dev.plone.org/plone/ticket/9908&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Good to see the Resource Types for TinyMCE are simpler than Kupu.
Wow it was it a mission to add a new type of Folder-ish content
and not de-select the rest of everything in the process in its
multi-select box widget.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Pop-up overlays inside Plone: very cool.&amp;nbsp; Saves an entire page reload
(I would hope so...) so a thumbs up from me!&lt;/li&gt;
&lt;li&gt;Better search options and collapsed options on the form.&amp;nbsp; I saw the
latter as an add-on from ages ago and thought it'd be a good thing to
have.&amp;nbsp; Nice to see it (or similar) included by default.&amp;nbsp; Those search
options were daunting.&lt;/li&gt;
&lt;li&gt;Email addresses as logins!&amp;nbsp; Another feature that users keep asking
about that's included.&lt;/li&gt;
&lt;li&gt;User rego fields -- something very promising as I've been
looking/hoping to move to a less-fixed way of managing user profile
attributes in Plone.&amp;nbsp; Goodo.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;That's about a wrap from me.&amp;nbsp; Looking good so far; a lot of smaller
issues are getting sorted.&amp;nbsp; Cheers to all those developers for all the
hard work so far.&amp;nbsp; If I knew more, I'd be helping out more than I am
now.&lt;/p&gt;
</summary><category term="alpha"></category><category term="demo"></category><category term="new"></category><category term="plone"></category><category term="sunburst"></category><category term="test"></category><category term="theme"></category><category term="ubuntu"></category></entry><entry><title>David tries Plone 4.0a2 (Part 1)</title><link href="http://davidjb.com/blog/2009/12/david-tries-plone-4-alpha-2-part-1/" rel="alternate"></link><updated>2009-12-08T15:48:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-12-08:blog/2009/12/david-tries-plone-4-alpha-2-part-1/</id><summary type="html">&lt;p&gt;Plone 4 is approaching!&amp;nbsp; Excellent!&amp;nbsp; Lots of new features to play around
with and plenty more things to have to fix with the upgrade.&amp;nbsp; I've been
keeping tabs on the change log of updates and it's looking really good.
Lots of little, but significant, changes are afoot.&amp;nbsp; Now, how about
actually installing the Alpha 2 version of Plone 4 to see it for real?
Let's do it!&lt;/p&gt;
&lt;p&gt;My steps are not going to work on your computer.&amp;nbsp; I don't think you'll
be able to follow my words/commands exactly, but here goes anyway about
my experience so far.&amp;nbsp; The buildout might/might not work on Windows/Mac;
I'm on Linux and that's that FYI.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;I grabbed the buildout from
&lt;a class="reference external" href="https://svn.plone.org/svn/plone/buildouts/plone-coredev/branches/"&gt;https://svn.plone.org/svn/plone/buildouts/plone-coredev/branches/&lt;/a&gt;
and beat it over the head with a stick.&amp;nbsp; I downloaded the Plone 4.0a2
versions.cfg from &lt;a class="reference external" href="http://dist.plone.org/release/4.0a2/versions.cfg"&gt;http://dist.plone.org/release/4.0a2/versions.cfg&lt;/a&gt;
over the top of the one provided and made the buildout.cfg provided
only extend off versions.cfg.&amp;nbsp; You'll also need to strip back the
'parts' section of the buildout (eg no 'test' sections since I don't
really need to know things aren't 100% right yet ;-) )&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Set up your virtualenv in your given folder, making sure you use
&lt;strong&gt;Python 2.6&lt;/strong&gt;.&amp;nbsp; It's not marked in huge text and bold for you as
much as it is for me.&amp;nbsp; If you see this:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;While:
Installing.
Getting section instance1.
Initializing section instance1.
Loading zc.buildout recipe entry plone.recipe.zope2instance &amp;gt;=2.0:default.
An internal error occured due to a bug in either zc.buildout or in a
recipe being used:
)[1 if IS_WIN else 0]
^
SyntaxError: invalid syntax&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;then you need to stop using Python 2.4 and start using 2.6, okay?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Make sure you've got the Python 2.6 development libraries installed
on your machine.&amp;nbsp; Expect pain from Zope 2.12.1 (etc) if you don't.
If you see this:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;include/ExtensionClass/ExtensionClass.h:83:20: error: Python.h: No such file or directory
....[lots of nasty errors]...
error: Setup script exited with error: command 'gcc' failed with exit status 1
An error occured when trying to install Zope2 2.12.1.Look above this message for any errors thatwere output by easy_install.
While:
Installing.
Getting section instance.
Initializing section instance.
Installing recipe plone.recipe.zope2instance.
Getting distribution for 'Zope2==2.12.1'.
Error: Couldn't install: Zope2 2.12.1&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;then go and run this, then run Buildout again:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get install python-dev
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Sort your PIL out.&amp;nbsp; See here: &lt;a class="reference external" href="http://davidjb.com/blog/2009/06/virtualenv-plone-and-ubuntu-904-jaunty"&gt;this post&lt;/a&gt; for how to handle it.&amp;nbsp; I'm
sure there are other, possibly easier ways, but the two
'easy_install' lines in that post work.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Run your buildout and hope there's no other problems I haven't
covered.&amp;nbsp; If you get stuck, go say hi to Google and I'll see you back
here after class.&amp;nbsp; Other than that, wait a very long amount of time
whilst the buildout completes, with or without fingers crossed.&amp;nbsp; Your
choice.&amp;nbsp; My buildout's going well so far, though.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;And we're done buildout-ing!&amp;nbsp; Success!&lt;/p&gt;
&lt;p&gt;See my &lt;a class="reference external" href="http://davidjb.com/blog/2009/12/david-tries-plone-4-0a2-part-2"&gt;next post&lt;/a&gt; for my thoughts of this new version so far.&lt;/p&gt;
</summary><category term="alpha"></category><category term="buildout"></category><category term="install"></category><category term="plone"></category><category term="plone 4"></category><category term="testing"></category><category term="zope"></category></entry><entry><title>Start screen after su'ing to another user</title><link href="http://davidjb.com/blog/2009/12/start-screen-after-suing-to-another-user/" rel="alternate"></link><updated>2009-12-04T15:49:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-12-04:blog/2009/12/start-screen-after-suing-to-another-user/</id><summary type="html">&lt;p&gt;Today's problem is one that requires no introduction (well, maybe it
does :-| ) but it's a problem nonetheless.&amp;nbsp; The issue is that after
using the '&lt;strong&gt;su&lt;/strong&gt;' command to become another user, there's trouble
running &lt;strong&gt;screen&lt;/strong&gt; sessions.&lt;/p&gt;
&lt;p&gt;This page
(&lt;a class="reference external" href="http://dbadump.blogspot.com/2009/04/start-screen-after-sudo-su-to-another.html"&gt;http://dbadump.blogspot.com/2009/04/start-screen-after-sudo-su-to-another.html&lt;/a&gt;)
details it simply and perfectly (which, yes, I know in turn came from
another page).&amp;nbsp; Essentially the error is thus:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Cannot open your terminal '/dev/pts/1' - please check.
&lt;/pre&gt;
&lt;p&gt;Which really doesn't man nor beast with its descriptiveness.&amp;nbsp; From that
page, which came from another page mentioned on that page (?), here's
the fix:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
su &lt;span class="o"&gt;[&lt;/span&gt;userName&lt;span class="o"&gt;]&lt;/span&gt;
script /dev/null
screen -x &lt;span class="o"&gt;[&lt;/span&gt;screenName&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;And that's it!&amp;nbsp; Simple solution, and many thanks to that blog for
sorting it out for me.&lt;/p&gt;
</summary></entry><entry><title>Deliverance, Plone, and tags</title><link href="http://davidjb.com/blog/2009/11/deliverance-plone-and-tags/" rel="alternate"></link><updated>2009-11-27T15:17:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-11-27:blog/2009/11/deliverance-plone-and-tags/</id><summary type="html">&lt;p&gt;It's been a little bit of time since my last post, and who can blame me
with my site having been down for almost 2 full days over the last
week!&amp;nbsp; I'm not paying that much for the webspace, thankfully, but if I
was, I'd be seeing red over it.&amp;nbsp; Apparently some patch for MySQL broke
everything; imagine how it looked to see my site with a '500 internal
error' plastered all over it and not being able to access my cPanel.
Ugh.&lt;/p&gt;
&lt;p&gt;Anyway, everything's back again, assuming that you can see this.&amp;nbsp; Okay?
Great!&lt;/p&gt;
&lt;p&gt;Today's conundrum presented itself very, very strangely.&amp;nbsp; People
couldn't change their password in Plone (which effectively breaks
registration if a user has to select a password).&amp;nbsp; The Plone site we
have was being themed by Deliverance. A colleague and I were taking a
look at this earlier in the week and from everything that we could see,
the request traffic and variables were being sent onto Plone correctly
from Deliverance. That said, the issue persisted.&lt;/p&gt;
&lt;p&gt;The issue ended up being a missing &amp;lt;base&amp;gt; tag in the page's HTML &amp;lt;head&amp;gt;
tag. Since this &amp;lt;base&amp;gt; tag controls relative links on any given page, I
guess that the resulting request/etc for password selection must have
been affected.&amp;nbsp; I've seen some pretty whacked out things happen without
that base tag, including bad relative links (the obvious problem),
missing menus on content (another issue relating to an old blog post)
etc.&lt;/p&gt;
&lt;p&gt;Essentially, Deliverance doesn't bring the &amp;lt;base&amp;gt; tag across by default,
as it doesn't know any better. That said, putting these new elements:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;replace&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/html/head/base&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;theme=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/html/head/base&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;append&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/html/head/base&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;theme=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;children:/html/head&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;in the deliverance.xml configuration solved the problem.&amp;nbsp; Depending on
your theme, you might want just one of the lines as it says &amp;quot;replace my
&amp;lt;base&amp;gt; tag in theme with the one from the page&amp;quot; and falls back to
&amp;quot;append the base tag into the theme&amp;quot;.&amp;nbsp; Thanks the tag being moved with
the first command, the 2nd doesn't happen if the base tag is already
gone from the content.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;phew&lt;/em&gt; That was confusing; hopefully it helps someone out!&lt;/p&gt;
</summary><category term="deliverance"></category><category term="element"></category><category term="plone"></category><category term="problem"></category><category term="theme"></category><category term="themeing"></category><category term="xml"></category></entry><entry><title>Plone/Zope, Python and collective.autoreload / plone.reload</title><link href="http://davidjb.com/blog/2009/11/plonezope-python-and-collective-autoreloadplone-reload/" rel="alternate"></link><updated>2009-11-20T14:34:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-11-20:blog/2009/11/plonezope-python-and-collective-autoreloadplone-reload/</id><summary type="html">&lt;p&gt;Here's an interesting error message I got stumped with for a good set of
hours.&amp;nbsp; The issue started with me using collective.autoreload with Plone
and it does the trick, mostly.&amp;nbsp; With any such 'operation' and live
reloading of code for Python, you've got to expect that not everything
will go according to plan.&amp;nbsp; Most things do, but one issue I found
presented with this error message:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;&amp;lt; ... huge traceback ...&amp;gt;
TypeError: super(type, obj): obj must be an instance or subtype of type&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The issue arises for me (and you'll probably see it elsewhere) when I go
ahead and modify a Python class that I've extended off from another, and
I'm calling a function from the parent class.&amp;nbsp; The browser view class
I'm extending from needs to use the same methods but extend the
functionality, so hence me calling super(...).myfunction().&amp;nbsp;&amp;nbsp; In
hindsight, the error is actually pretty logical -- the &amp;quot;obj&amp;quot; is being
shown to not be a type or subtype of the specified type.&amp;nbsp; What they
didn't spell out in bright neon letters is that whilst the type I was
working with looks the same in code (it IS the same), having it reloaded
makes it different.&lt;/p&gt;
&lt;p&gt;The solution is to restart Zope and go again.&amp;nbsp; This same thing manifests
in a number of different ways (Error 500 Internal Server Errors for
certain views, etc) but if you're seeing something weird, don't always
assume you've broken something. My favourite thought for the week
applies directly to this:&amp;nbsp; just because you hear hoofbeats, don't
immediately think zebras.&amp;nbsp; Being in IT though, it's hard to go straight
for the simplest solution.&amp;nbsp;&amp;nbsp; Might save you some head-bashing as I've
done it for you. :)&lt;/p&gt;
&lt;p&gt;As a side note, it's a similar idea as a network problem I saw the other
day.&amp;nbsp; The problem could have been solved in 5 seconds by looking at the
lights on the network port, but the &amp;quot;IT solution&amp;quot; was to restart the
computer between OSes and check if the OS was the problem.&amp;nbsp; Victims of
our own knowledge; we sadly know too much.&lt;/p&gt;
</summary><category term="code"></category><category term="collective"></category><category term="egg"></category><category term="error"></category><category term="package"></category><category term="plone"></category><category term="python"></category><category term="reload"></category><category term="restart"></category></entry><entry><title>Ubuntu 9.10 install hiccough</title><link href="http://davidjb.com/blog/2009/10/ubuntu-9-10-install-hiccough/" rel="alternate"></link><updated>2009-10-30T13:21:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-10-30:blog/2009/10/ubuntu-9-10-install-hiccough/</id><summary type="html">&lt;p&gt;Yay, the new version of Ubuntu is out. &amp;nbsp;With it comes plenty of cool new
features (how awesome does the start up and login screen look now?) and
also plenty of opportunities for things to break when I've become so
accustomed to having them working. &amp;nbsp;At least it's not Windows though --
I think I may just gnaw my own limbs off before I have to get forced to
upgrade to Windows 7 for gaming reasons.&lt;/p&gt;
&lt;p&gt;But I digress, there was one reasonably small problem with the upgrade
that I saw on both of my Ubuntu machines (laptop and desktop):
&amp;nbsp;python-wxversion has a problem and won't upgrade. &amp;nbsp;Looking back in the
terminal it appeared that either it was an &amp;quot;IOError: bad file
descriptor&amp;quot; or otherwise a certain file (well, it did change when I
tried to reinstall) like wxversion.py can't be found in
/usr/lib/python2.6. &amp;nbsp;All very confusing.&lt;/p&gt;
&lt;p&gt;It was especially worrying when the installer came up and said &amp;quot;Sorry,
your upgrade failed. &amp;nbsp;Your system could be in an unstable state.&amp;quot; &amp;nbsp;That
sent alarm bells ringing and possibly with good reason (eg broken apps)
-- at least I had good reason to fix the problem rather than just ignore
it.&lt;/p&gt;
&lt;p&gt;The solution was simple for both machines:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get remove python-wxgtk2.8
sudo apt-get install python-wxgtk2.8
&lt;/pre&gt;
&lt;p&gt;Not painful at all. &amp;nbsp;Except it was a case of finding which package to
reinstall. &amp;nbsp;Don't try and reinstall python-wxversion like I did because
you won't get far. &amp;nbsp;It'll still die. &amp;nbsp;python-wxversion is, however, a
dependency of the above package so all's well once you get that sorted.&lt;/p&gt;
&lt;p&gt;From Googling, it looks like this problem was common and thankfully
fixed in the repos. &amp;nbsp;Although, it was still present on Karmic upgrade so
who knows.&lt;/p&gt;
&lt;p&gt;Maybe it's bad Karma? &amp;nbsp;I bet 1000 people have made that joke already...&lt;/p&gt;
</summary><category term="jaunty"></category><category term="karmic"></category><category term="koala"></category><category term="linux"></category><category term="problem"></category><category term="python"></category><category term="ubuntu"></category><category term="upgrade"></category></entry><entry><title>HTML formatting made easy</title><link href="http://davidjb.com/blog/2009/10/html-formatting-made-easy/" rel="alternate"></link><updated>2009-10-13T10:30:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-10-13:blog/2009/10/html-formatting-made-easy/</id><summary type="html">&lt;p&gt;There's a tool for everything somewhere on the web.&lt;/p&gt;
&lt;p&gt;Whilst about 99.5% perfect (some indentation issues remain), I've found
a pretty nice, easy to use, and very feature-rich HTML code formatter.
See &lt;a class="reference external" href="http://www.mycoolform.com/index.php?lang=en"&gt;http://www.mycoolform.com/index.php?lang=en&lt;/a&gt; for the formatter.&lt;/p&gt;
&lt;p&gt;It's something I was looking for a while back but didn't have so much
luck to stumble onto something so useful.&amp;nbsp; Previously, I was looking for
something that would fix up some HTML to XHTML and whilst I'm sure
something was out there, the problem was I needed something that would
do the job, but stay away from TAL attributes on my elements.&amp;nbsp; The
things that I had found did &amp;quot;too good&amp;quot; of a job and dumped those
elements, which is fair enough because things like 'tal:content=' isn't
valid XHTML.&lt;/p&gt;
&lt;p&gt;This formatted though does new lines, auto-indentation, change of case
for tags and attributes (hello XHTML compliance), comment removal and
white space elimination.&amp;nbsp; Great stuff; so many thanks to its author (who
is anonymous I guess?).&lt;/p&gt;
</summary><category term="code"></category><category term="formatter"></category><category term="html"></category><category term="indentation"></category><category term="tool"></category><category term="web"></category></entry><entry><title>A little time out</title><link href="http://davidjb.com/blog/2009/10/a-little-time-out/" rel="alternate"></link><updated>2009-10-11T22:17:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-10-11:blog/2009/10/a-little-time-out/</id><summary type="html">&lt;p&gt;Taking a little time out from the professional blogging, here's a page
out of my personal side of things.&lt;/p&gt;
&lt;p&gt;Things have been very busy as of late and, as the previous sentance
suggests, not just with work. Tomorrow's the day when my and my
partner's house settlement takes place and after all the bumps along the
way, we've finally gotten there. The bumps were sadly some very
unprofessional dealings with my fiancier credit union (who will
otherwise remain nameless), an inability of lawyers and conveyancers to
add numbers together, and a whole lot of confusion. As I said,
thankfully that's all soon to be behind us now anyway. Then, we've just
got to either kindly ask the tenants to move out or wait until their
lease expires in Feburary 2010, and then we're into the place. Here's
hoping it's before Christmas, but we're not holding our breath.&lt;/p&gt;
&lt;p&gt;Been playing squash a whole lot more as of late and I'm currently paying
the price for several over-stretched shots. Considering I've never been
much of a sports person or really even been very active at all, I've
been playing and developing reasonably well [or so I'm told]. Best thing
is that I do enjoy the game and our local courts are air conditioned at
the University (and cheap too). At any rate, I'm getting fitter (which
is good/scary) and getting out of the house and away from technology for
a bit.&lt;/p&gt;
&lt;p&gt;And of course, back on the topic of technology, I've been
introduced/coerced into the world of Left4Dead. Quite an enjoyable game,
if one enjoys the notion of ending zombie after zombie. Whilst the
storyline isn't unique by any stretch of the imagination (infection
wipes out world and turns people to zombies), the characters and their
'personalities' are very, very close to those from the BBC TV series
Survivors which was on as of late. Whilst there were no zombies in
Survivors, the idea is reasonably similar.&lt;/p&gt;
&lt;p&gt;I think from all the many doses of post-apocalyptic drama and gameplay,
if the world ever does come to an end as we know it, methinks I've got a
good chance of making it. Here's hoping anyway.&lt;/p&gt;
&lt;p&gt;Back to normality on my next post since it's back to work tomorrow.
Hopefully going to polish off the projects I'm working on shortly and
impress some people (including myself)...&lt;/p&gt;
</summary><category term="house"></category><category term="life"></category><category term="Personal"></category><category term="settlement"></category><category term="squash"></category></entry><entry><title>Missing content menus in Plone</title><link href="http://davidjb.com/blog/2009/09/missing-content-menus-in-plone/" rel="alternate"></link><updated>2009-09-30T12:35:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-30:blog/2009/09/missing-content-menus-in-plone/</id><summary type="html">&lt;p&gt;Another dose of insanity please!&amp;nbsp; Coming right up, sir.&lt;/p&gt;
&lt;p&gt;Today's second discussion comes from an issue I was having recently with
a new Plone site that I was hosting behind Apache and Deliverance.&amp;nbsp; No
Varnish here yet, because I'd rather the site worked first before I try
and cache the life out of it.&lt;/p&gt;
&lt;p&gt;Now, the specific problem I was having was that the content menus in
Plone (eg Add New, Display, State, Actions and for me, Sub-types)
weren't displaying.&amp;nbsp; I thought it a Deliverance issue - maybe I was
dropping those content items accidentally or not including the
JavaScript needed to display them.&amp;nbsp; Uh, nope on both accounts.&lt;/p&gt;
&lt;div class="section" id="solution"&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;After a detailed search of everything I could have been doing wrong, I
can across my Apache rewrite rules.&amp;nbsp; Amazingly enough, I'd left off the
&lt;strong&gt;/_vh_mysite&lt;/strong&gt; at the end, so the URLs weren't being written
correctly.&amp;nbsp; Whilst the site was loading (mostly) fine, because I'd
inserted the URL to point to the site correctly, I'd forgotten that the
VHM needs the _vh_mysite part.&lt;/p&gt;
&lt;p&gt;Adding it in fixed the problem in a second, along with a throat-clearing
shift-refresh.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="apache"></category><category term="hosting"></category><category term="menus"></category><category term="plone"></category><category term="rewrite"></category><category term="rules"></category><category term="urls"></category><category term="VHM"></category><category term="virtual hosting"></category></entry><entry><title>Migrating a Plone site off to another database (Zeo)</title><link href="http://davidjb.com/blog/2009/09/migrating-a-plone-site-off-to-another-database-zeo/" rel="alternate"></link><updated>2009-09-30T12:25:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-30:blog/2009/09/migrating-a-plone-site-off-to-another-database-zeo/</id><summary type="html">&lt;p&gt;Another of the interesting things in my professional life has been
migrating a Plone site from one database (where it lived as a dev site,
along with many others) onto a nice, clean database of its own.&amp;nbsp; Now,
yes, I'm aware that the export/import feature of Zope &lt;strong&gt;isn't&lt;/strong&gt; supposed to
be used for migrating content or sites.&amp;nbsp; I am also aware, however,
through personal experience, that things have always been fine because
I'm using the same eggs and essentially the same installations
everywhere, thanks to buildout.&lt;/p&gt;
&lt;p&gt;So, the process goes as follows, with the above-mentioned points
considered already:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Head to the root of your ZMI and export your given Plone site&amp;nbsp; as
ZEXP&lt;/li&gt;
&lt;li&gt;Shut down your instance (or do what you will with your old site and
installation)&lt;/li&gt;
&lt;li&gt;Copy the ZEXP file into the 'import' folder of your new Zope instance&lt;/li&gt;
&lt;li&gt;Start your new instance, with your new empty database&lt;/li&gt;
&lt;li&gt;Log in to the root of the ZMI&lt;/li&gt;
&lt;li&gt;Add a new Plone site and call it anything you want (eg 'foo').&amp;nbsp; I'll
explain why shortly.&lt;/li&gt;
&lt;li&gt;Delete your 'foo' Plone site.&lt;/li&gt;
&lt;li&gt;Import your existing Plone site and be happy because it's now arrived
safe and sound.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="section" id="note"&gt;
&lt;h2&gt;Note&lt;/h2&gt;
&lt;p&gt;The reason I highlight adding a new Plone site a point 6 is because if
originally, you were like me and imported your site first to a bare Zope
install, you'll get errors &lt;strong&gt;everywhere&lt;/strong&gt; in your site.&amp;nbsp; They'll look
like &amp;quot;AttributeError: getGroups&amp;quot; or possibly something more obscure (if
possible!) and everything will fall over and die.&lt;/p&gt;
&lt;p&gt;Now, by creating a new Plone site first 'massages' the root of Zope, and
then your site should be fine.&amp;nbsp; Among other things, adding a site
changes the acl_users of the ZMI (seeing an abnormal acl_users is what
led me to the solution).&amp;nbsp; At a guess, given its type, this acl_users
change probably has something to do with the error above.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="database"></category><category term="export"></category><category term="import"></category><category term="migration"></category><category term="plone"></category><category term="site"></category><category term="zeo"></category><category term="zodb"></category></entry><entry><title>LDAP-Authenticated Server &amp; Whoami Failures (etc)</title><link href="http://davidjb.com/blog/2009/09/ldap-authenticated-server-whoami-failures-etc/" rel="alternate"></link><updated>2009-09-28T11:53:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-28:blog/2009/09/ldap-authenticated-server-whoami-failures-etc/</id><summary type="html">&lt;p&gt;I'm back again, after a bit of a unscheduled 'break' in my normal work
life.&amp;nbsp; After a couple of days away for work on the Gold Coast, then the
sad passing of my Grandfather and his memorial, then being sick over the
last weekend from what I can only guess was a nasty 24-hour bug, I'm
back.&amp;nbsp; And whilst a little worse for wear still today, it's life pretty
much as normal.&lt;/p&gt;
&lt;p&gt;Today's fun and games was on a server we use that uses LDAP
authentication for its users.&amp;nbsp; Nothing special, except that today I
started getting weird errors when logging in as my LDAP account, and the
server booting me off with random error messages:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
whoami: cannot find name for user ID 75966
-tcsh: ldap-nss.c:1312: do\_init: Assertion \`cfg-&amp;gt;ldc\_uris[\_\_session.ls\_current\_uri] != ((void \*)0)' failed.
&lt;/pre&gt;
&lt;div class="section" id="solution"&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;The simple solution was to check the permissions on &lt;tt class="docutils literal"&gt;/etc/ldap.conf&lt;/tt&gt;
(Centos) and sure enough, the permissions weren't allowing normal users
to read it (eg not 644).&amp;nbsp; Running this solves the problem:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
chmod 644 /etc/ldap.conf
&lt;/pre&gt;
&lt;p&gt;Cheers to the author &amp;#64;
&lt;a class="reference external" href="http://www.ducea.com/2008/03/07/ldap-troubleshooting-i-have-no-name/"&gt;http://www.ducea.com/2008/03/07/ldap-troubleshooting-i-have-no-name/&lt;/a&gt; for
the details.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="authentication"></category><category term="centos"></category><category term="chmod"></category><category term="ldap"></category><category term="login"></category><category term="permissions"></category><category term="users"></category></entry><entry><title>PloneFormGen (Plone) &amp; Google Calendar Integration</title><link href="http://davidjb.com/blog/2009/09/ploneformgen-plone-google-calendar-integration/" rel="alternate"></link><updated>2009-09-22T10:40:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-22:blog/2009/09/ploneformgen-plone-google-calendar-integration/</id><summary type="html">&lt;p&gt;It's a little bit of a different mash-up, but it's still nonetheless
useful to have, given types of booking forms and so forth that could
utilise it.&amp;nbsp; The easiest way I found (to avoid security issues with
Python scripts in Plone) was to create an external method and just
import it within a PFG Custom Adapter.&lt;/p&gt;
&lt;div class="section" id="parts"&gt;
&lt;h2&gt;Parts&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;My &lt;a class="reference external" href="http://davidjb.com/static/files/GoogleCalendar.py"&gt;GoogleCalendar.py&lt;/a&gt; external method.&amp;nbsp; I've had to add this into a
policy product I have.&amp;nbsp; The function should be generalised enough to
work with any Google account, hosted or not.&amp;nbsp; In short:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;It takes in a variety of arguments (email, password,
calendar_url, start_time, end_time, title, location, content).&lt;ul&gt;
&lt;li&gt;Email/password are your auth details&lt;/li&gt;
&lt;li&gt;calendar_url is where you're putting the event,&lt;/li&gt;
&lt;li&gt;and the rest of the args are related to the event itself.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;It builds the XML-based request to create the event.&amp;nbsp; I tried
going for the gdata API, but it's just over the top for a simple
exercise like this.&lt;/li&gt;
&lt;li&gt;Send the request to Google (twice, as required), and create the
event in the process.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;A custom PFG script adapter like this:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;DateTime&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;DateTime&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;my.theme.Extensions.GoogleCalendar&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;createGoogleCalendarEvent&lt;/span&gt;
&lt;span class="n"&gt;calendar_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'http://www.google.com/...'&lt;/span&gt;
&lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'&amp;lt;span class=&amp;quot;mh-email&amp;quot;&amp;gt;myu&amp;lt;a href=&amp;quot;http://www.google.com/recaptcha/mailhide/d?k=01y8BLyDqFl2lR8hms6kYeaw==&amp;amp;c=WDOrJledyL7Tzo9unwfHPwgE0TrIw31nHDxcUFu_QIY=&amp;quot; onclick=&amp;quot;window.open('&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;recaptcha&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mailhide&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mo"&gt;01&lt;/span&gt;&lt;span class="n"&gt;y8BLyDqFl2lR8hms6kYeaw&lt;/span&gt;&lt;span class="o"&gt;==&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;WDOrJledyL7Tzo9unwfHPwgE0TrIw31nHDxcUFu_QIY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;', '', '&lt;/span&gt;&lt;span class="n"&gt;toolbar&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;scrollbars&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;statusbar&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;menubar&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;resizable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="s"&gt;'); return false;&amp;quot; title=&amp;quot;Reveal this e-mail address&amp;quot;&amp;gt;...&amp;lt;/a&amp;gt;&amp;#64;google.com&amp;lt;/span&amp;gt;'&lt;/span&gt;
&lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'shhhhhsecret'&lt;/span&gt;
&lt;span class="n"&gt;startDateTime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DateTime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'start-date-time'&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTML4&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;endDateTime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DateTime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'end-date-time'&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTML4&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;eventTitle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'purpose'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;eventLocation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'rooms-to-book'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;eventContent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'Booked for:  '&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'booking-name'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;createGoogleCalendarEvent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;calendar_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;startDateTime&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;endDateTime&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;eventTitle&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;eventLocation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;eventContent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;And that should be that.&amp;nbsp; As long as all your URLs, emails, passwords,
and fields in your form are suitable, this should work a treat.&amp;nbsp; Note
that the start-date-time and end-date-time fields are date/time fields
in your Form Folder and converting to HTML4() makes them into Google's
format.&amp;nbsp; Additional info can be added in the eventContent variable, and
that'll turn up in the Description in Google Calendar.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="for-added-spice"&gt;
&lt;h2&gt;For added spice...&lt;/h2&gt;
&lt;p&gt;Just add a web interface to your Google Calendar to your Plone site (eg
in a normal Plone page; watch out for iframe filtering) and let people
book themselves into things.&amp;nbsp; Would be great to see PFG know when a
Google Calendar event was on (and stop people submitting) but it's a bit
much just for now.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="calendar"></category><category term="form"></category><category term="gen"></category><category term="google"></category><category term="mash"></category><category term="pfg"></category><category term="plone"></category><category term="product"></category><category term="python"></category><category term="script"></category></entry><entry><title>ffmpeg and FLV on Ubuntu</title><link href="http://davidjb.com/blog/2009/09/ffmpeg-and-flv-on-ubuntu/" rel="alternate"></link><updated>2009-09-22T10:21:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-22:blog/2009/09/ffmpeg-and-flv-on-ubuntu/</id><summary type="html">&lt;p&gt;Wow, ffmpeg is really great for converting multimedia.&amp;nbsp; Unfortunately,
the support for MP3 audio doesn't appear available by default.&amp;nbsp; Sure, it
can decode MP3 audio and write to an MP3 container, but what about
having an actual MP3 codec available?&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get purge ffmpeg
sudo apt-get install libavcodec-unstripped-52 libavdevice-unstripped-52 libavformat-unstripped-52 libavutil-unstripped-49 libpostproc-unstripped-51 libswscale-unstripped-0 ffmpeg
&lt;/pre&gt;
&lt;p&gt;As a little bonus, there's a number of other codecs that come along with
it too (xvid etc).&amp;nbsp; I'm not too fussed on them but now I can use
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-acodec&lt;/span&gt; libmp3lame&lt;/tt&gt; as my audio codec and have the FLV outputted with
MP3 audio.&amp;nbsp; There's a problem with either the default FLV encoder or VLC
not being able to playback the audio with default settings, but this
seems to work.&lt;/p&gt;
&lt;p&gt;That said, it remains to be seen if this'll cause any problems with FLV
playback, but the players I've used so far (web-based) seem happy
enough.&lt;/p&gt;
</summary><category term="ffmpeg"></category><category term="flv"></category><category term="linux"></category><category term="multimedia"></category><category term="ubuntu"></category></entry><entry><title>Git and checkouts by date</title><link href="http://davidjb.com/blog/2009/09/git-and-checkouts-by-date/" rel="alternate"></link><updated>2009-09-07T13:09:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-07:blog/2009/09/git-and-checkouts-by-date/</id><summary type="html">&lt;p&gt;Cheers to this &lt;a class="reference external" href="http://www.bramschoenmakers.nl/en/node/645"&gt;very handy post&lt;/a&gt; for posting details from Nabble on how
to check out a git branch based upon the date it was commited.&amp;nbsp; If I
haven't modified Wordpress to turn off the character replacement, then
watch out because the double-quotes and double-dash will need to be
checked before running the command:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
git checkout &lt;span class="sb"&gt;`&lt;/span&gt;git rev-list -n 1 --before&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2009-07-27 13:37&amp;quot;&lt;/span&gt; master&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;A very easy way to flick back to a given revision.&lt;/p&gt;
</summary><category term="date"></category><category term="git"></category><category term="history"></category><category term="versions"></category></entry><entry><title>Buildout: the biggest problems have the simplest answers...</title><link href="http://davidjb.com/blog/2009/09/the-biggest-problems-have-the-simplest-answers/" rel="alternate"></link><updated>2009-09-03T15:57:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-03:blog/2009/09/the-biggest-problems-have-the-simplest-answers/</id><summary type="html">&lt;p&gt;..and how true that is.&amp;nbsp; Today's time consumer is directly related to
just 1 misplaced line of a buildout configuration (and presumably
something that's changed somewhere else).&lt;/p&gt;
&lt;div class="section" id="the-result"&gt;
&lt;h2&gt;The result&lt;/h2&gt;
&lt;p&gt;After much hunting and hunting, it turns out my Zope2 Fake Eggs weren't
being generated.&lt;/p&gt;
&lt;p&gt;On my long quest I had to go through downloading new packages and trying
to find something that had changed and even trying to establish new
virtual environments on different VMs.&amp;nbsp; Nothing would fix the problem.
To rub salt in the wound, my desktop Ubuntu ran the buildout fine, so
methinks the underlying reason for the pain is something OS-related.&lt;/p&gt;
&lt;p&gt;After many hours of debugging buildout output and trying to go through
the packages that seemed to be the cause (poor things, they were merely
bystanders, asking for dependencies), a few carefully-placed print
messages in the plone.recipe.zope2install package helped.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-cause"&gt;
&lt;h2&gt;The cause&lt;/h2&gt;
&lt;p&gt;&amp;quot;Oh? what do you mean the install() function isn't being run?&amp;quot;, I found
myself saying after the print messages showed what was happening.&amp;nbsp; The
fake eggs didn't exist because the Zope2 recipe, whilst being initiated,
hadn't yet actually been run.&lt;/p&gt;
&lt;p&gt;So, thanks to the 'zope2' entry in the parts section of my buildout
being run after a whole lot of other sections, the other products never
had a chance.&amp;nbsp; Result: lesson learned -- put the zope2 section first,
and order matters!&lt;/p&gt;
&lt;p&gt;Oddly enough though, it's never caused trouble before and obviously
there's a difference between Centos and Ubuntu.&amp;nbsp; Hmmm.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="buildout"></category><category term="centos"></category><category term="eggs"></category><category term="linux"></category><category term="plone"></category><category term="ubuntu"></category><category term="zope"></category></entry><entry><title>Deliver me from ... Deliverance?</title><link href="http://davidjb.com/blog/2009/09/deliver-me-from-deliverance/" rel="alternate"></link><updated>2009-09-02T14:26:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-09-02:blog/2009/09/deliver-me-from-deliverance/</id><summary type="html">&lt;p&gt;Always one for being on and beyond the bleeding edge of new technology,
I've (with the help of colleagues) been setting up a new technology for
applying themes to web sites.&amp;nbsp; In particular, I'm applying Deliverance
to Plone and whilst I'm not the first one to venture out into the
wilderness this way, I've got to be thinking that I could be one of the
few people documenting their experience.&amp;nbsp; Ah, but where to begin?&lt;/p&gt;
&lt;div class="section" id="the-proxy"&gt;
&lt;h2&gt;The proxy&lt;/h2&gt;
&lt;p&gt;Ah yes, the proxy.&amp;nbsp; Deliverance is very kind to us in that it operates
it's own proxy.&amp;nbsp; This, whilst okay, is a royal pain when Apache or
similar is sitting in front, sending rewritten URLs to Deliverance [I'm
hosting as a sub-folder on a domain].&amp;nbsp; Maybe I'm just not cluey enough
to figure it out, but when you spend almost a week and then have to hack
things about with python code, it's probably not just me.&amp;nbsp; In some
cases, I think Deliverance is just trying to be 'too' smart, and you'll
see what I mean shortly.&lt;/p&gt;
&lt;p&gt;At any rate, I've made Apache do a &lt;strong&gt;ProxyPass&lt;/strong&gt; to Deliverance and then
make Deliverance do the &amp;quot;rewriting&amp;quot;, and then the Zope VHM makes magic
happen like normal.&amp;nbsp; Great!&amp;nbsp; Except no, that's not it, because
Deliverance has no idea about the fact my site is hosted from both HTTP
and HTTPS (or hosted from 2 domains)?&amp;nbsp; What I've had to do is thus in
Apache (and the same for HTTP etc):&lt;/p&gt;
&lt;pre class="code apache literal-block"&gt;
&lt;span class="nb"&gt;RequestHeader&lt;/span&gt; set X-Forwarded-Scheme https
&lt;span class="nb"&gt;RequestHeader&lt;/span&gt; set X-Forwarded-Port &lt;span class="m"&gt;443&lt;/span&gt;
&lt;span class="nb"&gt;ProxyPass&lt;/span&gt; &lt;span class="sx"&gt;/mysite&lt;/span&gt; http://my.deliverance.host:8000/mysite
&lt;/pre&gt;
&lt;p&gt;and then this in Deliverance, since we now have what scheme/port/host
we're serving from.&amp;nbsp; All URLs coming back from Plone/VHM will be okay!
8-):&lt;/p&gt;
&lt;pre class="code apache literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;proxy&lt;/span&gt; &lt;span class="s"&gt;path=&amp;quot;/mysite&amp;quot; domain=&amp;quot;my.sites.domain&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;dest&lt;/span&gt; &lt;span class="s"&gt;href=&amp;quot;http://localhost:8080/VirtualHostBase/{X-Forwarded-Scheme}/{X-Forwarded-Server}%3A{X-Forwarded-Port}/mysite/VirtualHostRoot/_vh_mysite&amp;quot; /&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;transform&lt;/span&gt; &lt;span class="s"&gt;strip-script-name=&amp;quot;1&amp;quot; keep-host=&amp;quot;0&amp;quot; /&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;response&lt;/span&gt; &lt;span class="s"&gt;rewrite-links=&amp;quot;0&amp;quot; /&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/proxy&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="the-theme"&gt;
&lt;h2&gt;The theme&lt;/h2&gt;
&lt;p&gt;Oh, the theme.&amp;nbsp; Again, Deliverance tries to be too smart for its own
good if you specify a Deliverance-hosted theme here.&amp;nbsp; If you have
something relevative (eg &lt;tt class="docutils literal"&gt;/_theme/theme.html&lt;/tt&gt;), it'll work, but on your
HTTPS site all theme elements will be unencrypted since HTTP is it.
Whoops!&lt;/p&gt;
&lt;p&gt;Resolution?&amp;nbsp; Not nice, but you'll need to serve your resources outside
of Deliverance (probably faster anyway!), and have them accessible for
both protocols.&amp;nbsp; The good news is that when you specify an &lt;strong&gt;absolute&lt;/strong&gt;
URL, with protocol, then Deliverance pays attention, thus:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;theme&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;{X-Forwarded-Scheme}://static.web.server/static/mysite/theme.html&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;domain=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;my.sites.domain&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="post-requests"&gt;
&lt;h2&gt;POST requests&lt;/h2&gt;
&lt;p&gt;Ughh.&amp;nbsp; Deliverance feels the need to be smart, &lt;em&gt;again&lt;/em&gt;, by applying
themes to incoming POST requests.&amp;nbsp; Now, I can't think of any time you'd
&lt;em&gt;actually&lt;/em&gt; want this (unless...well, no..never), so make sure you've got
something like this in your XML file to stop Deliverence:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;match&lt;/span&gt; &lt;span class="na"&gt;environ=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;REQUEST_METHOD: POST&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;abort=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="copying-moving-attributes"&gt;
&lt;h2&gt;Copying/Moving Attributes&lt;/h2&gt;
&lt;p&gt;Okay, now this one's just weird.&amp;nbsp; You need to specify which individual
or several attributes from your content and then tell Deliverance to
apply them all to the attributes of the target element.&amp;nbsp; Seems simple
enough now, but why is there no doco?&amp;nbsp; This works:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;replace&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;attributes(href):#portal-logo&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;theme=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;attributes://*[&amp;#64;id='globalnav']/div/a&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;and this won't (type mismatch error):&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;replace&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;attributes(href):#portal-logo&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;theme=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;attributes(href)://*[&amp;#64;id='globalnav']/div/a&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Don't get me wrong, I like Deliverance.&amp;nbsp; Xpath support is great, CSS
3-style selectors are awesome, and what it does is magical.&amp;nbsp; However, it
needs a bit of work before I parachute away from Plone's themes for
good.&lt;/p&gt;
&lt;p&gt;Fair's fair though, it's only version 0.3.&amp;nbsp; I'm looking very forward to
the future though.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="bleeding edge"></category><category term="deliverance"></category><category term="plone"></category><category term="rules"></category><category term="technology"></category><category term="theme"></category><category term="themeing"></category><category term="xml"></category></entry><entry><title>Migration complete (mostly)</title><link href="http://davidjb.com/blog/2009/08/migration-complete-mostly/" rel="alternate"></link><updated>2009-08-20T09:23:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-08-20:blog/2009/08/migration-complete-mostly/</id><summary type="html">&lt;p&gt;Well, that's always a good reason to let out a sigh of relief: I've
managed to migrate most of the content from my previous blog over at
Wikidot (which wasn't really a blog so much as it was a hacked wiki).
So, you'll find a lot more content here than before, which is good,
because it makes me look like I'm actually dedicated to creating content
;-)&lt;/p&gt;
&lt;p&gt;I've also relaxed restrictions on comments (and added CAPTCHA security)
so comment away people, if you're reading this.&amp;nbsp; Just don't expect much
love if you spam though...&lt;/p&gt;
</summary><category term="content"></category><category term="migration"></category><category term="wiki"></category><category term="wikidot"></category></entry><entry><title>Plone: Re-ordering Viewlets</title><link href="http://davidjb.com/blog/2009/08/plone-re-ordering-viewlets/" rel="alternate"></link><updated>2009-08-19T16:34:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-08-19:blog/2009/08/plone-re-ordering-viewlets/</id><summary type="html">&lt;p&gt;Just responded to a post on the Plone Nabble forums (&lt;a class="reference external" href="http://n2.nabble.com/reordering-portal-globalnav--tp3470440p3470440.html"&gt;here&lt;/a&gt;) about how
to re-order viewlets.&amp;nbsp; In particular, this one is little different (but
not terribly so) because the original poster wanted to put the
breadcrumbs above the global sections (global tabs in Plone).&amp;nbsp; Normally,
this is straight forward because you just use a Generic Setup profile
(viewlets.xml) and use an order manager to move your viewlet.&amp;nbsp; This,
however, is a teeny bit more complicated because you've got one viewlet
that's outside of another viewlet manager.&lt;/p&gt;
&lt;p&gt;Without further ado, my post from the forums:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Check out
&lt;a class="reference external" href="http://plone.org/documentation/tutorial/customizing-main-template-viewlets/reordering-and-hiding-viewlets"&gt;http://plone.org/documentation/tutorial/customizing-main-template-viewlets/reordering-and-hiding-viewlets&lt;/a&gt;
for a pretty useful idea of manipulating viewlets.&lt;/p&gt;
&lt;p&gt;As it mentions there, you need a viewlets.xml in your theme
product's generic setup profile. &amp;nbsp;In this case, there's a bit more
complexity because the path_bar isn't registered in the same order
manager. &amp;nbsp;So, in your case, you'll want something like this in your
&lt;strong&gt;viewlets.xml&lt;/strong&gt; (hides the old path bar, and inserts it now before
the global sections [tabs]):&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;hidden&lt;/span&gt; &lt;span class="na"&gt;manager=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;plone.portaltop&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;skinname=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;My Theme&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;viewlet&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;plone.path_bar&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/hidden&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;order&lt;/span&gt; &lt;span class="na"&gt;manager=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;plone.portalheader&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;skinname=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;My Theme&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;viewlet&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;plone.path_bar&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;insert-before=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;plone.global_sections&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/order&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;and you'll need to have something like this in a &lt;strong&gt;configure.zcml&lt;/strong&gt;
file (eg browser/configure.zcml) in order to get it into the
PortalHeader manager:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;browser&lt;/span&gt; &lt;span class="err"&gt;:viewlet&lt;/span&gt;
    &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;plone.path_bar&amp;quot;&lt;/span&gt;
    &lt;span class="na"&gt;manager=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;plone.app.layout.viewlets.interfaces.IPortalHeader&amp;quot;&lt;/span&gt;
    &lt;span class="na"&gt;permission=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;zope2.View&amp;quot;&lt;/span&gt;
    &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;So, make these updates to your theme product, reinstall, and it
should be good.&lt;/p&gt;
&lt;p&gt;Also, depending on ordering and what else you have in your theme,
you might just want to re-order plone.path_bar to the top of the
plone.portaltop viewlet. &amp;nbsp;That'll put it before the PortalHeader
manager (as you can see in &amp;#64;&amp;#64;manage-viewlets).&lt;/p&gt;
&lt;/blockquote&gt;
</summary><category term="genericsetup"></category><category term="plone"></category><category term="product"></category><category term="programming"></category><category term="theme"></category></entry><entry><title>Creating &amp; distributing a new Plone/PyPI product</title><link href="http://davidjb.com/blog/2009/08/creating-distributing-a-new-plonepypi-product/" rel="alternate"></link><updated>2009-08-17T10:01:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-08-17:blog/2009/08/creating-distributing-a-new-plonepypi-product/</id><summary type="html">&lt;p&gt;It's amazing to see how technologies can be so smoothly integrated these
days.&amp;nbsp; I'm talking, at least in this instance, about how setuptools
works with PyPI (and then Plone.org's Products section) and allows you
to distribute your product(s) to the world.&amp;nbsp; So far, I've just got the
one -- collective.portlet.googleapps -- but I'm sure time will pass and
I'll have some more useful things to contribute. Here's a summary of
what I did:&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;Create the product.&amp;nbsp; ZopeSkel is a wonderful help here for Plone
products. [I lie a little bit in my code example, because sadly, the
plone3_portlet template doesn't have nesting.&amp;nbsp; I cheated by using
the Archetypes template and copied in my portlet code &amp;amp; repeated to
create multiple portlets in one product]:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
easy_install-2.4 ZopeSkel
paster2.4 create --list-templates
paster2.4 create -t plone3_portlet collective.portlet.googleapps
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Upload it to some relevant code repository.&amp;nbsp; I've used the Plone
collective SVN (and &lt;a class="reference external" href="http://plone.org/documentation/how-to/create-a-new-project-in-the-plone-collective"&gt;this guide&lt;/a&gt;):&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
svn mkdir https://svn.plone.org/svn/collective/collective.portlet.googleapps -m &lt;span class="s1"&gt;'Created new project'&lt;/span&gt;
svn mkdir https://svn.plone.org/svn/collective/collective.portlet.googleapps/&lt;span class="o"&gt;{&lt;/span&gt;trunk,branches,tags&lt;span class="o"&gt;}&lt;/span&gt; -m &lt;span class="s1"&gt;'Added base files'&lt;/span&gt;
svn co https://svn.plone.org/svn/collective/collective.portlet.googleapps/trunk collective.portlet.googleapps
&lt;span class="o"&gt;[&lt;/span&gt;copy stuff into the folder&lt;span class="o"&gt;]&lt;/span&gt;
svn ci
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Do some work.&amp;nbsp; When you're happy, make a tag for the relevant release
version:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
svn copy https://svn.plone.org/svn/collective/collective.portlet.googleapps/trunk https://svn.plone.org/svn/collective/collective.portlet.googleapps/tags/0.1
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="http://pypi.python.org/pypi?%3Aaction=register_form"&gt;Sign up for PyPI&lt;/a&gt; (Python Package Index), &lt;a class="reference external" href="http://www.dewinter.com/gnupg_howto/english/GPGMiniHowto-3.html"&gt;generate a GPG
key&lt;/a&gt;, and add the key ID to your account profile page.&amp;nbsp; Your key ID
can be found on this line after generation:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gpg: key XXXXXXXX marked as ultimately trusted
&lt;/pre&gt;
&lt;p&gt;or otherwise through &lt;strong&gt;gpg --list-keys&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;a class="reference external" href="http://plone.org/join_form?came_from=http%3A//plone.org"&gt;Sign up&lt;/a&gt; for an account on Plone.org to allow you to upload your
product here too.&amp;nbsp; Make sure you follow the URL you get emailed and
change your password.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Edit your ~/.pypirc file to include the following details from &lt;a class="reference external" href="http://plone.org/documentation/tutorial/how-to-upload-your-package-to-plone.org/tutorial-all-pages"&gt;this
page&lt;/a&gt;.&amp;nbsp; My file also needed the &lt;strong&gt;server-login&lt;/strong&gt; section (something
to do with differences between PyPI and Plone.org, I think).:&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="k"&gt;[server-login]&lt;/span&gt;
&lt;span class="err"&gt;username:XXX&lt;/span&gt;
&lt;span class="err"&gt;password:YYY&lt;/span&gt;
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;When ready, you can upload your work to PyPI and Plone.org:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
easy_install-2.4 collective.dist
python2.4 setup.py register sdist bdist_egg upload -s
python2.4 setup.py mregister sdist mupload -r plone.org
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;If everything goes according to plan, then you should see 'Response
200' back from the servers.&amp;nbsp; If not, then check the following:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Your passwords and user names are correct in your &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.pypirc&lt;/span&gt;&lt;/tt&gt; file
(yes, it's true, they're plaintext...)&lt;/li&gt;
&lt;li&gt;Make sure your accounts on both PyPI and Plone.org are active and
actually exist.&lt;/li&gt;
&lt;li&gt;You've followed any further instructions about troubleshooting on
the links I've posted.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Once done, you should be able to see your package on PyPI (and
administrate it once logged in), and see your product on Plone.org.
Keep in mind that Plone.org has an approval process that you'll have
to wait for before your product is fully visible.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</summary><category term="easy_install"></category><category term="open source"></category><category term="plone"></category><category term="product"></category><category term="python"></category><category term="release"></category><category term="Software"></category></entry><entry><title>Virtualenv, Plone, and Centos 5.x</title><link href="http://davidjb.com/blog/2009/07/virtualenv-plone-and-centos-5/" rel="alternate"></link><updated>2009-07-09T13:25:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-07-09:blog/2009/07/virtualenv-plone-and-centos-5/</id><summary type="html">&lt;p&gt;&lt;strong&gt;EDIT:&lt;/strong&gt; Watch out for python-ldap 2.3.10, the latest version at time
of writing. Seems like there's an issue with it and Centos 5.4. Forcing
python-ldap to be version 2.3.8 works, though. (easy_install
python-ldap==2.3.8)&lt;/p&gt;
&lt;p&gt;Previously, you might have read about setting up a Virtualenv on Ubuntu
Jaunty. Now, that was reasonably painless since python-virtualenv and
python-setuptools is in the Ubuntu repo. Whether it's my Centos servers
and their misguided repos or me just not being able to find such a
related rpm packages, Centos just needs little more love to get it to
the same setup. (&lt;strong&gt;Note:&lt;/strong&gt; actually, there was a setuptools RPM that I
installed, but no idea why it didn't give me easy_install...)&lt;/p&gt;
&lt;p&gt;Here's what we're looking at for this time around.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;Install the dependencies and various development libraries needed for
PIL etc:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
yum install gcc gdbm-devel readline-devel ncurses-devel zlib-devel bzip2-devel sqlite-devel db4-devel openssl-devel tk-devel bluez-libs-devel libjpeg-devel zlib-devel freetype-devel
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Install setuptools and virtualenv:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
wget http://pypi.python.org/packages/2.4/s/setuptools/setuptools-0.6c9-py2.4.egg#md5&lt;span class="o"&gt;=&lt;/span&gt;260a2be2e5388d66bdaee06abec6342a
sh setuptools-0.6c9-py2.4.egg
rm -f setuptools-0.6c9-py2.4.egg
easy_install-2.4 -U setuptools
easy_install-2.4 virtualenv
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Create a virtual environment and activate it:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
virtualenv -p /usr/bin/python2.4 .
&lt;span class="nb"&gt;source&lt;/span&gt; ./bin/activate
&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Easy install the dependencies of Plone. Not sure if they're needed
for Centos, but it did all work nicely after doing this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre class="code literal-block"&gt;
easy_install --find-links http://www.pythonware.com/products/pil/ Imaging
easy_install --find-links http://download.zope.org/distribution PILwoTK
easy_install python-ldap
easy_install lxml
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Clear as mud? I thought so. Essentially the only difference is actually
getting the right development libraries and then getting setuptools
itself working correctly. As I mentioned, for whatever reason my
python-setuptools rpm doesn't have easy install. Maybe it's because it's
an old version? Who knows. This is an easy enough workaround.&lt;/p&gt;
</summary><category term="centos"></category><category term="easy_install"></category><category term="plone"></category><category term="python"></category><category term="rpm"></category><category term="virtualenv"></category></entry><entry><title>VLC Has Turned 1!</title><link href="http://davidjb.com/blog/2009/07/vlc-has-turned-1/" rel="alternate"></link><updated>2009-07-08T02:10:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-07-08:blog/2009/07/vlc-has-turned-1/</id><summary type="html">&lt;p&gt;I may well be late to the party and a little late to celebrate, but I've
just made the startling discovery that VLC 1.0.0 has now been released.&lt;/p&gt;
&lt;p&gt;I've been using VLC since (before, actually) I thought there had to more
to playing videos than needing extravagent codec packs like K-lite or
anything similar to be installed on your system.&amp;nbsp; It's been that long
that the first version I used, if I remember correctly, wasn't actually
being specifically used for client-side file playback and was supposed
to be geared towards video streaming over a network.&amp;nbsp; My memory may well
be wrong on that one, so don't quote me.&lt;/p&gt;
&lt;p&gt;At any rate, VLC has matured in leaps and bounds across the versions,
much to the credit of all the developers working on it.&amp;nbsp; And this
version - above any others so far - is truly marvelous.&amp;nbsp; It's not too
often you see software that does everything you thought you needed - and
things you didn't.&amp;nbsp; I'll space you the mumbo-jumbo here, but if you
haven't seen it already, the change log is &lt;a class="reference external" href="https://trac.videolan.org/vlc/browser/NEWS"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The features/updates I'd been waiting for were:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Fixing up DivX/XviD playback - and stopping me having to play/pause
cycle a video to get it to play.&lt;/li&gt;
&lt;li&gt;Global hotkeys - finally!&amp;nbsp; No more messing with GhostScript to get
VLC to play if it's not in focus&lt;/li&gt;
&lt;li&gt;Remembering past files and the location in the Open File dialog&lt;/li&gt;
&lt;li&gt;Frame-by-frame playback - for finding those random stills in videos&lt;/li&gt;
&lt;li&gt;Compressed file playback - seems like RAR files playback (and
apparently Zip too)&lt;/li&gt;
&lt;li&gt;Live recording - slicing out bits of videos with a single click&lt;/li&gt;
&lt;li&gt;DVB playback for TV - looks good, haven't tested it yet though&lt;/li&gt;
&lt;li&gt;Adjustable toolbars - yay!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The list goes on..but it ticks all the boxes.&lt;/p&gt;
&lt;p&gt;Happy first birthday VLC; here's to version 2 and onwards.&lt;/p&gt;
</summary><category term="features"></category><category term="Software"></category><category term="update"></category><category term="video"></category><category term="vlc"></category></entry><entry><title>Find and replace across files - Linux command line</title><link href="http://davidjb.com/blog/2009/07/find-and-replace-across-files-linux-command-line/" rel="alternate"></link><updated>2009-07-06T11:21:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-07-06:blog/2009/07/find-and-replace-across-files-linux-command-line/</id><summary type="html">&lt;p&gt;Today's interesting post concerns finding and replacing terms across
multiple files via a simple command.&amp;nbsp; Thanks to &lt;a class="reference external" href="http://www.64bitjungle.com/ubuntu/recursively-search-and-replace-terms-in-multiple-files-with-grep-xargs-and-sed/"&gt;this great blog post&lt;/a&gt;,
it all comes down to one single line.&amp;nbsp; I had found a previously-useful
line of code, but the problem with that one was the fact that it used
the &lt;strong&gt;find&lt;/strong&gt; command.&amp;nbsp; The problem with that is that if you do a
wildcard search for * in a directory, it'll give you back '.' as a
result.&amp;nbsp; Trying to work with that just wasn't happening.&lt;/p&gt;
&lt;p&gt;So, without further ado, the command (replacing 'search' with your
search term and 'target' with your replacement term'):&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
grep -lr -e &lt;span class="s1"&gt;'search'&lt;/span&gt; * | xargs sed -i &lt;span class="s1"&gt;'s/search/target/g'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Just remember, the first &lt;strong&gt;grep&lt;/strong&gt; command is doing Regex, so escape
anything Regex-y (dots, slashes, etc) or otherwise &amp;quot;prepare for
unforseen consequences&amp;quot; when running &lt;strong&gt;sed&lt;/strong&gt;.&lt;/p&gt;
</summary><category term="command"></category><category term="find"></category><category term="linux"></category><category term="replace"></category><category term="text"></category><category term="useful"></category></entry><entry><title>plone.app.blob and Failed Migrations</title><link href="http://davidjb.com/blog/2009/07/plone-app-blob-and-failed-migrations/" rel="alternate"></link><updated>2009-07-03T12:11:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-07-03:blog/2009/07/plone-app-blob-and-failed-migrations/</id><summary type="html">&lt;p&gt;Another fun-and-games style problem I've come across when using
plone.app.blob: sometimes migrations won't work when converting a
standard site's files over to blobs.&lt;/p&gt;
&lt;p&gt;That's a pretty ambiguious description, but essentially, the error you
might see will have a semi-normal traceback to start, and then garbage
(contents of a file, presumably) - which, depending on the file size
might hurt your browser.&amp;nbsp; The last part of the (normal) traceback reads
thus:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;File &amp;quot;/home/buildout/instance/eggs/plone.app.linkintegrity-1.0.11-py2.4.egg/ plone/app/linkintegrity/handlers.py&amp;quot;, line 158, in referencedObjectRemoved raise LinkIntegrityNotificationException, obj LinkIntegrityNotificationException&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Thankfully, this gives us an excellent pointer to a solution: disable
link integrity checking on your site prior to migrating.&lt;/p&gt;
&lt;div class="section" id="the-fix-workaround"&gt;
&lt;h2&gt;The fix/workaround&lt;/h2&gt;
&lt;p&gt;Head to the Plone Control Panel, and click onto Site.&amp;nbsp; Uncheck &lt;em&gt;Enable
link integrity checks&lt;/em&gt;and then run your blob migration.&amp;nbsp; When you're
done, you can return your site to normal.Or not.&amp;nbsp; Your choice.&amp;nbsp; Doens't
seem like there's any harm with turning it back on once everything's
happy; just something to watch out when migrating content.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="blob"></category><category term="fix"></category><category term="links"></category><category term="plone"></category><category term="problem"></category><category term="traceback"></category></entry><entry><title>User-selectable Themes In Plone</title><link href="http://davidjb.com/blog/2009/06/user-selectable-themes-in-plone/" rel="alternate"></link><updated>2009-06-25T13:10:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-06-25:blog/2009/06/user-selectable-themes-in-plone/</id><summary type="html">&lt;p&gt;It's something I came across a while ago, but wasn't exactly something
that stayed in the fore-front of my mind: how to let users choose or
select a theme (arbitrarily) on a Plone site.&amp;nbsp; Normally, I stick to
having one theme per site for continuity but a new theme-test site for
clients is an exception.&lt;/p&gt;
&lt;p&gt;If you were to search Google for the right terms, you'll find out how to
let this happen, but I ended up having to go hunt it down myself.
Hopefully this entry will help people (if I go and include as many terms
as I think I or someone else might look for!).&lt;/p&gt;
&lt;div class="section" id="how"&gt;
&lt;h2&gt;How&lt;/h2&gt;
&lt;p&gt;Head to the ZMI as an administrative user (/manage), and then to
portal_skins.&amp;nbsp; Under the Properties tab, you'll find a Boolean option
called &amp;quot;Allow arbitrary skins to be selected&amp;quot;.&amp;nbsp; You guessed it; turn to
it on and save.&lt;/p&gt;
&lt;p&gt;Your users now have a drop-down menu in their personal preferences for
changing the theme.&amp;nbsp; Install some additional themes and away you go.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; seems like this feature doesn't work well or I'm not using it
right.&amp;nbsp; Changing the theme for one user changes it for everyone..hmm.
Probably the reason the option's hiding in the ZMI!&lt;/p&gt;
&lt;/div&gt;
</summary><category term="plone"></category><category term="skin"></category><category term="theme"></category><category term="zmi"></category></entry><entry><title>DateTime in Python/Zope/Plone is painful</title><link href="http://davidjb.com/blog/2009/06/datetime-in-pythonzopeplone-is-painful/" rel="alternate"></link><updated>2009-06-19T13:50:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-06-19:blog/2009/06/datetime-in-pythonzopeplone-is-painful/</id><summary type="html">&lt;p&gt;Alright, now for today's problem:&amp;nbsp; why do two dates that look different
when outputted actually end up being the same date?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Answer:&lt;/strong&gt; I'm not sure, but I'm pretty sure it's got something to do
with the wacky support the above-mentioned 3 products have for
timezones.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The background:&lt;/strong&gt; Plone stores a DateTime object to record a user's
last login time.&amp;nbsp; It doesn't really matter what's purpose is, because
Plone (this time) isn't at fault.&amp;nbsp; The DateTime gets stored, no
worries.&amp;nbsp; The problem arises when you try to put that value back into a
DateTime object.&amp;nbsp; Now, I'd have thought it'd be as simple as doing this:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DateTime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;member&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getProperty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'login_time'&lt;/span&gt;&lt;span class="p"&gt;))[&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sourcecode&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;And realistically, it is.&amp;nbsp; Except that printing/using that value - at
least for me - results in a time that appears as UTC, but is reported as
being in my timezone (aka a time that's 10 hours behind since I'm
GMT+10).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The fix:&lt;/strong&gt; the time still knows its timezone correctly, so just give
it a kick:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DateTime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;member&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getProperty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'login_time'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toZone&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Amazingly, doing a comparison (using cmp) between the original DateTime
object and it's 'corrected' version actually shows that they're the
same.&amp;nbsp; Uhuh.&lt;/p&gt;
</summary><category term="comparison"></category><category term="date"></category><category term="plone"></category><category term="problem"></category><category term="python"></category><category term="time"></category><category term="zope"></category></entry><entry><title>Webpage content underneath Flash content</title><link href="http://davidjb.com/blog/2009/06/webpage-content-underneath-flash-content/" rel="alternate"></link><updated>2009-06-12T13:33:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-06-12:blog/2009/06/webpage-content-underneath-flash-content/</id><summary type="html">&lt;p&gt;So, you've got a website that you've made and you've used a Flash movie
on it.&amp;nbsp; Okay, no worries.&amp;nbsp; Now, what if you tried to add a
(non-form-element) drop-down menu or some AJAX-ed content into the site,
and found the Flash movie actually acted as an overlay?&lt;/p&gt;
&lt;p&gt;This problem doesn't seem consistent.&amp;nbsp; Different OSs, browsers, and
Flash versions don't indicate consistency - that's what I've seen
anyway.&amp;nbsp; Nevertheless, the problem persists for some users and it's
down-right annoying.&lt;/p&gt;
&lt;p&gt;The fix?&amp;nbsp; Make your Flash code look similar to this:&lt;/p&gt;
&lt;pre class="code html literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;object&lt;/span&gt; &lt;span class="na"&gt;data=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;my-movie.swf&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;application/x-shockwave-flash&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;200&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;param&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;movie&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;my-movie.swf&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;param&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;quality&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;high&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;param&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;embed&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;transparent&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;param&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;wmode&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;transparent&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;param&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;menu&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;false&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;alternate.jpg&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;alt=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;ARCS - Revolutionising Collaboration&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;200&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/object&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;That there should be entirely XHTML compliant (and completely
cross-browser compatible) code for creating a Flash object on your page
that'll place nice with other content.&lt;/p&gt;
</summary><category term="content"></category><category term="flash"></category><category term="html"></category><category term="problem"></category><category term="web"></category><category term="xhtml"></category></entry><entry><title>Virtualenv, Plone, and Ubuntu 9.04 Jaunty</title><link href="http://davidjb.com/blog/2009/06/virtualenv-plone-and-ubuntu-904-jaunty/" rel="alternate"></link><updated>2009-06-12T12:35:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-06-12:blog/2009/06/virtualenv-plone-and-ubuntu-904-jaunty/</id><summary type="html">&lt;p&gt;What a complicated situation it is trying to use all of the
above-mentioned pieces of software together. In all seriousness,
Virtualenv is now appearing to be the best thing since sliced bread for
me to help out with making Plone/Zope usable under Jaunty.&lt;/p&gt;
&lt;p&gt;By default, as everyone should know by now, a whole bunch of old Python
2.4 packages got removed from Jaunty, throwing us Plone developers into
peril.&amp;nbsp; Well, those of us who hadn't discovered the joys of virtualenv
yet, that is.&lt;/p&gt;
&lt;p&gt;Here's how to convert an existing buildout folder over to Virtualenv
without too much hassle:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get install python-virtualenv
virtualenv -p /usr/bin/python2.4 .
&lt;span class="nb"&gt;source&lt;/span&gt; ./bin/activate
easy_install ipython
easy_install --find-links http://www.pythonware.com/products/pil/ Imaging
easy_install --find-links http://download.zope.org/distribution PILwoTK
easy_install python-ldap
./bin/buildout
&lt;/pre&gt;
&lt;p&gt;And that should handle the issues of, in order of command: installing
virtualenv, setting up our current folder, activating virtualenv,
installing useful/necessary python packages, and reworking everything
via buildout.&lt;/p&gt;
&lt;p&gt;The instance of Plone/Zope can be started up with/without
`&lt;strong&gt;activate&lt;/strong&gt;` being `&lt;strong&gt;source&lt;/strong&gt;`'d, as virtualenv has now
got its own local python interpreter here.&lt;/p&gt;
&lt;p&gt;Cheers to Athena Geek &amp;#64;
&lt;a class="reference external" href="http://athenageek.wordpress.com/2009/05/22/virtualenv-in-plone/"&gt;http://athenageek.wordpress.com/2009/05/22/virtualenv-in-plone/&lt;/a&gt; for the
details to get me started.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;EDIT:&lt;/strong&gt; You might need to install some of the following packages to
make all the imaging (and rest of Plone) be happy:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
sudo apt-get install python2.4-dev libtk-img-dev libfreeimage-dev libjpeg62-dev libfreetype6-dev libtk-img-dev tcl8.5-dev tk8.5-dev lynx poppler-utils xpdf wv xlhtml ppthtml
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;EDIT2:&lt;/strong&gt; If you get weird messages about &amp;quot;Undefined symbol:
PyUnicodeUCS2_*&amp;quot; then you should probably wipe your virtualenv clean
and go again. Essentially, dump your lib, include, and content of your
eggs folder, and re-do your virtualenv. If pain persists, see your
Google.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;EDIT3:&lt;/strong&gt; This also works on Karmic (9.10)! :)&lt;/p&gt;
</summary><category term="9.04"></category><category term="9.10"></category><category term="jaunty"></category><category term="karmic"></category><category term="linux"></category><category term="plone"></category><category term="python"></category><category term="ubuntu"></category><category term="virtualenv"></category><category term="zope"></category></entry><entry><title>Unix: Removing Open Logical Volumes in Centos/RHL</title><link href="http://davidjb.com/blog/2009/05/unix-removing-open-logical-volumes-in-centosrhl/" rel="alternate"></link><updated>2009-05-13T09:19:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-05-13:blog/2009/05/unix-removing-open-logical-volumes-in-centosrhl/</id><summary type="html">&lt;p&gt;Because I still haven't remembered to set myself up with a
limited-access account for blogging on my new site, I'm back here again.
(EDIT: Migrated from old site)&lt;/p&gt;
&lt;p&gt;This time is a lot of fun and games with removing an &amp;quot;open&amp;quot; logical
volume from within a CentOS environment. The dom0 machine has a set of
logical volumes in a volume group for each of the VMs and one of them
went and failed dismally, and after its xen destruction (xm destory foo)
its LV was left with it being &amp;quot;open&amp;quot;.&lt;/p&gt;
&lt;p&gt;It's not exactly easy to see how/why this would be the case and every
command (lsof, fuser, mount, etc) told me that the LV wasn't in use. But
still, lvremove, lvchange, and dmsetup commands failed.&lt;/p&gt;
&lt;p&gt;But, I've solved my problem! Hopefully yours too.. read on through the
commands:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
&lt;span class="c"&gt;# lvchange -an /dev/vmsvg1/foo
&lt;/span&gt;LV vmsvg1/foo in use: not deactivating
&lt;span class="c"&gt;# dmsetup info -c vmsvg1-foo
&lt;/span&gt;Name             Maj Min Stat Open Targ Event  UUID
vmsvg1-foo    253  65 L--w    1    1      2  XXX
&lt;span class="c"&gt;# dmsetup remove -force vmsvg1-foo
&lt;/span&gt;device-mapper: remove ioctl failed: Device or resource busy
&lt;span class="c"&gt;# lvchange -an /dev/vmsvg1/foo
&lt;/span&gt;/dev/vmsvg1/foo: &lt;span class="nb"&gt;read &lt;/span&gt;failed after 0 of 4096 at 0: Input/output error
/dev/mapper/vmsvg1-foop1: &lt;span class="nb"&gt;read &lt;/span&gt;failed after 0 of 2048 at 0: Input/output error
&lt;span class="c"&gt;# dmsetup remove -force vmsvg1-foop1
# dmsetup remove -force vmsvg1-foo
# lvs vmsvg1
&lt;/span&gt;foo    vmsvg1 -wi---   4.00G   &lt;span class="o"&gt;(&lt;/span&gt;it&lt;span class="err"&gt;'&lt;/span&gt;s closed!!&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="c"&gt;# lvchange -an /dev/vmsvg1/foo
# lvremove /dev/vmsvg1/foo
&lt;/span&gt;Logical volume &lt;span class="s2"&gt;&amp;quot;foo&amp;quot;&lt;/span&gt; successfully removed
&lt;/pre&gt;
&lt;p&gt;So, after all that, it looks like there's some stupid 'p1' references in
/dev/mapper/ . Nfi why, but removing it (albeit by force with dmsetup)
solved the problem.&lt;/p&gt;
</summary><category term="centos"></category><category term="close"></category><category term="logical"></category><category term="red hat"></category><category term="remove"></category><category term="unix"></category><category term="volume"></category></entry><entry><title>Plone: Issues with products</title><link href="http://davidjb.com/blog/2009/04/plone-issues-with-products/" rel="alternate"></link><updated>2009-04-23T09:15:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-04-23:blog/2009/04/plone-issues-with-products/</id><summary type="html">&lt;p&gt;Oh dear. Products in Plone that don't care to uninstall themselves at
all when removed. One such product that comes to mind is
ZipFileTransport.&lt;/p&gt;
&lt;p&gt;I could go into depth all day about its failure to uninstall, but in
specific, it's this line of code in its setupHandlers.py file that kills
me:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;registerUtility&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ZipFileTransportUtility&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'zipfiletransport'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;IZipFileTransportUtility&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Now, where's the unregisterUtility called? Nowhere, unfortunately. So
when one tries to go and install/uninstall/reinstall/do certain things
on the site, you get a nasty failure message about trying to unpickle a
python object:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;2009-04-23 10:19:19 ERROR Zope.SiteErrorLog http://localhost:8080/eresearch/portal_quickinstaller/uninstallProductsTraceback (innermost last):
Module ZPublisher.Publish, line 125, in publish
Module Zope2.App.startup, line 238, in commit
Module transaction._manager, line 96, in commit
Module transaction._transaction, line 395, in commit
Module transaction._transaction, line 495, in _commitResources
Module ZODB.Connection, line 510, in commit
Module ZODB.Connection, line 555, in _commit
Module ZODB.Connection, line 582, in _store_objects
Module ZODB.serialize, line 407, in serialize
Module ZODB.serialize, line 416, in _dump
PicklingError: Can't pickle: import of module Products.ZipFileTransport.utilities.interfaces failed&lt;/span&gt;
&lt;/pre&gt;
&lt;div class="section" id="solution"&gt;
&lt;h2&gt;Solution?&lt;/h2&gt;
&lt;p&gt;Okay, I found the unregisterUtility function in zope.component, and it
can be accessed by something like this (ipython session, of course):
(You'll need at least the ZFT parts below present to import them).&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;zope.app.component.hooks&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;setSite&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;zope.component&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;getSiteManager&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;Products.ZipFileTransport.utilities.interfaces&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;IZipFileTransportUtility&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;Products.ZipFileTransport.utilities.utils&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ZipFileTransportUtility&lt;/span&gt;
&lt;span class="n"&gt;setSite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;portal&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;getSiteManager&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unregisterUtility&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;provided&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;IZipFileTransportUtility&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;#Even though unregister happened, it probably said it worked but left crap around.&lt;/span&gt;
&lt;span class="c"&gt;#Let's clean it up&lt;/span&gt;

&lt;span class="c"&gt;#This intclass variable might not be right.  It's going to be the key present below,&lt;/span&gt;
&lt;span class="c"&gt;#so you can always find the right InterfaceClass manually and set it accordingly.&lt;/span&gt;
&lt;span class="n"&gt;intclass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IZipFileTransportUtility&lt;/span&gt;
&lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_adapters&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;intclass&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_subscribers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;intclass&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c"&gt;#From here, search for 'Zip' to see if it's gone&lt;/span&gt;
&lt;span class="c"&gt;#Each should return -1.  If not, you've done something wrong!&lt;/span&gt;
&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_adapters&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Zip'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_subscribers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Zip'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utilities&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__bases__&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__dict__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Zip'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;And thus ends the tyranny of ZipFileTransport.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt; I should make it clear that to run the above commands you need
to have a handle to your Plone site object, and be pre-set as the
'portal' variable. If you set up ipython like so:
&lt;a class="reference external" href="http://plone.org/documentation/kb/setup-ipython-for-zope"&gt;http://plone.org/documentation/kb/setup-ipython-for-zope&lt;/a&gt; then that takes
care of things automatically and gives you interactive handles to your
portal and Zope app root. If you're not using this, then figure out how
to set 'portal' manually to be your Plone site object (not a string or
name, but the actual object) and run the rest of the lines of code.&lt;/p&gt;
&lt;p&gt;Also, I'm not sure whether you need to commit your changes or not. If
you find the changes don't stick, then try this in your ipython session:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;transaction&lt;/span&gt;
&lt;span class="n"&gt;transaction&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
</summary><category term="plone"></category><category term="problem"></category><category term="products"></category><category term="zip"></category></entry><entry><title>Plone: Clamping down on categories</title><link href="http://davidjb.com/blog/2009/04/plone-clamping-down-on-categories/" rel="alternate"></link><updated>2009-04-21T09:11:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-04-21:blog/2009/04/plone-clamping-down-on-categories/</id><summary type="html">&lt;p&gt;Probably my last blog entry here because I'll be moving to the AWESOME
WordPress very soon &amp;#64; &lt;a class="reference external" href="http://davidjb.com/blog"&gt;http://davidjb.com/blog&lt;/a&gt; (with a nice new site design,
too)&amp;nbsp; (EDIT: Migrated from my old blog 8-) ) .  (&lt;strong&gt;2013 edit&lt;/strong&gt;: Goodbye
Wordpress, I really hate PHP and its security issues. I'm a Python developer
and I really should be eating my own dogfood).&lt;/p&gt;
&lt;p&gt;Anyway, how to prevent the addition of new categories to the Plone
listing (the inline comments aren't mine, they're copied):&lt;/p&gt;
&lt;blockquote&gt;
It's a bit hidden and probably undocumented but here we go: ZMI -&amp;gt;
portal_metadata -&amp;gt; schema tab (should be the default view of the
tool in ZMI) -&amp;gt; click DCMI in the Metadata Schemas section (why do
so many people not know that the plural form of 'schema' is
'schemata' - but I digress …) -&amp;gt; click 'Subject' within the
'Element' row -&amp;gt; add terms to the vocabulary field - in the upper
part if this should apply to all portal types (don't forget to press
'Update') or in the lower part to define a portal type specific
policy.&lt;/blockquote&gt;
&lt;p&gt;Something that wasn't mentioned was the 'Enforce vocabulary?' box. If
you go and tick that, and save the changes, then any additional
categories that someone adds are only localised to that one content item
- they're not entered into the overall listing. Doesn't stop someone who
misses a category from entering a new one locally, but it's a good
start.&lt;/p&gt;
</summary><category term="categories"></category><category term="enforce"></category><category term="plone"></category></entry><entry><title>My new site</title><link href="http://davidjb.com/blog/2009/04/my-new-site/" rel="alternate"></link><updated>2009-04-15T10:40:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-04-15:blog/2009/04/my-new-site/</id><summary type="html">&lt;p&gt;Welcome to my new website and in particular, my new blog. My aim is to
use this site now and slowly (but surely!) move away from the old haunts
of Wikidot. It's especially intelligent considering that I'm actually
paying for webspace on a yearly basis (albeit not much money) but I
figure I should be using it all the same.&lt;/p&gt;
&lt;p&gt;So, without further ado - I declare my new site open for business. Much
like Queensland Transport and the local city council around here, the
road is under construction. So, please don't blame me (to my face ;) )
for any potholes you might hit.&amp;nbsp; It's a work in progress, so bear with
me!&lt;/p&gt;
&lt;p&gt;Lots of fun, games, pain, and Plone are to come.&amp;nbsp; Seems almost ironic
I'm using WordPress as my CMS whilst I spout the joys (et cetera) of
Plone all the time.&amp;nbsp; For all those people who are curious (oh, there's
plenty I'm sure...): my shared webhost here doesn't offer Python, and
I'm not paying for a dedicated server.&amp;nbsp; Short and simple; it's about the
money (when is it not).&lt;/p&gt;
&lt;p&gt;So, stay tuned!&lt;/p&gt;
</summary><category term="cms"></category><category term="life"></category><category term="plone"></category><category term="website"></category></entry><entry><title>Plone: Plone4Artists Video - Can't Edit Videos</title><link href="http://davidjb.com/blog/2009/02/plone-plone4artists-video-cant-edit-videos/" rel="alternate"></link><updated>2009-02-25T09:01:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-02-25:blog/2009/02/plone-plone4artists-video-cant-edit-videos/</id><summary type="html">&lt;p&gt;Wow..I just keep hitting these problems. The latest issue is chronicled
here: &lt;a class="reference external" href="http://dev.plone4artists.org/pm/p/plone4artists/ticket/160"&gt;http://dev.plone4artists.org/pm/p/plone4artists/ticket/160&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;which essentially boils down to this problem when you try and edit a
video subtyped File from p4a.plonevideo (or p4a.video or whatever it's
called now):&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;Traceback (innermost last):
* Module ZPublisher.Publish, line 119, in publish
* Module ZPublisher.mapply, line 88, in mapply
* Module ZPublisher.Publish, line 42, in call_object
* Module zope.formlib.form, line 769, in __call__
* Module p4a.video.browser.video, line 362, in update
* Module Products.Five.formlib.formbase, line 55, in update
* Module zope.formlib.form, line 732, in update
* Module p4a.video.browser.video, line 367, in setUpWidgets
* Module zope.formlib.form, line 393, in setUpEditWidgets
* Module zope.formlib.form, line 323, in _createWidget
* Module zope.component._api, line 103, in getMultiAdapter
ComponentLookupError: ((&amp;lt;p4a .fileimage.file._field.FileField object at 0x15ce2610&amp;gt;, &amp;lt;httprequest , URL=[snip].mp4/atct_edit&amp;gt;), &amp;lt;interfaceclass zope.app.form.interfaces.IInputWidget&amp;gt;, u'')&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;And so, after much painful searching and confusion, it's just simply an
issue of including &lt;tt class="docutils literal"&gt;p4a.fileimage&lt;/tt&gt; in the ZCML section of your
instance in your buildout.&lt;/p&gt;
&lt;p&gt;Wow..back to work (finally).&lt;/p&gt;
</summary><category term="p4a"></category><category term="plone"></category><category term="plone4artists"></category><category term="problem"></category><category term="subtyped"></category><category term="video"></category></entry><entry><title>Buildout: Best Thing Ever?</title><link href="http://davidjb.com/blog/2009/02/buildout-best-thing-ever/" rel="alternate"></link><updated>2009-02-20T08:58:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-02-20:blog/2009/02/buildout-best-thing-ever/</id><summary type="html">&lt;p&gt;Taking a little bit of a time-out, I just have to ask the question: is
Buildout not the best thing ever? (and the people who are so very kind
to make the recipes?)&lt;/p&gt;
&lt;p&gt;It's made my work of managing our Plone infrastructure about 1000 times
simpler since moving from Instancemanager (ughhh) and having to manually
manage everything. I remember being a bit sceptical and very confused
the first time I saw a buildout configuration file and thought that I'd
never understand the thing.&lt;/p&gt;
&lt;p&gt;Far, far from it of course! Whilst a little daunting at first, buildout
has (in some/all metaphorical senses) won my heart. It couldn't be
easier to use, contrary to my initial (dis)beliefs.&lt;/p&gt;
&lt;p&gt;Today sees me convert our archaic design of manually managing our
Varnish RPMs and setup and changing it to buildout instead. Looks like
the geniuses (and there's no sarcasm here!) have made it perfectly - it
does exactly what I need it to and makes my job so much simpler.&lt;/p&gt;
</summary><category term="best thing"></category><category term="buildout"></category><category term="excellent"></category></entry><entry><title>Plone: Google Calendar Integration</title><link href="http://davidjb.com/blog/2009/02/plone-google-calendar-integration/" rel="alternate"></link><updated>2009-02-19T08:55:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-02-19:blog/2009/02/plone-google-calendar-integration/</id><summary type="html">&lt;p&gt;Wouldn't it be great if you could somehow add your Event content item
within the Plone CMS onto your Google Calendar with just a click? (it'd
be better with fewer, but 1 click is pretty good - give me a break!)&lt;/p&gt;
&lt;p&gt;Try this placed inside the &lt;tt class="docutils literal"&gt;event_view&lt;/tt&gt; page template (customise it in
the ZMI) after the vCal and iCal links:&lt;/p&gt;
&lt;pre class="code html literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;#&amp;quot;&lt;/span&gt;
&lt;span class="na"&gt;tal:attributes=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;href python:'http://www.google.com/calendar/event?action=TEMPLATE'
+'&amp;amp;text='+here.title
+'&amp;amp;dates='+here.start().toZone('UTC').ISO8601().replace('-','').replace(':','').split('+')[0]+'Z/'
+here.end().toZone('UTC').ISO8601().replace('-','').replace(':','').split('+')[0]+'Z'
+'&amp;amp;location='+here.location
+'&amp;amp;details='+here.getRawDescription()+'&amp;lt;br /&amp;gt;'+here.getRawText()
+'&amp;amp;trp=true'
+'&amp;amp;sprop=website:'+here.event_url()
+'&amp;amp;sprop=name:'+here.contact_name();&amp;quot;&lt;/span&gt;
&lt;span class="na"&gt;title=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Add this event to Google Calendar&amp;quot;&lt;/span&gt;
&lt;span class="na"&gt;target=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;_blank&amp;quot;&lt;/span&gt;
&lt;span class="na"&gt;style=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;background-image: none; padding: 0px;&amp;quot;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://www.google.com/calendar/images/ext/gc_button1.gif&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;alt=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Add to Google Calendar&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;50&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;13&amp;quot;&lt;/span&gt;  &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;So, it's clear as mud, right? It does some magic and completes a link
for you to use to add your given event and it's details into Google
Calendar from Plone.&lt;/p&gt;
&lt;p&gt;For those of you really paying attention, the date conversion is nasty
(why doesn't Google accept an immediately accessible format?) and this
&lt;em&gt;won't&lt;/em&gt; work unless all fields are filled out. I'm still working on a
field-friendly solution.&lt;/p&gt;
&lt;p&gt;Either way, I didn't find anything on the web about doing this, so here
it is. Use as you will.&lt;/p&gt;
</summary><category term="add to"></category><category term="calendar"></category><category term="event"></category><category term="google"></category><category term="integration"></category><category term="plone"></category></entry><entry><title>Buildout: Trying to create a Plone/Zope instance</title><link href="http://davidjb.com/blog/2009/02/buildout-trying-to-create-a-plonezope-instance/" rel="alternate"></link><updated>2009-02-11T08:51:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-02-11:blog/2009/02/buildout-trying-to-create-a-plonezope-instance/</id><summary type="html">&lt;p&gt;Eeek...what's this mean?&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;install() got an unexpected keyword argument 'allow_hosts'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;after trying to build zope2zeoserver from my buildout configuration.&lt;/p&gt;
&lt;p&gt;After some searching, I found that it was due to my bootstrap.py script
(the one the gets buildout in the first place and creates the relevant
scripts) was actually pulling down an outdated version of zc.buildout.
So, the problem results because this old version of buildout doesn't
have a clue how to handle the given argument.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt; update the buildout. For me, that meant correcting the
bootstrap script, but for you, it could be a matter of using
easy_install to take care of that for you.&lt;/p&gt;
</summary><category term="bootstrap"></category><category term="buildout"></category><category term="error"></category><category term="plone"></category><category term="script"></category><category term="zope"></category></entry><entry><title>Buildout: Trying to build Pound</title><link href="http://davidjb.com/blog/2009/02/buildout-trying-to-build-pound/" rel="alternate"></link><updated>2009-02-11T08:49:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-02-11:blog/2009/02/buildout-trying-to-build-pound/</id><summary type="html">&lt;p&gt;So, trying to build &lt;tt class="docutils literal"&gt;pound&lt;/tt&gt; through a Buildout recipe was failing part of
the way through.&lt;/p&gt;
&lt;p&gt;Two problems and their solutions (not necessarily in that order):&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Needed to install &lt;strong&gt;libssl-dev&lt;/strong&gt; because &lt;strong&gt;lcrypto&lt;/strong&gt; was missing
(ambiguity anyone?) - Synaptic says that the package provides &amp;quot;libssl
and libcrypto development libraries, header files and manpages&amp;quot; (but
never mind a search for `libcrypto`…)&lt;/li&gt;
&lt;li&gt;Had to correct the relevant user that the recipe was telling pound to
build as.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first point was pretty silly and the second one was just clearly my
copy-and-paste mistake.&lt;/p&gt;
</summary><category term="buildout"></category><category term="pound"></category><category term="recipe"></category></entry><entry><title>Ubuntu: Dual Monitors &amp; Separating Tasks</title><link href="http://davidjb.com/blog/2009/02/ubuntu-dual-monitors-separating-tasks/" rel="alternate"></link><updated>2009-02-04T08:48:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-02-04:blog/2009/02/ubuntu-dual-monitors-separating-tasks/</id><summary type="html">&lt;p&gt;Today's puzzle: how to get Ubuntu (specifically GNOME Panels as it turns
out) to use my new dual-monitor setup and show only the tasks from one
monitor on that monitor's panel. Sure, people had mentioned that it was
possible (everywhere) but noone actually seemed to take the time to
mention how. That's when I found this:
&lt;a class="reference external" href="http://www.lloydleung.com/2006/10/14/gnome-multiple-monitor-taskbar-window-listing/"&gt;http://www.lloydleung.com/2006/10/14/gnome-multiple-monitor-taskbar-window-listing/&lt;/a&gt;
so cheers go to Lloyd there. Still works (and should be fine on any
version from at least now on):&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Right click on anywhere on the launchbar, click “New Panel”&lt;/li&gt;
&lt;li&gt;Drag that to any monitor.&lt;/li&gt;
&lt;li&gt;Right click on that panel, and click “Add to Panel”&lt;/li&gt;
&lt;li&gt;Select “Window List” under Desktop and Windows&lt;/li&gt;
&lt;li&gt;Click Add.&lt;/li&gt;
&lt;li&gt;Click Close, and you’re done.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Alright!&lt;/p&gt;
</summary><category term="dual"></category><category term="graphics"></category><category term="linux"></category><category term="monitors"></category><category term="panel"></category><category term="ubuntu"></category></entry><entry><title>Plone: URL Encoding In A Script</title><link href="http://davidjb.com/blog/2009/01/plone-url-encoding-in-a-script/" rel="alternate"></link><updated>2009-01-30T08:46:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-30:blog/2009/01/plone-url-encoding-in-a-script/</id><summary type="html">&lt;p&gt;So, for today's problem, how can we get a URL (specifically the GET
request arguments) suitably encoded? Easy, if we're talking about a
Python script that lives on the file system and can be used within
Zope/Plone that way. But what about some sort of Python script that has
to exist on the Plone site (specifically, creating a PloneFormGen (PFG)
Custom Adapter)?&lt;/p&gt;
&lt;p&gt;First thing I jumped to is urllib and urlecode: but no luck because
you're unauthorised to import the library in your script. Boo!&lt;/p&gt;
&lt;p&gt;After much poking, and Googling for something that I thought should be
simple, I found this:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;Products.PythonScripts.standard&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;url_quote_plus&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Does exactly what it says and what it should, and no security issues.
There's also &lt;tt class="docutils literal"&gt;url_quote&lt;/tt&gt; which produces &lt;tt class="docutils literal"&gt;%20&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;+&lt;/tt&gt;.&lt;/p&gt;
</summary><category term="adapter"></category><category term="form"></category><category term="plone"></category><category term="ploneformgen"></category><category term="python"></category><category term="quote"></category><category term="url"></category></entry><entry><title>Linux: Graphics Card Woes &amp; BIOS Issues</title><link href="http://davidjb.com/blog/2009/01/linux-graphics-card-woes-bios-issues/" rel="alternate"></link><updated>2009-01-27T08:44:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-27:blog/2009/01/linux-graphics-card-woes-bios-issues/</id><summary type="html">&lt;p&gt;…and I had thought that installing a graphics card in a computer was as
easy as opening the case, inserting the card, and booting the machine
(then Xorg config etc). Well, to tell the truth, I just moved my HDD,
peripherals (gfx card included) to a new box - now a Dell OptiPlex 755.
But, it's not that easy if you can't boot your Ubuntu 8.10 OS!&lt;/p&gt;
&lt;p&gt;The computer kept spitting this message out, even though it just worked
a few days ago:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
15.848000 NVRM: This PCI I/O region assigned to your NVIDIA device is invalid:
15.848000 NVRM: BAR1 is 0M &amp;#64; 0x00000000 (PCI:0001:00.0)
15.848000 NVRM: The system BIOS may have misconfigured your graphics card.
15.848000 NVRM: The NVIDIA probe routine failed for 1 device(s)
15.848000 NVRM: None of the NVIDIA graphics adapters were initialized!
15.848000 NVRM: This PCI I/O region assigned to your NVIDIA device is invalid:
&lt;/pre&gt;
&lt;p&gt;After much pain, I managed to get into the computer and have the network
loaded up (yay). Some hours of searching, I'd stumbled onto Dell's
Official solution to driver updates (biosdisk); no luck because the boot
disk wouldn't load the EXE. Tried the official method from Ubuntu's
wiki; no luck since my BIOS couldn't be found in the package repo.&lt;/p&gt;
&lt;p&gt;Final ditch effort to do it manually led me to this:
&lt;a class="reference external" href="http://bigbrovar.wordpress.com/2008/12/07/upgrade-downgrade-your-dell-bios-on-ubuntu/"&gt;http://bigbrovar.wordpress.com/2008/12/07/upgrade-downgrade-your-dell-bios-on-ubuntu/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;And, it works! Turns out on my system I didn't even need to edit the
/boot/grub/menu.lst file (BIOS just updates itself upon reboot).&lt;/p&gt;
&lt;p&gt;And then, like magic, everything's fine. My whole system is back working
again after just that one (major) fix.&lt;/p&gt;
&lt;p&gt;Back to work for me…&lt;/p&gt;
</summary><category term="bios"></category><category term="driver"></category><category term="graphics"></category><category term="linux"></category><category term="problem"></category><category term="ubuntu"></category></entry><entry><title>Plone: Correcting Page Template Errors Easily</title><link href="http://davidjb.com/blog/2009/01/plone-correcting-page-template-errors-easily/" rel="alternate"></link><updated>2009-01-22T08:43:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-22:blog/2009/01/plone-correcting-page-template-errors-easily/</id><summary type="html">&lt;p&gt;Here's how to correct pesky problems in your code/XHTML since the line
number and column references are slightly useless in the ZMI.&lt;/p&gt;
&lt;p&gt;Paste contents from a page or page template from the ZMI into a program
like gedit and then the line and column reference numbers will be
correct (once you remove the comment about the error from the top of the
page).&lt;/p&gt;
&lt;p&gt;Editing in the ZMI is a bit painful, but we persevere.&lt;/p&gt;
</summary><category term="code"></category><category term="editing"></category><category term="page"></category><category term="plone"></category><category term="python"></category><category term="template"></category><category term="zmi"></category></entry><entry><title>Plone: Varnish Configuration (Cache Hits, Purge Fails)</title><link href="http://davidjb.com/blog/2009/01/plone-varnish-configuration-cache-hits-purge-fails/" rel="alternate"></link><updated>2009-01-21T08:40:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-21:blog/2009/01/plone-varnish-configuration-cache-hits-purge-fails/</id><summary type="html">&lt;p&gt;What a painful, painful day. It's taken about the entire day, but I've
finally figured out why our Varnish configuration around here for
Plone/Zope hasn't been accepting PURGE requests. Thus, without accepting
purge requests correctly, any content that gets changed in Plone doesn't
get updated in the cache until it times out (or we restart it). Ouch -
especially because it affects all sites under virtual hosting, and a lot
of these sites have publicly visible content that needs to be available
immediately.&lt;/p&gt;
&lt;p&gt;So, the problem manifested itself as thus:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Cache hits happen&lt;/li&gt;
&lt;li&gt;Performance was good on the Plone sites&lt;/li&gt;
&lt;li&gt;PURGE requests sent to Varnish would produce 404's&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, after checking (many times) the object path for the PURGE was right,
Varnish would return a MISS and produce a 404 (DEBUG &amp;quot;VCL_error(404,
Not in cache)&amp;quot; as the Varnish message).&lt;/p&gt;
&lt;p&gt;Much searching/etc later, I found that using:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
curl -X PURGE http://localhost:8000/object/path
&lt;/pre&gt;
&lt;p&gt;straight on the machine running Varnish would work and give a &lt;em&gt;200 Purged
response&lt;/em&gt;. But, running the same command (replacing localhost with a FQDN) from
the Zope machine produced the 404. So, essentially, Varnish knows where to look
for the first command but not for the second.&lt;/p&gt;
&lt;div class="section" id="solution"&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;Where you set the backend for your Plone/Zope in the Varnish
configuration, add set req.http.host accordingly:&lt;/p&gt;
&lt;pre class="code cpp literal-block"&gt;
&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="n"&gt;elseif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;^/VirtualHostBase/https?/my.plone.site.com:(80\|443)/plone/VirtualHostRoot&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;zope1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;my.plone.site.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;...&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;In short, the URL is processed from Apache (in my situation) to result
in the &lt;em&gt;req.url&lt;/em&gt;, and then Varnish needs to know what host anything
being cached relates to. Without it, hello 404 heaven.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="cache"></category><category term="plone"></category><category term="problem"></category><category term="purge"></category><category term="varnish"></category></entry><entry><title>Plone: Re-ordering Folder Contents</title><link href="http://davidjb.com/blog/2009/01/plone-re-ordering-folder-contents/" rel="alternate"></link><updated>2009-01-19T16:42:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-19:blog/2009/01/plone-re-ordering-folder-contents/</id><summary type="html">&lt;p&gt;Ahhh, a new work week.&lt;/p&gt;
&lt;p&gt;The first perplexing puzzle for the week was a seemingly silly idea (it
still is) in Plone where it allows you to view the contents of a given
folder in batches of 20. Now, combine this concept (which is good) with
a concept of being able to re-order items within the folder (which is
good too), you end up with not being able to move items between
'batches'.&lt;/p&gt;
&lt;p&gt;Troublesome. There's nothing obvious that you can do aside from
disabling your browser's JavaScript and using the manual buttons. Nope:
not feasible.&lt;/p&gt;
&lt;p&gt;Try making your folder view &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/folder_contents?show_all=true&lt;/span&gt;&lt;/tt&gt;. Batching
is disabled temporarily for the change to be made.&lt;/p&gt;
&lt;p&gt;Apparently that's a legitimate fix for a significant problem. Not
terribly elegant, but I'm struggling to think of a better solution.&lt;/p&gt;
</summary><category term="batch"></category><category term="folder contents"></category><category term="forms"></category><category term="help"></category><category term="javascript"></category><category term="plone"></category></entry><entry><title>Plone How-To: XHTML Compliant Flash Insertion</title><link href="http://davidjb.com/blog/2009/01/plone-how-to-xhtml-compliant-flash-insertion/" rel="alternate"></link><updated>2009-01-13T16:40:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-13:blog/2009/01/plone-how-to-xhtml-compliant-flash-insertion/</id><summary type="html">&lt;p&gt;Wow, it seems easy doesn't it. Just add an object tag, params, and embed
and we're done, right? Well, sure, if we didn't want to adhere to W3C
standards.&lt;/p&gt;
&lt;p&gt;To do the right thing, we need something like this:&lt;/p&gt;
&lt;pre class="code html literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;object&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;application/x-shockwave-flash&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;data=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;movie.swf&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;param&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;movie&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;movie.swf&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;alt.jpg&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;alt=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/object&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Not much to it there, and this is available everywhere on the web. It
validates okay, and that's what we need.&lt;/p&gt;
&lt;p&gt;However, if you follow normal procedure for sticking this in Plone
(disable filtering of the relevant &lt;strong&gt;object&lt;/strong&gt; and &lt;strong&gt;param&lt;/strong&gt; tags in HTML
Filtering (Plone Control Panel), then make a Page with this code),
you'll see it won't work in IE.&lt;/p&gt;
&lt;p&gt;Much hair-tearing and searching led me to find that the rendered Page is
missing the &lt;strong&gt;param&lt;/strong&gt; tag in the source XHTML. Huh?!?, you say - I just
disabled the filtering. Why's it not there?!.&lt;/p&gt;
&lt;p&gt;Sure, you did. What noone told you is that you need to go into the ZMI
-&amp;gt; portal_transforms -&amp;gt; safe_html and tell Plone that the &lt;strong&gt;param&lt;/strong&gt;
tag is an &lt;em&gt;empty tag&lt;/em&gt; (like &amp;lt;img /&amp;gt;). In the list of &lt;strong&gt;valid_tags&lt;/strong&gt;,
set &lt;strong&gt;param&lt;/strong&gt; to be &lt;em&gt;0&lt;/em&gt;. Save this page.&lt;/p&gt;
&lt;p&gt;Now try it again in IE. Looking at the source in both should show the
&lt;strong&gt;param&lt;/strong&gt; tag now, and your Flash should show up just fine once you
convince IE to refresh.&lt;/p&gt;
</summary><category term="filtering"></category><category term="flash"></category><category term="parameters"></category><category term="plone"></category><category term="xhtml"></category></entry><entry><title>Plone: PloneFormGen Customisations</title><link href="http://davidjb.com/blog/2009/01/plone-ploneformgen-customisations/" rel="alternate"></link><updated>2009-01-12T16:39:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-12:blog/2009/01/plone-ploneformgen-customisations/</id><summary type="html">&lt;p&gt;Another fun problem for me to address today: upgrading to the latest
version of Plone (3.1.7 at time of writing) caused my custom
PloneFormGen (otherwise known as PFG) view to break in a nasty way:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;Module None, line 13, in fgvalidate_base
- &amp;lt;fscontrollervalidator at /site/fgvalidate_base used for /site/registration-form&amp;gt;
- Line 13
Module Products.PloneFormGen.content.form, line 519, in fgvalidate
Module plone.protect.authenticator, line 60, in check
Forbidden: Form authenticator is invalid.&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Obviously there's some new validation code for forms in Plone 3.1+.
Thanks to a very simple (and useful!) blog entry:
&lt;a class="reference external" href="http://www.die-welt.net/index.php/blog/239/Upgading_forms_in_Plone_3"&gt;http://www.die-welt.net/index.php/blog/239/Upgading_forms_in_Plone_3&lt;/a&gt;
, the solution is to add:&lt;/p&gt;
&lt;pre class="code html literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="na"&gt;tal:replace=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;structure context/&amp;#64;&amp;#64;authenticator/authenticator&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;somewhere in the form.&lt;/p&gt;
</summary><category term="authenticator"></category><category term="changes"></category><category term="forms"></category><category term="plone"></category></entry><entry><title>Rewrite Rules Made Easy</title><link href="http://davidjb.com/blog/2009/01/rewrite-rules-made-easy/" rel="alternate"></link><updated>2009-01-08T16:38:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-08:blog/2009/01/rewrite-rules-made-easy/</id><summary type="html">&lt;p&gt;I've pretty much got a nice handle on Rewrite rules for Apache. Once
you've seen a few of them, it's straight forward enough to replicate for
new Plone sites and so forth.&lt;/p&gt;
&lt;p&gt;However, to make things even easier on my brain I've found this:
&lt;a class="reference external" href="http://betabug.ch/zope/witch"&gt;http://betabug.ch/zope/witch&lt;/a&gt; , the Rewrite Rule Witch. Seems like the
rules it produces are what I'd expect, which makes me ponder why, if I
know they're right, would I bother.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reason:&lt;/strong&gt; easy confirmation and less chance of typos.&lt;/p&gt;
</summary><category term="apache"></category><category term="rewrite"></category><category term="rules"></category></entry><entry><title>Buildout and Version Problems</title><link href="http://davidjb.com/blog/2009/01/buildout-and-version-problems/" rel="alternate"></link><updated>2009-01-06T16:35:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-06:blog/2009/01/buildout-and-version-problems/</id><summary type="html">&lt;p&gt;Two blog entries in one day - wow it's been a good work day.&lt;/p&gt;
&lt;p&gt;Just a quick chronicle of my thoughts: version conflicts in buildout
aren't always pretty. My latest escapade into trying to load up Varnish
through zc.buildout resulted in a hair-tearing out message:&lt;/p&gt;
&lt;pre class="code pytb literal-block"&gt;
&lt;span class="x"&gt;An internal error occured due to a bug in either zc.buildout or in a
recipe being used:
&lt;/span&gt;&lt;span class="gt"&gt;Traceback (most recent call last):
&lt;/span&gt;&lt;span class="gr"&gt;File &amp;quot;/tmp/tmp8o-_PD/zc.buildout-1.1.1-py2.4.egg/zc/buildout/buildout.py&amp;quot;, line 1477, in main
File &amp;quot;/tmp/tmp8o-_PD/zc.buildout-1.1.1-py2.4.egg/zc/buildout/buildout.py&amp;quot;, line 346, in install
File &amp;quot;/tmp/tmp8o-_PD/zc.buildout-1.1.1-py2.4.egg/zc/buildout/buildout.py&amp;quot;, line 857, in getitem
File &amp;quot;/tmp/tmp8o-_PD/zc.buildout-1.1.1-py2.4.egg/zc/buildout/buildout.py&amp;quot;, line 938, in _initialize
File &amp;quot;/tmp/tmp8o-_PD/zc.buildout-1.1.1-py2.4.egg/zc/buildout/buildout.py&amp;quot;, line 901, in _install_and_load
File &amp;quot;/usr/lib/python2.4/site-packages/setuptools-0.6c9-py2.4.egg/pkg_resources.py&amp;quot;, line 277, in load_entry_point
return get_distribution(dist).load_entry_point(group, name)
File &amp;quot;/usr/lib/python2.4/site-packages/setuptools-0.6c9-py2.4.egg/pkg_resources.py&amp;quot;, line 2179, in load_entry_point
raise ImportError(&amp;quot;Entry point %r not found&amp;quot; % ((group,name),))
ImportError&lt;/span&gt;: &lt;span class="n"&gt;Entry point ('zc.buildout', 'default') not found&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;What??? What's that supposed to mean?&lt;/p&gt;
&lt;p&gt;Turns out I managed to stumble upon the cause: our local PyPi repository
had actually already had an old version of the plone.recipe.varnish
source on it and my buildout needed the latest version. Even though I'd
directed buildout to seek out such version, my cache folder already
thought it was satisfied.&lt;/p&gt;
&lt;div class="section" id="solution"&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;Remove the old version from the cache and stick the new version into the
local PyPi.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="buildout"></category><category term="easy_install"></category><category term="python"></category></entry><entry><title>Ubuntu: PulseAudio Joy</title><link href="http://davidjb.com/blog/2009/01/ubuntu-pulseaudio-joy/" rel="alternate"></link><updated>2009-01-06T15:07:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-06:blog/2009/01/ubuntu-pulseaudio-joy/</id><summary type="html">&lt;p&gt;Well, it's a sad state of affairs when simply unplugging your set of USB
headphones causes your Intrepid Ibex install of Ubuntu to crap itself.
Even with the same set of headphones plugged back into the same port not
10 seconds later. Painful.&lt;/p&gt;
&lt;p&gt;But, the good news is that after a few hours of pain, PulseAudio works
and it's magical in comparison to the older audio systems (3 apps
playing audio at once..wow).&lt;/p&gt;
&lt;p&gt;Check out &lt;a class="reference external" href="http://ubuntuforums.org/showthread.php?t=789578"&gt;http://ubuntuforums.org/showthread.php?t=789578&lt;/a&gt; for a great
walk-through on how to set it up on Hardy or Intrepid. Unfortunately,
Skype doesn't play ball (and presumably any other recording software)
with audio input through Pulse, but audio works straight from the USB
headset itself.&lt;/p&gt;
</summary><category term="audio"></category><category term="headphones"></category><category term="pulseaudio"></category><category term="sound"></category><category term="ubuntu"></category><category term="usb"></category></entry><entry><title>Plone: Python Eggs And Development</title><link href="http://davidjb.com/blog/2009/01/plone-python-eggs-and-development/" rel="alternate"></link><updated>2009-01-02T15:04:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2009-01-02:blog/2009/01/plone-python-eggs-and-development/</id><summary type="html">&lt;p&gt;Welcome to the new year! It's the start of another journey around the
sun and the beginning of work for me. Whilst I'm the only one actually
working around here today, I thought I'd take the chance and update with
some useful info:&lt;/p&gt;
&lt;div class="section" id="troublesome-python-eggs"&gt;
&lt;h2&gt;Troublesome Python eggs&lt;/h2&gt;
&lt;p&gt;Now, much to my amazement, when you're creating/compiling/whatever
Python eggs for Plone you need to actually specify the files you want
included in the build. I suppose it's fair enough, but thought it might
have actually done it for me. No such luck!&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;SOURCES.txt&lt;/tt&gt; file in the egg-info folder needs to be updated
accordingly. A command like &lt;tt class="docutils literal"&gt;find ‘pwd` &lt;span class="pre"&gt;-name&lt;/span&gt; &lt;span class="pre"&gt;&amp;quot;*.*&amp;quot;&lt;/span&gt;&lt;/tt&gt; will do the trick
and list out the files in the directory (assuming you start from the
root of the egg). If there’s extra stuff in the folder, you'll probably
need to weed out the extraneous files (.pyc, git, svn, etc) before
building the egg with:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
david&amp;#64;computer: python2.4 setup.py build
david&amp;#64;computer: python2.4 setup.py sdist bdist\_egg
&lt;/pre&gt;
&lt;p&gt;which gets our lovely setuptools to build (scramble?) the egg and place
the source and egg into the &lt;tt class="docutils literal"&gt;dist&lt;/tt&gt; folder. Providing the SOURCES.txt
file was correct, then you'll have the right files included. If you
don't, you'll be in for trouble when you try and include the egg under
ZCML etc because the files just don't come along for the ride.&lt;/p&gt;
&lt;p&gt;Serve with sides of bacon and toast, place into your favourite PyPi
(cheese shop) and include with your buildout config.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="further-reading"&gt;
&lt;h2&gt;Further reading&lt;/h2&gt;
&lt;p&gt;If you're really bored, check out
&lt;a class="reference external" href="http://peak.telecommunity.com/DevCenter/setuptools"&gt;http://peak.telecommunity.com/DevCenter/setuptools&lt;/a&gt; for some good
material on what Setuptools can do for you.&lt;/p&gt;
&lt;/div&gt;
</summary><category term="egg"></category><category term="linux"></category><category term="python"></category><category term="setuptools"></category></entry><entry><title>Plone: Buildout Won't Install Products.OpenXml</title><link href="http://davidjb.com/blog/2008/12/plone-buildout-wont-install-products-openxml/" rel="alternate"></link><updated>2008-12-22T14:59:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2008-12-22:blog/2008/12/plone-buildout-wont-install-products-openxml/</id><summary type="html">&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt; Installation of Products.OpenXml appears to work happily
with buildout when I'm using z3c.recipe.staticlxml to build lxml
separately from having to easy_install or install system-wide packages.&lt;/p&gt;
&lt;p&gt;So it's almost Christmas time and I'm still slaving away working. It's
all about commitment.&lt;/p&gt;
&lt;p&gt;Today in my life I've been trying to install the OpenXml product for
Plone (using buildout, of course):&lt;/p&gt;
&lt;pre class="literal-block"&gt;
david&amp;#64;computer:~/buildout/instance$ ./bin/buildout
Uninstalling zopepy.
Uninstalling instance.
Updating plone.
Updating zope2.
Updating productdistros.
Installing instance.
Getting distribution for 'Products.OpenXml'.
Got Products.OpenXml 1.0.1.
Getting distribution for 'openxmllib'.
Got openxmllib 1.0.3.
Getting distribution for 'lxml&amp;gt;=1.3.0,&amp;amp;amp;lt;2.0.0dev'.
Building lxml version 1.3.6
ERROR: /bin/sh: xslt-config: not found
** make sure the development packages of libxml2 and libxslt are installed
**ERROR: /bin/sh: xslt-config: not found
** make sure the development packages of libxml2 and libxslt are installed
**ERROR: /bin/sh: xslt-config: not found
&lt;/pre&gt;
&lt;p&gt;And then 50,000 errors follow, making this message hard to find. Either
way, the end result was that lxml wasn't able to install.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt; install libxslt and its dev counterpart plus the relevant
Python bindings on your system. In Ubuntu 8.10, that's libxslt1.1,
libxslt1-dev, and python-libxslt1.&lt;/p&gt;
&lt;p&gt;All good now.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt; Turns out Centos 5 (Red Hat) is has different package names.
Try &lt;tt class="docutils literal"&gt;yum install libxslt &lt;span class="pre"&gt;libxslt-devel&lt;/span&gt; &lt;span class="pre"&gt;libxslt-python&lt;/span&gt;&lt;/tt&gt; as root for
Centos.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Future response:&lt;/strong&gt; Just use &lt;a class="reference external" href="https://pypi.python.org/pypi/z3c.recipe.staticlxml"&gt;z3c.recipe.staticlxml&lt;/a&gt; and be done with it all.
No need for system level packages and it all just works.&lt;/p&gt;
</summary><category term="buildout"></category><category term="libxml"></category><category term="openxml"></category><category term="plone"></category><category term="problem"></category><category term="products"></category><category term="xml"></category></entry><entry><title>Unix: SSH Port Forwarding</title><link href="http://davidjb.com/blog/2008/12/unix-ssh-port-forwarding/" rel="alternate"></link><updated>2008-12-18T14:57:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2008-12-18:blog/2008/12/unix-ssh-port-forwarding/</id><summary type="html">&lt;p&gt;So it's not that special and I bet 1000 people have already posted the
same details. Still, it's cool and I need a place to record my thoughts
about this:&lt;/p&gt;
&lt;pre class="code bash literal-block"&gt;
ssh host.name -L YYYY:other.host:ZZZZ
&lt;/pre&gt;
&lt;p&gt;Essentially, this means logging into the first machine and creating port
YYYY on the local machine as the port ZZZZ from other.host&lt;/p&gt;
&lt;p&gt;Works well.&lt;/p&gt;
</summary><category term="linux"></category><category term="port"></category><category term="port forwarding"></category><category term="ssh"></category><category term="unix"></category></entry><entry><title>Plone: Archetypes With Paster</title><link href="http://davidjb.com/blog/2008/12/plone-archetypes-with-paster/" rel="alternate"></link><updated>2008-12-17T11:42:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2008-12-17:blog/2008/12/plone-archetypes-with-paster/</id><summary type="html">&lt;p&gt;From
&lt;a class="reference external" href="http://www.koansys.com/tech/create-plone-3-archetype-product-with-zopeskel-and-buildout"&gt;http://www.koansys.com/tech/create-plone-3-archetype-product-with-zopeskel-and-buildout&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;ZopeSkel can create Archetype-based products for Plone 3. Wire it up in
Buildout.&lt;/p&gt;
&lt;p&gt;After creating a Plone 3 instance (e.g., with Unified Installer) go into
the src/ directory and create a development product with ZopeSkel:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
&amp;gt; paster create -t archetype
Enter title (The title of the project) ['Plone Example']: Koansys Newproduct
Enter namespace_package (Namespace package (like plone)) ['plone']: koansys
Enter package (The package contained namespace package (like example)) ['example']: newproduct
Enter zope2product (Are you creating a Zope 2 Product?) [False]: True
Enter version (Version) ['0.1']:
Enter description (One-line description of the package) ['']:
Enter long_description (Multi-line description (in reST)) ['']:
Enter author (Author name) ['Plone Foundation']:
Enter author_email (Author email) ['&amp;lt;span class=&amp;quot;mh-email&amp;quot;&amp;gt;plon&amp;lt;a href=&amp;quot;http://www.google.com/recaptcha/mailhide/d?k=01y8BLyDqFl2lR8hms6kYeaw==&amp;amp;c=dWZpn-kF-kBBpxKfk95rjiTb1Ew_D4R2wQXotn8J5EOipnAJf_DdjfsAvsl4fVO3&amp;quot; onclick=&amp;quot;window.open('http://www.google.com/recaptcha/mailhide/d?k=01y8BLyDqFl2lR8hms6kYeaw==&amp;amp;c=dWZpn-kF-kBBpxKfk95rjiTb1Ew_D4R2wQXotn8J5EOipnAJf_DdjfsAvsl4fVO3', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;&amp;quot; title=&amp;quot;Reveal this e-mail address&amp;quot;&amp;gt;...&amp;lt;/a&amp;gt;&amp;#64;lists.sourceforge.net&amp;lt;/span&amp;gt;']:
Enter keywords (Space-separated keywords/tags) ['']:
Enter url (URL of homepage) ['http://svn.plone.org/svn/plone/plone.example']:
Enter license_name (License name) ['GPL']:
Enter zip_safe (True/False: if the package can be distributed as a .zip file) [False]:
&lt;/pre&gt;
&lt;p&gt;then go into that directory (koansys.newproduct) and add a content type:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
&amp;gt; paster addcontent contenttype
Enter contenttype_name (Content type name ) ['Example Type']: Recipe
Enter contenttype_description (Content type description ) ['Description of the Example Type']: Recipe with ingredients, procedure, metadata
Enter folderish (True/False: Content type is Folderish ) [False]: True
Enter global_allow (True/False: Globally addable ) [True]:
Enter allow_discussion (True/False: Allow discussion ) [False]: True
&lt;/pre&gt;
&lt;p&gt;Modify your buildout.cfg to use these as development eggs and tell each
instance about it's ZCML (otherwise it won't show up in the Quick
Installer):&lt;/p&gt;
&lt;pre class="code cfg literal-block"&gt;
&lt;span class="k"&gt;[buildout]&lt;/span&gt;
&lt;span class="err"&gt;...&lt;/span&gt;
&lt;span class="na"&gt;eggs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
&lt;span class="err"&gt;...&lt;/span&gt;
&lt;span class="c1"&gt;#name of the actual egg folder&lt;/span&gt;
&lt;span class="err"&gt;NRBCLiterature&lt;/span&gt;
&lt;span class="na"&gt;develop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
&lt;span class="c1"&gt;#path to egg folder&lt;/span&gt;
&lt;span class="err"&gt;src/NRBCLiterature&lt;/span&gt;

&lt;span class="k"&gt;[instance]&lt;/span&gt;
&lt;span class="na"&gt;recipe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;plone.recipe.zope2instance&lt;/span&gt;
&lt;span class="na"&gt;eggs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
&lt;span class="err"&gt;${plone:eggs}&lt;/span&gt;
&lt;span class="err"&gt;${buildout:eggs}&lt;/span&gt;
&lt;span class="na"&gt;zcml&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
&lt;span class="c1"&gt;#name of the egg itself&lt;/span&gt;
&lt;span class="err"&gt;nrbc.literature&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Re-run buildout and restart your &amp;quot;instance&amp;quot; instance and you should see it in the Quick Installer.&lt;/p&gt;
</summary><category term="content"></category><category term="paster"></category><category term="plone"></category><category term="types"></category><category term="zopeskel"></category></entry><entry><title>Plone: Ploneboard Conversation Editing</title><link href="http://davidjb.com/blog/2008/11/plone-ploneboard-conversation-editing/" rel="alternate"></link><updated>2008-11-27T11:40:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2008-11-27:blog/2008/11/plone-ploneboard-conversation-editing/</id><summary type="html">&lt;p&gt;I'm back with even more Plone goodness. Turns out Ploneboard has a
problem/issue (well, HAD an issue until I went and edited the code on
the SVN repository for the Collective of Plone. Read: will not have in
the next major release) with redirecting the user after they go and edit
a post. So essentially the user ends up getting to a page that says
'Insufficient privileges', which is was extremely odd considering I do
everything as an admin.&lt;/p&gt;
&lt;p&gt;The fix goes a little something like this:&lt;/p&gt;
&lt;p&gt;In ploneboard_scripts/comment_redirect_to_conversation change it to
be:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="c"&gt;# XXX if we ever do batching, we need extra logic here.&lt;/span&gt;
&lt;span class="n"&gt;redirect_target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getConversation&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;anchor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getId&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;REQUEST&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'RESPONSE'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;#&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;redirect_target&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;absolute_url&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;anchor&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Redirecting to &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;redirect_target&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;absolute_url&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;printed&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Originally, the user was attempted to be sent to some other view that
they couldn't access. Now, they just get sent to the conversation. No
tricks, just the conversation.&lt;/p&gt;
&lt;p&gt;More Plone on the way!&lt;/p&gt;
</summary><category term="conversation"></category><category term="editing"></category><category term="plone"></category><category term="ploneboard"></category><category term="python"></category><category term="redirection"></category><category term="script"></category></entry><entry><title>Plone: Page Template Redirects</title><link href="http://davidjb.com/blog/2008/11/plone-page-template-redirects/" rel="alternate"></link><updated>2008-11-25T11:38:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2008-11-25:blog/2008/11/plone-page-template-redirects/</id><summary type="html">&lt;p&gt;Was wondering how to get a Plone page template to go to a page before the template actually loads. Now, actually getting Plone to not go to this template would be FAR better, but since we can’t actually modify the functionality of the Favourites content items in the content listings (not easily), I instead modify it’s default view.&lt;/p&gt;
&lt;p&gt;Using this:&lt;/p&gt;
&lt;pre class="code html literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;metal:js&lt;/span&gt; &lt;span class="na"&gt;fill-slot=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;javascript_head_slot&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;script &lt;/span&gt;&lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt;
        &lt;span class="na"&gt;tal:content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;python:'location.href=\''+portal.absolute_url()+'/'+here.remoteUrl+'\';;'&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/metal:js&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;We see that the page reloads to the relevant location as soon as the
head JavaScript is done loading.&lt;/p&gt;
&lt;p&gt;Easy, quick, useful, hack-y. More to come for Plone.&lt;/p&gt;
</summary><category term="edit"></category><category term="hack"></category><category term="javascript"></category><category term="plone"></category><category term="redirect"></category><category term="template"></category></entry><entry><title>Plone: Relative 'Recent Changes' Portlets</title><link href="http://davidjb.com/blog/2008/11/plone-relative-recent-changes-portlets/" rel="alternate"></link><updated>2008-11-20T11:33:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2008-11-20:blog/2008/11/plone-relative-recent-changes-portlets/</id><summary type="html">&lt;p&gt;The problem I've been faced with today on our Plone systems is that I
need to created a 'Recent Changes' portlet that's relative to where the
user is on the site.&lt;/p&gt;
&lt;p&gt;Now, the standard portlet doesn't do anything for me, so that's pretty
useless. I had a look at the standard code for the portlet too and it's
not really feasible to try and mess with:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;tal:recentlist&lt;/span&gt; &lt;span class="na"&gt;define=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;view here/&amp;#64;&amp;#64;recent_view; results here/results;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;However, using a (nasty?) workaround, if we put the classic Recent
Changes portlet into play, we can change that above code in the ZMI to
something like:&lt;/p&gt;
&lt;pre class="code xml literal-block"&gt;
&lt;span class="nt"&gt;&amp;lt;tal:recentlist&lt;/span&gt; &lt;span class="na"&gt;define=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;view here/&amp;#64;&amp;#64;recent_view;
                        theseResults python:container.portal_catalog(path='/'.join(context.getPhysicalPath()),sort_on='modified',sort_order='reverse');
                        results python:theseResults[:5];&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;So, we handle the problem by asking the portal catalog this time, and
only wanting stuff that's under our current physical path. By using the
&lt;em&gt;path&lt;/em&gt; parameter for the catalog, this works its magic for us. The
sub-selection of the array handles cutting back the results.&lt;/p&gt;
&lt;p&gt;I noticed that the portlet also has links in its header and footer to
'/recently_modified'. This would, typically, just give us the
everything on the portal, but by making a new page template with a
slightly different name, copying the code in from 'recently_modified',
modifying its &lt;em&gt;results&lt;/em&gt; as above, and pointing the portlet's links at
this new page template under our current page:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;here&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;absolute_url&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s"&gt;'/relative_recently_modified'&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;we end up with a nice, relative, recent changes full listing.&lt;/p&gt;
&lt;p&gt;It's a brutal hack, but you could apply the same idea to an actual
product and make a real Plone 3 portlet out of this.&lt;/p&gt;
</summary><category term="features"></category><category term="plone"></category><category term="portlets"></category><category term="product"></category><category term="python"></category></entry><entry><title>JCU LyX Layout</title><link href="http://davidjb.com/blog/2008/11/jcu-lyx-layout/" rel="alternate"></link><updated>2008-11-09T11:25:00+10:00</updated><author><name>davidjb</name></author><id>tag:davidjb.com,2008-11-09:blog/2008/11/jcu-lyx-layout/</id><summary type="html">&lt;!-- note Update: this is now available on GitHub at
https://github.com/davidjb/JCU-Thesis-LyX-Layout for you to fork and
improve.  Feel free to drop me a line if you're using it! --&gt;
&lt;p&gt;What might be interesting to all you &lt;a class="reference external" href="http://www.jcu.edu.au/"&gt;James Cook
University&lt;/a&gt; or &lt;strong&gt;JCU&lt;/strong&gt; folk out there (yeah, you know who you are!), is
the attached zip file to this post. It's a &lt;a class="reference external" href="http://www.lyx.org/"&gt;LyX&lt;/a&gt; layout that
automagically inserts the required details into your thesis (Honours or
PhD), assuming that you give the correct details to LyX. Just so you
know, &lt;strong&gt;LyX&lt;/strong&gt; is a WYSIWYM (what-you-see-is-what-you-mean) editor for
&lt;strong&gt;LaTeX&lt;/strong&gt;, which makes things very easy to make great looking documents.
It's free, it's more powerful and easier than M$ Word, and if you're not
using it, it should be because you just found about it.&lt;/p&gt;
&lt;p&gt;Unzip the files, place them in your .lyx document directory and tell LyX
to use that layout. See the Document menu and then Settings, then
Document Class and choose 'Local Layout'. LyX might warn you about
something, but just make sure all the unzipped files are in the same
folder as your original document itself.&lt;/p&gt;
&lt;p&gt;Now, generally near the start of the document, use the available
document layouts to create a:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Title&lt;/li&gt;
&lt;li&gt;Author (with your name)&lt;/li&gt;
&lt;li&gt;Degree (with something like 'Bachelor Of Information Technology with
Honours')&lt;/li&gt;
&lt;li&gt;School (something like 'Information Technology')&lt;/li&gt;
&lt;li&gt;University (with 'James Cook University'), and&lt;/li&gt;
&lt;li&gt;Crest Filename with 'jcucrestcolour.jpg', the name of the JCU logo
you have (it's in the zip file, but if you've got a specific JCU
school pic then you can change it.&amp;nbsp; EDIT: It's the old logo, but see
below for the new one).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can add Acknowledgements and an Abstract if you want, and then
everything else like Table of Contents and Figures etc.&lt;/p&gt;
&lt;p&gt;When you start your document, insert this ERT code:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
\pagenumbering{arabic}
&lt;/pre&gt;
&lt;p&gt;to start the document numbering correctly.&lt;/p&gt;
&lt;p&gt;That's it! Render the document as PDF using LyX and see what happens. If
you find errors, it's because you're missing some LaTeX packages.
Configure your typeset program (MikTeX if you're on Windows) to
automatically download missing packages, then run Reconfigure on LyX,
restart it, and go again. Make sure you're on the net first!&lt;/p&gt;
&lt;p&gt;Hopefully you guys from JCU can get some use out of this. Otherwise, if
someone (or anyone!) wants to let JCU staff know about this thesis
template go ahead. I hear that some people are (still!) using Microsoft
Word and having pain. Free yourself and get LyX and LaTeX, it's the best
move you'll make for your work. Not to mention they're all free..forget
paying real money to Micro$oft.&lt;/p&gt;
&lt;div class="section" id="files"&gt;
&lt;h2&gt;Files&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://davidjb.com/static/files/jcu_lyx_layout_2008.zip"&gt;JCU LyX Layout (2008)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://davidjb.com/static/files/jcu_logo.zip"&gt;JCU Logo (New, SVG)&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</summary></entry></feed>