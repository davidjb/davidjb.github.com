<!DOCTYPE html>
<html lang="en">
<head>
        <title>DavidJB.com - rfc</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://davidjb.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="DavidJB.com Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">DavidJB.com  <strong>Ramblings about Plone, Pyramid, Python, the web, Linux, roses and more.</strong></a></h1>
                <nav><ul>
                                                    <li><a href="../pages/about-me.html">About me</a></li>
                                    <li><a href="../pages/blog.html">Blog</a></li>
                                    <li><a href="../pages/projects.html">Projects</a></li>
                                                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../blog/2011/03/disabling-caching-for-sensitive-web-pages-aka-how-to-prevent-logged-out-users-going-back/">Disabling caching for sensitive web pages (aka how to prevent logged out users going 'back')</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2011-03-24T12:50:00">
                Thu 24 March 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/web.html">Web</a>. </p>
<p>tags: <a href="../tag/caching.html">caching</a><a href="../tag/http.html">http</a><a href="../tag/no-store.html">no-store</a><a href="../tag/rfc.html">rfc</a><a href="../tag/web.html">web</a></p>
</footer><!-- /.post-info --><p>We all see web pages like Internet banking, HR systems, email, and more
that allow you to log in, do something and load pages, log out, and then
prevent you from using your browser's history to see that sensitive
information.&nbsp; I'm amazed that in my searches I couldn't quickly find a
definitive source of information on how to achieve this.&nbsp; Pages across
the web in a search for 'stop caching' range from blog posts, to forum
posts, to other pages, and people asking the question (try it: <a class="reference external" href="http://www.google.com/search?q=stop+caching">here</a>,
or <a class="reference external" href="http://www.google.com/search?q=stop+caching+firefox">maybe here</a>).</p>
<p>Maybe I got unlucky, but finding a definitive answer to the questions of
&quot;how to prevent the use of the back button&quot; or &quot;how to stop browsers
caching&quot; etc wasn't a piece of cake. Hence this post.</p>
<p>The answer isn't concrete in itself either due to differing browser
support, but the most useful information comes from RFC2616, the RFC for
HTTP/1.1. In <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9.2">section 14.9.2</a>, we learn about <tt class="docutils literal"><span class="pre">no-store</span></tt>. This cache
directive should see a correctly-implemented browser not storing a
request/response on disk (non-volatile storage) and deleting the info as
quick as possible from RAM (volatile storage).</p>
<p>I've found that combining this, with an Expires header, and other
Cache-Control directives, has worked across Firefox 4, Chrome 10,
Internet Explorer 6, 7, 8, and 9 to keep relevant pages entirely out of
the cache. Here's a snippet from some Python code:</p>
<pre class="code python literal-block">
<span class="n">response</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">'Expires'</span><span class="p">,</span> <span class="n">formatDateTime</span><span class="p">(</span><span class="n">getExpiration</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="n">response</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">'Cache-Control'</span><span class="p">,</span> <span class="s">'no-store, no-cache, max-age=0, must-revalidate, private'</span><span class="p">)</span>
</pre>
<p>You could likely use this in the &lt;meta&gt; tags in your page too.</p>
<p>This, by all means, isn't a guaranteed solution as the RFC may not be
followed by all browsers.&nbsp; I've also noted that the RFC isn't exactly
clear with regards to a browser's history this sort of thing.&nbsp; <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.13">Section
13.13</a> mentions that &quot;a history mechanism is meant to show exactly what
the user saw at the time when the resource was retrieved&quot;, and using the
RFC-specified <tt class="docutils literal"><span class="pre">no-store</span></tt> on a logged in page (or anything dynamic)
would seemingly break this implication.</p>
<p>At any rate, seems like this implementation works successfully on the
browsers I've tested. Apparently IE doesn't like the <tt class="docutils literal"><span class="pre">no-store</span></tt> or
<tt class="docutils literal"><span class="pre">no-cache</span></tt> settings in certain circumstances but it's been fine for me
thus far.</p>
<p>There are <a href="../blog/2011/03/disabling-caching-for-sensitive-web-pages-aka-how-to-prevent-logged-out-users-going-back/#disqus_thread">comments</a>.</p>                </article>
                                    <p class="paginator">
        Page 1 / 1
    </p>
                            </aside><!-- /#featured -->
                                                </ol><!-- /#posts-list -->
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://planet.plone.org">Planet Plone</a></li>
                                                    <li><a href=""></a></li>
                                                    <li><a href=""></a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://davidjb.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://git.io/djb">GitHub</a></li>
                                                    <li><a href="http://twitter.com/davidjb_">Twitter</a></li>
                                                    <li><a href="http://linkedin.com/in/davidbeitey">LinkedIn</a></li>
                                                    <li><a href="http://facebook.com/david.beitey">Facebook</a></li>
                                                    <li><a href="https://plus.google.com/u/0/106527454335411502430">Google+</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24253455-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'davidjb';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>