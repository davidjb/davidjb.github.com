<!DOCTYPE html>
<html lang="en">
<head>
        <title>DavidJB.com - database</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://davidjb.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="DavidJB.com Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">DavidJB.com  <strong>Ramblings about Plone, Pyramid, Python, the web, Linux, roses and more.</strong></a></h1>
                <nav><ul>
                                                    <li><a href="../pages/about-me.html">About me</a></li>
                                    <li><a href="../pages/blog.html">Blog</a></li>
                                    <li><a href="../pages/projects.html">Projects</a></li>
                                                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../blog/2011/07/watch-out-python-2-4-zeo-client-and-python-2-6-zeo-server/">Watch out: Python 2.4 ZEO client and Python 2.6 ZEO Server</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2011-07-11T16:23:00">
                Mon 11 July 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/database.html">database</a><a href="../tag/fs.html">fs</a><a href="../tag/plone.html">plone</a><a href="../tag/server.html">server</a><a href="../tag/zeo.html">zeo</a><a href="../tag/zope.html">zope</a></p>
</footer><!-- /.post-info --><p>Today was interesting when an issue with saving content on a Plone 3.3.5
site got reported to me. The system was producing undecipherable error
messages about ZEO disconnections and database conflicts whenever
someone would try and create some content within Plone (folders,
particularly). Errors looked like:</p>
<pre class="code pytb literal-block">
<span class="x">Module ZEO.zrpc.connection, line 796, in wait. DisconnectedError&quot; and &quot;raise ReadConflictError().
ReadConflictError: database read conflict error&quot;</span>
</pre>
<p>and also:</p>
<pre class="code pytb literal-block">
<span class="x">ERROR ZEO.zrpc (2515) can't decode message: '(K\x11K\x01U\tserialnos(]((U\x08\x00\x00\x00\x00\x00X\x...'</span>
</pre>
<p>-- essentially the issue described <a class="reference external" href="https://mail.zope.org/pipermail/zodb-dev/2010-December/013893.html">here</a>. My ZEO server was running
ZODB3 3.9.5 with Python 2.6, and my client running ZODB3 3.8.3 with
Python 2.4; almost everything worked.</p>
<p>The long and the short of this issue appears to be, as the <a class="reference external" href="http://pypi.python.org/pypi/ZODB3/3.9.5#compatibility">ZODB
documentation mentions</a>, is that Python 2.4 servers work with 2.5+
clients, but not the other way around.&nbsp; It's slightly misleading when
you read further and see that:</p>
<pre class="literal-block">
ZODB ZEO clients from ZODB 3.2 on can talk to ZODB 3.9 servers. ZODB
ZEO Clients can talk to ZODB 3.8 and 3.9 ZEO servers.
</pre>
<p>So, despite this seeming interoperability, dang - I can't use my
pre-existing ZEO server setup (based on the Plone 4 buildout for
versions, etc) which is currently in place and running.</p>
<p>Thankfully, building being what it is, the solution for me was to simply
re-use that buildout for any Plone instances that are Python 2.4
clients.&nbsp; This was as simple as re-cloning my git repository where I
keep the buildouts, firing up a brand new virtualenv for Python 2.4, and
moving the data across.</p>
<div class="section" id="one-more-thing">
<h2>One more thing...</h2>
<p>There is one final thing worth mentioning, which I got awfully caught
out by.&nbsp; I was finding that my ZEO processes, under this new
environment, just would not start - essentially, they would keep
respawning again and again until they stopped (triggered by some
'quick-respawn' safety mechanism, seemingly).&nbsp; I thought this was some
issue concerning the fact I'd had my databases and files loaded against
newer ZEO versions, but this actually not.&nbsp; This was a by-product of not
having my ZEO authentication database present - because there was no
file, presumably the processes kept crashing.&nbsp; Sadly, no error message,
so hence this note.&nbsp; Take care with this one.</p>
</div>
<p>There are <a href="../blog/2011/07/watch-out-python-2-4-zeo-client-and-python-2-6-zeo-server/#disqus_thread">comments</a>.</p>                </article>
                            </aside><!-- /#featured -->
                            <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
                                                

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/" rel="bookmark"
                           title="Permalink to Plone/Zope: Truncating a Data.fs back to a certain date/time">Plone/Zope: Truncating a Data.fs back to a certain date/time</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-07-20T13:39:00">
                Tue 20 July 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/datafs.html">data.fs</a><a href="../tag/database.html">database</a><a href="../tag/date.html">date</a><a href="../tag/fix.html">fix</a><a href="../tag/linux.html">linux</a><a href="../tag/plone.html">plone</a><a href="../tag/python.html">python</a><a href="../tag/time.html">time</a><a href="../tag/truncate.html">truncate</a><a href="../tag/zeo.html">zeo</a><a href="../tag/zodb.html">zodb</a><a href="../tag/zodb3.html">zodb3</a><a href="../tag/zope.html">zope</a></p>
</footer><!-- /.post-info -->                <p>Okay. So, anyone out here who's listening -- particularly those
overly-enthusiastic users -- don't try to recursively <tt class="docutils literal">wget</tt> your
Plone site (or other CMS, for that matter) whilst you're logged in with
an account that can make edits. It <strong>will</strong> lead to a very bad situation
where your site ...</p>
                <a class="readmore" href="../blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/">read more</a>
                <p>There are <a href="../blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2010/07/plone-4-local-zeo-blobs-conflict-with-plone-instance/" rel="bookmark"
                           title="Permalink to Plone 4: Local Zeo blobs conflict with Plone instance">Plone 4: Local Zeo blobs conflict with Plone instance</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-07-06T16:04:00">
                Tue 06 July 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/blob.html">blob</a><a href="../tag/conflict.html">conflict</a><a href="../tag/database.html">database</a><a href="../tag/db.html">db</a><a href="../tag/files.html">files</a><a href="../tag/plone.html">plone</a><a href="../tag/plone-4.html">plone 4</a><a href="../tag/problem.html">problem</a><a href="../tag/upgrade.html">upgrade</a><a href="../tag/zeo.html">zeo</a></p>
</footer><!-- /.post-info -->                <p>As the title suggests, there's a conflict between a Zeo database
instance being run together with a Plone 4/Zope instance, and them
trying to share the same blob storage folder.&nbsp; But, this only happens if
you misunderstand or incorrectly set the option of&nbsp; <em>shared-blob = off</em>,
and <em>blob-storage</em> to ...</p>
                <a class="readmore" href="../blog/2010/07/plone-4-local-zeo-blobs-conflict-with-plone-instance/">read more</a>
                <p>There are <a href="../blog/2010/07/plone-4-local-zeo-blobs-conflict-with-plone-instance/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2009/09/migrating-a-plone-site-off-to-another-database-zeo/" rel="bookmark"
                           title="Permalink to Migrating a Plone site off to another database (Zeo)">Migrating a Plone site off to another database (Zeo)</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2009-09-30T12:25:00">
                Wed 30 September 2009
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/database.html">database</a><a href="../tag/export.html">export</a><a href="../tag/import.html">import</a><a href="../tag/migration.html">migration</a><a href="../tag/plone.html">plone</a><a href="../tag/site.html">site</a><a href="../tag/zeo.html">zeo</a><a href="../tag/zodb.html">zodb</a></p>
</footer><!-- /.post-info -->                <p>Another of the interesting things in my professional life has been
migrating a Plone site from one database (where it lived as a dev site,
along with many others) onto a nice, clean database of its own.&nbsp; Now,
yes, I'm aware that the export/import feature of Zope <strong>isn ...</strong></p>
                <a class="readmore" href="../blog/2009/09/migrating-a-plone-site-off-to-another-database-zeo/">read more</a>
                <p>There are <a href="../blog/2009/09/migrating-a-plone-site-off-to-another-database-zeo/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            </ol><!-- /#posts-list -->
                            <p class="paginator">
        Page 1 / 1
    </p>
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://planet.plone.org">Planet Plone</a></li>
                                                    <li><a href=""></a></li>
                                                    <li><a href=""></a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://davidjb.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://git.io/djb">GitHub</a></li>
                                                    <li><a href="http://twitter.com/davidjb_">Twitter</a></li>
                                                    <li><a href="http://linkedin.com/in/davidbeitey">LinkedIn</a></li>
                                                    <li><a href="http://facebook.com/david.beitey">Facebook</a></li>
                                                    <li><a href="https://plus.google.com/u/0/106527454335411502430">Google+</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24253455-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'davidjb';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>