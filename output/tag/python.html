<!DOCTYPE html>
<html lang="en">
<head>
        <title>DavidJB.com - python</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://davidjb.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="DavidJB.com Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">DavidJB.com  <strong>Ramblings about Plone, Pyramid, Python, the web, Linux, roses and more.</strong></a></h1>
                <nav><ul>
                                                    <li><a href="../pages/about-me.html">About me</a></li>
                                    <li><a href="../pages/blog.html">Blog</a></li>
                                    <li><a href="../pages/projects.html">Projects</a></li>
                                                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../blog/2012/06/serving-tilestache-or-another-app-using-uwsgi-against-a-web-sub-directory/">Serving TileStache (or another app) using uWSGI against a web sub-directory</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-06-01T12:41:00">
                Fri 01 June 2012
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/python.html">Python</a>. </p>
<p>tags: <a href="../tag/application.html">application</a><a href="../tag/python.html">python</a><a href="../tag/serving.html">serving</a><a href="../tag/uwsgi.html">uwsgi</a><a href="../tag/web.html">web</a><a href="../tag/wsgi.html">wsgi</a></p>
</footer><!-- /.post-info --><p><a class="reference external" href="http://projects.unbit.it/uwsgi/">uWSGI</a> is extremely promising as an application server given its huge
range of options and supported platforms. &nbsp;For me, however, just getting
something seemingly simple up and running successfully was relatively
confusing. I'd like to contribute to the documentation when I can, but
thought a dedicated page about <a class="reference external" href="http://tilestache.org">TileStache</a> as a specific application
(and associated configuration) was warranted. It does make more sense
now, thankfully.</p>
<p>I want to serve my TileStache application at <a class="reference external" href="http://mydomain.com/tiles">http://mydomain.com/tiles</a>
(taking careful note of the sub-directory present). I've chosen an
INI-style configuration for my instance and here's what the final result
looks like (loads using <tt class="docutils literal">uwsgi <span class="pre">--ini</span> my_uwsgi.ini</tt>):</p>
<pre class="code ini literal-block">
<span class="k">[uwsgi]</span>
<span class="na">processes</span> <span class="o">=</span> <span class="s">8</span>
<span class="na">vacuum</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">master</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">socket</span> <span class="o">=</span> <span class="s">%(home)/var/uwsgi.sock</span>
<span class="na">home</span> <span class="o">=</span> <span class="s">/opt/tilestache</span>
<span class="na">mount</span> <span class="o">=</span> <span class="s">/tiles=app.py</span>
<span class="na">need-app</span> <span class="o">=</span> <span class="s">true</span>
</pre>
<p>The available options for uWSGI are extremely comprehensive and fairly
bewildering for someone just starting off. The main issue I faced was
the fact the <em>--module</em> option doesn't support argument passing. This
was a big one because documentation like <a class="reference external" href="http://projects.unbit.it/uwsgi/wiki/Quickstart">this</a> shows empty rounded
brackets and the programmer in me instinctively thought of this as an
Python object call. Not so. In order to pass arguments, you either need
<em>--eval</em> or to do what I did and create a separate file and mount that.
Where I have <em>app.py</em> specified above, this is the definition for said
file:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">TileStache</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">TileStache</span><span class="o">.</span><span class="n">WSGITileServer</span><span class="p">(</span><span class="s">'tilestache.cfg'</span><span class="p">)</span>
</pre>
<p>So that's uWSGI serving TileStache. The final issue to solve is that of
serving against a sub-directory. Once you have your application mounted
against the relevant mount point (in my case <em>/tiles</em>), then it's just a
case of telling uWSGI to use this as its <strong>SCRIPT_NAME</strong> environment
variable.</p>
<p>For me, this was telling our webserver (Cherokee) to provide the
<strong>UWSGI_SCRIPT_NAME</strong>, ensuring the <strong>UWSGI_</strong> is prepended, as a custom
environment variable against the relevant Directory behaviour. Once
Cherokee was pointed at the relevant socket and restarted, everything
'just worked'. In the case of other web servers like Nginx, it would be
a case of configuring a location with:</p>
<pre class="code ini literal-block">
<span class="err">uwsgi_param</span> <span class="err">SCRIPT_NAME</span> <span class="err">/tiles</span><span class="c1">;</span>
</pre>
<p>And there you have it.</p>
<p>There are <a href="../blog/2012/06/serving-tilestache-or-another-app-using-uwsgi-against-a-web-sub-directory/#disqus_thread">comments</a>.</p>                </article>
                            </aside><!-- /#featured -->
                            <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
                                                

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2012/02/mr-scripty-my-new-best-friend/" rel="bookmark"
                           title="Permalink to mr.scripty - my new best friend">mr.scripty - my new best friend</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-02-24T08:34:00">
                Fri 24 February 2012
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/python.html">Python</a>. </p>
<p>tags: <a href="../tag/awesome.html">awesome</a><a href="../tag/buildout.html">buildout</a><a href="../tag/python.html">python</a><a href="../tag/recipe.html">recipe</a></p>
</footer><!-- /.post-info -->                <p>If you're working with Buildout, then check out <a class="reference external" href="http://github.com/collective/mr.scripty">mr.scripty</a>, a
fantastic Buildout recipe that allows you to use Python code in
functions within its options. &nbsp;This means that - in the few instances
I've used it so far - have conditional statements regarding effectively
anything.</p>
<p>In the two examples ...</p>
                <a class="readmore" href="../blog/2012/02/mr-scripty-my-new-best-friend/">read more</a>
                <p>There are <a href="../blog/2012/02/mr-scripty-my-new-best-friend/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2011/08/importerror-no-module-named-beautifulsoup/" rel="bookmark"
                           title="Permalink to ImportError: No module named BeautifulSoup">ImportError: No module named BeautifulSoup</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-08-26T12:02:00">
                Fri 26 August 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/python.html">Python</a>. </p>
<p>tags: <a href="../tag/egg.html">egg</a><a href="../tag/error.html">error</a><a href="../tag/import.html">import</a><a href="../tag/packages.html">packages</a><a href="../tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>Had this issue when you've been trying to run something like
<a class="reference external" href="http://pypi.python.org/pypi/funnelweb">Funnelweb</a>, and you hit an ImportError for BeautifulSoup?&nbsp; You're
definitely not alone, because I just hit the same issue.&nbsp; The answer is
simple -- just ensure that you don't use BeautifulSoup 4 or above (this
is still ...</p>
                <a class="readmore" href="../blog/2011/08/importerror-no-module-named-beautifulsoup/">read more</a>
                <p>There are <a href="../blog/2011/08/importerror-no-module-named-beautifulsoup/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2011/05/cant-run-plonezope-buildout-on-ubuntu-11-04-after-upgrade-from-10-10/" rel="bookmark"
                           title="Permalink to Can't run Plone/Zope buildout on Ubuntu 11.04 after upgrade from 10.10">Can't run Plone/Zope buildout on Ubuntu 11.04 after upgrade from 10.10</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-05-11T09:33:00">
                Wed 11 May 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/it-linux-software.html">IT, Linux, Software</a>. </p>
<p>tags: <a href="../tag/buildout.html">buildout</a><a href="../tag/plone.html">plone</a><a href="../tag/python.html">python</a><a href="../tag/zope.html">zope</a></p>
</footer><!-- /.post-info -->                <p>After upgrading from Ubuntu 10.10 (Maverick Meerkat) to Ubuntu 11.04
(Natty Narwhal), you'll probably find that if you're running a Plone 4
buildout where you need to upgrade the Plone version, that compilation
of Zope will fail. The output will look something like this:</p>
<pre class="code pytb literal-block">
<span class="x">Getting distribution ...</span></pre>
                <a class="readmore" href="../blog/2011/05/cant-run-plonezope-buildout-on-ubuntu-11-04-after-upgrade-from-10-10/">read more</a>
                <p>There are <a href="../blog/2011/05/cant-run-plonezope-buildout-on-ubuntu-11-04-after-upgrade-from-10-10/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2011/01/python-eggs-and-missing-files-like-docs/" rel="bookmark"
                           title="Permalink to Python eggs and missing files (like 'docs')">Python eggs and missing files (like 'docs')</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2011-01-06T11:57:00">
                Thu 06 January 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/python.html">Python</a>. </p>
<p>tags: <a href="../tag/build.html">build</a><a href="../tag/docs.html">docs</a><a href="../tag/egg.html">egg</a><a href="../tag/file.html">file</a><a href="../tag/install.html">install</a><a href="../tag/missing.html">missing</a><a href="../tag/problem.html">problem</a><a href="../tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>This is pretty trivial (and trivial to fix), but I'm chronicling it for
my knowledge as much as anyone else's.&nbsp; The issue is that a given Python
egg is missing some form of files, most commonly the 'docs' directory in
my experience, because the build wasn't configured ...</p>
                <a class="readmore" href="../blog/2011/01/python-eggs-and-missing-files-like-docs/">read more</a>
                <p>There are <a href="../blog/2011/01/python-eggs-and-missing-files-like-docs/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/" rel="bookmark"
                           title="Permalink to Plone/Zope: Truncating a Data.fs back to a certain date/time">Plone/Zope: Truncating a Data.fs back to a certain date/time</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-07-20T13:39:00">
                Tue 20 July 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/datafs.html">data.fs</a><a href="../tag/database.html">database</a><a href="../tag/date.html">date</a><a href="../tag/fix.html">fix</a><a href="../tag/linux.html">linux</a><a href="../tag/plone.html">plone</a><a href="../tag/python.html">python</a><a href="../tag/time.html">time</a><a href="../tag/truncate.html">truncate</a><a href="../tag/zeo.html">zeo</a><a href="../tag/zodb.html">zodb</a><a href="../tag/zodb3.html">zodb3</a><a href="../tag/zope.html">zope</a></p>
</footer><!-- /.post-info -->                <p>Okay. So, anyone out here who's listening -- particularly those
overly-enthusiastic users -- don't try to recursively <tt class="docutils literal">wget</tt> your
Plone site (or other CMS, for that matter) whilst you're logged in with
an account that can make edits. It <strong>will</strong> lead to a very bad situation
where your site ...</p>
                <a class="readmore" href="../blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/">read more</a>
                <p>There are <a href="../blog/2010/07/plonezope-truncating-a-data-fs-back-to-a-certain-datetime/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2010/07/plone-running-plone-without-copies-of-blobs/" rel="bookmark"
                           title="Permalink to Plone: running Plone without copies of blobs">Plone: running Plone without copies of blobs</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-07-13T16:30:00">
                Tue 13 July 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/blob.html">blob</a><a href="../tag/blobs.html">blobs</a><a href="../tag/files.html">files</a><a href="../tag/patch.html">patch</a><a href="../tag/plone.html">plone</a><a href="../tag/problem.html">problem</a><a href="../tag/python.html">python</a></p>
</footer><!-- /.post-info -->                <p>Having a bad day? Just bombed your only copies of some files that you'd
been storing as blobs together with your Plone database? Maybe you had
the blobs stored incorrectly on your Zeo client, rather than the server,
and then in a hasty effort to free some space (due ...</p>
                <a class="readmore" href="../blog/2010/07/plone-running-plone-without-copies-of-blobs/">read more</a>
                <p>There are <a href="../blog/2010/07/plone-running-plone-without-copies-of-blobs/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2010/06/plonezope-using-ldapuserfolder-with-posixgroups/" rel="bookmark"
                           title="Permalink to Plone/Zope: Using LDAPUserFolder with posixGroups">Plone/Zope: Using LDAPUserFolder with posixGroups</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-06-03T16:03:00">
                Thu 03 June 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/groups.html">groups</a><a href="../tag/ldap.html">ldap</a><a href="../tag/ldapuserfolder.html">ldapuserfolder</a><a href="../tag/openldap.html">openldap</a><a href="../tag/patch.html">patch</a><a href="../tag/plone.html">plone</a><a href="../tag/python.html">python</a><a href="../tag/zope.html">zope</a></p>
</footer><!-- /.post-info -->                <p>Due to various reasons, the Products.LDAPUserFolder package available
for Plone and Zope doesn't support POSIX groups.&nbsp; The 'official' (ish)
reason for this is because of the fact that these groups don't store
full distinguished names (DNs) for members.&nbsp; It makes some degree of
sense, because a user ...</p>
                <a class="readmore" href="../blog/2010/06/plonezope-using-ldapuserfolder-with-posixgroups/">read more</a>
                <p>There are <a href="../blog/2010/06/plonezope-using-ldapuserfolder-with-posixgroups/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2010/05/virtualenv-python-2-4-plone-3-x-and-lucid-lynx-ubuntu-10-04/" rel="bookmark"
                           title="Permalink to Virtualenv, Python 2.4, Plone 3.x and Lucid Lynx (Ubuntu 10.04)">Virtualenv, Python 2.4, Plone 3.x and Lucid Lynx (Ubuntu 10.04)</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-05-12T14:47:00">
                Wed 12 May 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/plone.html">Plone</a>. </p>
<p>tags: <a href="../tag/1004.html">10.04</a><a href="../tag/how-to.html">how-to</a><a href="../tag/install.html">install</a><a href="../tag/installation.html">installation</a><a href="../tag/lucid.html">lucid</a><a href="../tag/plone.html">plone</a><a href="../tag/python.html">python</a><a href="../tag/virtualenv.html">virtualenv</a></p>
</footer><!-- /.post-info -->                <p>These titles of my posts just keep getting longer and longer.&nbsp; For those
of you paying close attention (I know who you are), this is the next in
my series of getting the above-mentioned tools working together.
Previously, it was Centos 5.x, Jaunty (9.04), Karmic (9.10) and ...</p>
                <a class="readmore" href="../blog/2010/05/virtualenv-python-2-4-plone-3-x-and-lucid-lynx-ubuntu-10-04/">read more</a>
                <p>There are <a href="../blog/2010/05/virtualenv-python-2-4-plone-3-x-and-lucid-lynx-ubuntu-10-04/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blog/2010/05/installing-python-2-4-on-ubuntu-10-04-lucid-lynx/" rel="bookmark"
                           title="Permalink to Installing Python 2.4 on Ubuntu 10.04 Lucid Lynx">Installing Python 2.4 on Ubuntu 10.04 Lucid Lynx</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-05-04T12:00:00">
                Tue 04 May 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/davidjb.html">davidjb</a>
        </address>
        <p>In <a href="../category/linux.html">Linux</a>. </p>
<p>tags: <a href="../tag/help-guide.html">help guide</a><a href="../tag/installation.html">installation</a><a href="../tag/linux.html">linux</a><a href="../tag/lucid.html">lucid</a><a href="../tag/packages.html">packages</a><a href="../tag/python.html">python</a><a href="../tag/ubuntu.html">ubuntu</a></p>
</footer><!-- /.post-info -->                <p>Whoops.&nbsp; No one sent me the memo that Python
2.4 support was being removed entirely from the latest version of
Ubuntu, 10.04 Lucid Lynx.&nbsp; To be fair, I was presented with the message
that 'these outdated packages will be removed' and in that list was
python2.4.&nbsp; I ...</p>
                <a class="readmore" href="../blog/2010/05/installing-python-2-4-on-ubuntu-10-04-lucid-lynx/">read more</a>
                <p>There are <a href="../blog/2010/05/installing-python-2-4-on-ubuntu-10-04-lucid-lynx/#disqus_thread">comments</a>.</p>                </div><!-- /.entry-content -->
            </article></li>
                            </ol><!-- /#posts-list -->
                            <p class="paginator">
        Page 1 / 3
            <a href="../tag/python2.html">&raquo;</a>
    </p>
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://planet.plone.org">Planet Plone</a></li>
                                                    <li><a href=""></a></li>
                                                    <li><a href=""></a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://davidjb.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://git.io/djb">GitHub</a></li>
                                                    <li><a href="http://twitter.com/davidjb_">Twitter</a></li>
                                                    <li><a href="http://linkedin.com/in/davidbeitey">LinkedIn</a></li>
                                                    <li><a href="http://facebook.com/david.beitey">Facebook</a></li>
                                                    <li><a href="https://plus.google.com/u/0/106527454335411502430">Google+</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24253455-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'davidjb';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>